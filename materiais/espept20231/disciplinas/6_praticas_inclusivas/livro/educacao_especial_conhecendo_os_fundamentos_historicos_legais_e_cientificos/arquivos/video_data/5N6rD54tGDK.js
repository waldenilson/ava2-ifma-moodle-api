;/*FB_PKG_DELIM*/

__d("LiveClockWWWTypedLogger",["Banzai","GeneratedLoggerUtils"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:LiveClockWWWLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:LiveClockWWWLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:LiveClockWWWLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setClientReceiveTimeMs=function(a){this.$1.client_receive_time_ms=a;return this};c.setClientSendTimeMs=function(a){this.$1.client_send_time_ms=a;return this};c.setRequestTimeMs=function(a){this.$1.request_time_ms=a;return this};c.setServerTimeMs=function(a){this.$1.server_time_ms=a;return this};return a}();c={client_receive_time_ms:!0,client_send_time_ms:!0,request_time_ms:!0,server_time_ms:!0};f["default"]=a}),66);
__d("LowLatencyPlaybackTypedLogger",["Banzai","GeneratedLoggerUtils"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:LowLatencyPlaybackLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:LowLatencyPlaybackLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:LowLatencyPlaybackLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setAppID=function(a){this.$1.appid=a;return this};c.setAppversion=function(a){this.$1.appversion=a;return this};c.setAuthFlag=function(a){this.$1.auth_flag=a;return this};c.setBehindByMs=function(a){this.$1.behind_by_ms=a;return this};c.setBufferMs=function(a){this.$1.buffer_ms=a;return this};c.setCountry=function(a){this.$1.country=a;return this};c.setOsBuildNumber=function(a){this.$1.os_build_number=a;return this};c.setPlaybackDesiredTimeMs=function(a){this.$1.playback_desired_time_ms=a;return this};c.setRadioType=function(a){this.$1.radio_type=a;return this};c.setRawClientTime=function(a){this.$1.raw_client_time=a;return this};c.setReactBundleVersion=function(a){this.$1.react_bundle_version=a;return this};c.setSeekCount=function(a){this.$1.seek_count=a;return this};c.setServerTimeMs=function(a){this.$1.server_time_ms=a;return this};c.setTimeSinceLastSeekMs=function(a){this.$1.time_since_last_seek_ms=a;return this};c.setVideoID=function(a){this.$1.video_id=a;return this};c.setVideoTimeMs=function(a){this.$1.video_time_ms=a;return this};return a}();c={appid:!0,appversion:!0,auth_flag:!0,behind_by_ms:!0,buffer_ms:!0,country:!0,os_build_number:!0,playback_desired_time_ms:!0,radio_type:!0,raw_client_time:!0,react_bundle_version:!0,seek_count:!0,server_time_ms:!0,time_since_last_seek_ms:!0,video_id:!0,video_time_ms:!0};f["default"]=a}),66);
__d("LiveClockQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="4900244860054863"}),null);
__d("LiveClockQuery.graphql",["LiveClockQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"client_time"}],c=[{alias:null,args:[{kind:"Variable",name:"client_time",variableName:"client_time"}],concreteType:"LiveClock",kind:"LinkedField",name:"live_video_clock",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"server_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"request_time",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"LiveClockQuery",selections:c,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"LiveClockQuery",selections:c},params:{id:b("LiveClockQuery_facebookRelayOperation"),metadata:{},name:"LiveClockQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("dispatchCustomEvent",[],(function(a,b,c,d,e,f){function b(b,c,d){var e;typeof a.CustomEvent==="function"?e=new a.CustomEvent(c,{detail:d}):(e=a.document.createEvent("CustomEvent"),e.initCustomEvent(c,!0,!0,d));b.dispatchEvent(e)}e.exports=b}),null);
__d("LiveClock",["LiveClockQuery.graphql","LiveClockWWWTypedLogger","RelayFBEnvironment","RelayModern","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i=5e3,j=12e4,k=5,l=2e3,m=50,n=1e4,o=1e4,p=h!==void 0?h:h=b("LiveClockQuery.graphql");a=function(){function a(){this.$1=null,this.$2=!1,this.$4=0,this.$5=o,this.$6=0,this.$7=0,this.$8=!1,this.$3=0,this.$10(0)}var e=a.prototype;e.$10=function(a){this.$6=0};e.startClock=function(a){this.$8||(this.$8=!0,a!=null&&(this.$1=a),this.$11())};e.stopClock=function(){this.$8=!1,window.clearTimeout(this.$9)};e.$11=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(this.$8){var a=this.currentTimeMillis();yield this.fetchTimes(a)}});function c(){return a.apply(this,arguments)}return c}();e.$12=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d){var e=(b-a+(c-d))/2,f=d-a-(c-b);this.$13(a,b,c,d);this.$14(e,f);this.$15(e,f);if(!this.$2){this.$2=!0;a=this.currentTimeMillis();this.$1!=null&&this.$1(a)}});function c(b,c,d,e){return a.apply(this,arguments)}return c}();e.$15=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=this.$16(a);a||(this.$7=0);a?(this.$7++,this.$5=m,this.$7>k&&(this.$5=l)):this.$17(b)?this.$5=o:(this.$5*=2,this.$5>j&&(this.$5=j),this.$5<o&&(this.$5=o))});function c(b,c){return a.apply(this,arguments)}return c}();e.$14=function(a,b){if(this.$17(b)){this.$4==0&&(this.$6+=a);return}this.$6+=a;this.$4++};e.fetchTimes=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this;c("promiseDone")(d("RelayModern").fetchQuery(c("RelayFBEnvironment"),p,{client_time:a},{force:!0}).then(function(a){if(a){var c=a.live_video_clock.client_time,d=a.live_video_clock.server_time*1e3;a=a.live_video_clock.request_time*1e3;var e=b.currentTimeMillis();b.$12(c,a,d,e);b.$9=window.setTimeout(function(){b.$11()},b.$5)}else return}))});function e(b){return a.apply(this,arguments)}return e}();e.currentTimeMillis=function(){return this.elapsedRealTimeMillis()+this.$3+this.$6};e.elapsedRealTimeMillis=function(){return Date.now()};e.$16=function(a){return Math.abs(a)>i};e.$17=function(a){return a>n};e.isRunning=function(){return this.$8};e.isReady=function(){return this.$2};e.$13=function(a,b,d,e){new(c("LiveClockWWWTypedLogger"))().setClientSendTimeMs(a).setRequestTimeMs(b).setServerTimeMs(d).setClientReceiveTimeMs(e).log()};return a}();g["default"]=a}),98);
__d("XRlAbrController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video/repomen/",{reason:{type:"String"},query:{type:"FloatVector"},bitrates:{type:"FloatVector"},action:{type:"Int"},action_prob:{type:"FloatVector"},id:{type:"Int"},session_id:{type:"String"},smc_tier:{type:"String"},model_id:{type:"String"},mdp_step:{type:"Int"},prev_reward:{type:"Float"},label_0:{type:"Float"},label_1:{type:"Float"},label_2:{type:"Float"},label_3:{type:"Float"},label_4:{type:"Float"},label_5:{type:"Float"},label_6:{type:"Float"},label_7:{type:"Float"},label_8:{type:"Float"},label_9:{type:"Float"}})}),null);
__d("RlAbrUtils",["AsyncRequest","Promise","XRlAbrController"],(function(a,b,c,d,e,f,g){var h=-1,i=8,j=["144p","240p","360p","480p","720p","1080p","1440p","2160p","4320p"],k="get_action",l="get_policy",m="put_exp";function n(a,b){b===void 0&&(b=!1);if(b){if(!a.endsWith("p")||a=="p")return null;b=a.replace(/p$/,"");if(isNaN(b))return null;b=parseInt(b,10);if(b<=0||b>=4320)return null;if(b<162)return"label_0";else if(b<210)return"label_1";else if(b<315)return"label_2";else if(b<420)return"label_3";else if(b<590)return"label_4";else if(b<780)return"label_5";else if(b<1260)return"label_6";else if(b<1520)return"label_7";else if(b<1880)return"label_8";else return"label_9"}var c=parseInt(a,10);return isNaN(c)||c<=0?null:j.find(function(a){return c<=parseInt(a,10)})||j[j.length-1]}function a(a,b,c,d,e,f){var g=[];for(var h=0;h<b.length;h++){var k=n(b[h].fbQualityLabel);if(!k)continue;var l=b[h].bandwidth;(!l||l<=0)&&(l=1e9);g.push({label:k,bitrate:l})}k=j.map(function(a){var b=g.find(function(b){return b.label===a});return b?b.bitrate:1e9});var m=null;l=0;h=0;c&&(m=n(c.fbQualityLabel),l=c.bandwidth||0,h=c.isHVQ?1:0);b=j.map(function(a){return a===m?1:0});c=a.currentTime||0;a=a.duration||0;a=Math.max(a-c,0)*1e3;c=[].concat(l,b,h,e,a);l=[];for(b=0;b<i;b++)b<d.length?l.push(d[d.length-b-1][0]||0,d[d.length-b-1][1]||0):l.push(0,0);return[].concat(k,c,l,f)}function d(a){var b=[];for(var c=0;c<a.length;c++)b.push(a[c].bandwidth);return b}function o(a){var b=a.duration;a=a.currentTime;return!isNaN(b)&&!isNaN(a)&&b>a?(b-a)*1e3:-1}function e(a,b,c,d,e){b=o(a);a=[];if(e){e.update(Date.now());var f=e.getWatchTimeSinceLastReport(),g=e.getStallCountSinceLastReport(),h=e.getStallTimeSinceLastReport();e=e.getBufferedTimeSinceLastReport();a.push(f);a.push(e);a.push(g);a.push(h)}else a.push(-1,-1,-1,-1);return[].concat(d,c,b,a)}function f(a,b,c,d){var e=Array(10).fill(h),f=!1;for(var g=b.length-1;g>=0;g--){var i=n(b[g].fbQualityLabel,!0);if(i){f=!0;i=parseInt(i.substr(-1,1),10);e[i]=b[g].bandwidth}}if(!f)return null;i=o(a);return[].concat(d,c,i,e)}function p(a,b){if(b.length===0)return[];if(!a)a=b;else if(b.length!==a.length)return[];var c=b[b.length-1]-a[a.length-1];return[].concat(a.slice(0,a.length-1),b.slice(0,b.length-1),c)}function q(a,d,e){var f=c("XRlAbrController").getURIBuilder().setString("reason",k).setInt("id",e).setFloatVector("query",[a[0],a[1],a[2]]);f=self._setAvailableBitrateFeatures(a,f);f=f.getURI();return new(b("Promise"))(function(a,b){new(c("AsyncRequest"))(f).setMethod("GET").setURI(f).setReadOnly(!0).setHandler(function(b){b=b.payload.data;a(b||[])}).setErrorHandler(function(a){b([])}).setTimeoutHandler(d,function(a){b([])}).send()})}function r(a,d,e,f){a=p(a,d);var g=c("XRlAbrController").getURIBuilder().setString("reason",k).setInt("id",f).setFloatVector("query",a).getURI();return new(b("Promise"))(function(a,b){new(c("AsyncRequest"))(g).setMethod("GET").setURI(g).setReadOnly(!0).setHandler(function(b){b=b.payload.data;a(b||[])}).setErrorHandler(function(a){b([])}).setTimeoutHandler(e,function(a){b([])}).send()})}function s(a,d,e,f){var g=c("XRlAbrController").getURIBuilder().setString("reason",k).setString("session_id",f).setFloatVector("query",a).setFloatVector("bitrates",d);g=g.getURI();return new(b("Promise"))(function(a,b){new(c("AsyncRequest"))(g).setMethod("GET").setURI(g).setReadOnly(!0).setHandler(function(b){b=b.payload.data;a(b||[])}).setErrorHandler(function(a){b([])}).setTimeoutHandler(e,function(a){b([])}).send()})}function t(a,d,e){var f=c("XRlAbrController").getURIBuilder().setString("reason",l).setString("session_id",a).setString("smc_tier",d);f=f.getURI();return new(b("Promise"))(function(a,b){new(c("AsyncRequest"))(f).setMethod("GET").setURI(f).setReadOnly(!0).setHandler(function(b){var c=b.payload.model_id,d=b.payload.weights;b=b.payload.biases;a([c,d,b]||[])}).setErrorHandler(function(a){b([])}).setTimeoutHandler(e,function(a){b([])}).send()})}function u(a,b){for(var c=0;c<10;c++)a[c+3]!==h&&(b=b.setFloat("label_"+c,a[c+3]));return b}function v(a,d,e,f,g,h,i,j,k,l){var n=c("XRlAbrController").getURIBuilder().setString("reason",m).setString("smc_tier",d).setString("model_id",e).setInt("mdp_step",f).setString("session_id",a).setFloatVector("query",g).setFloatVector("bitrates",h).setFloat("prev_reward",i).setInt("action",j).setFloatVector("action_prob",k);n=n.getURI();return new(b("Promise"))(function(a,b){new(c("AsyncRequest"))(n).setMethod("GET").setURI(n).setReadOnly(!0).setHandler(function(b){a([])}).setErrorHandler(function(a){b([])}).setTimeoutHandler(l,function(a){b([])}).send()})}g._unavailableBitrate=h;g._networkFeatureCount=i;g._labelBrackets=j;g._reasonGetAction=k;g._reasonGetPolicy=l;g._reasonPutExperience=m;g.getQualityLabelBracket=n;g.getRlAbrFeaturesDeprecated=a;g.getRlAbrAvailableBitrates=d;g.getRemainingPlayback=o;g.getRlAbrFeatures=e;g.getRlAbrShortFeatures=f;g._getRlQuery=p;g.genRlAbrShortFeaturesRecommendation=q;g.genRlAbrRecommendationDeprecated=r;g.genRlAbrRecommendation=s;g.fetchRlAbrModel=t;g._setAvailableBitrateFeatures=u;g.putExperience=v}),98);
__d("RlAlgebra",["Random"],(function(a,b,c,d,e,f,g){function h(a,b){if(a.length==0||a[0].length==0||b.length==0)throw new Error("Matrix or vector has 0 size.");var c=[];for(var d=0;d<a.length;d++){if(a[d].length!==b.length)throw new Error("Matrix and vector not compatible");var e=0;for(var f=0;f<b.length;f++)e+=a[d][f]*b[f];c.push(e)}return c}function i(a,b){if(a.length!==b.length)throw new Error("Two vectors have different length");var c=[];for(var d=0;d<a.length;d++)c.push(a[d]+b[d]);return c}function j(a){var b=[];for(var c=0;c<a.length;c++)a[c]>0?b.push(a[c]):b.push(0);return b}function k(a){if(a.length==0)throw new Error("vector length is 0");var b=[],c=0,d=Math.max.apply(Math,a);for(var e=0;e<a.length;e++){var f=Math.exp(a[e]-d);b.push(f);c+=f}for(f=0;f<a.length;f++)b[f]/=c;return b}function a(a,b){b===void 0&&(b=1e-6);if(a.length==0)throw new Error("vector length is 0");var c=1/b,e=[],f=0;for(var g=0;g<a.length;g++)f+=a[g],e.push(f);if(Math.abs(e[e.length-1]-1)>b)throw new Error("probability distribution does not sum to 1");g=(Math.floor(d("Random").random()*c)+1)/c;f=-1;for(a=0;a<e.length;a++)if(g<=e[a]){f=a;break}return f}function b(a,b,c,d){var e=[];for(var f=0;f<d.length;f++){var g=[].concat(c,d[f]);g=g;for(var l=0;l<a.length;l++)g=h(a[l],g),g=i(g,b[l]),l<a.length-1&&(g=j(g));e.push(g[0])}return k(e)}g.matrixMultiply=h;g.vectorAdd=i;g.vectorRelu=j;g.vectorSoftmax=k;g.vectorSample=a;g.policyInference=b}),98);
__d("XVideoDataAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video/video_data_async/",{video_id:{type:"String",required:!0},width:{type:"Int"},height:{type:"Int"},scrubbing_preference:{type:"Int"},source:{type:"String"},preferred_projection:{type:"Enum",enumType:1},supports_html5_video:{type:"Bool",defaultValue:!0},is_ad:{type:"Bool",defaultValue:!1},force_flash:{type:"Bool",defaultValue:!1},is_omnistab_preview_select_revert:{type:"Bool",defaultValue:!1},allow_dash_prefetch:{type:"Bool",defaultValue:!1},force_hd:{type:"Bool",defaultValue:!1},host_number:{type:"Int"},include_extra_drm_info:{type:"Bool",defaultValue:!0}})}),null);
__d("VideoDataAsyncControllerUri",["XVideoDataAsyncController"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}var b=a.prototype;b.getURI=function(a,b,d,e,f,g,h,i){a=c("XVideoDataAsyncController").getURIBuilder().setString("video_id",a.toString()).setBool("supports_html5_video",b);d!==void 0&&(a=a.setBool("force_flash",d));e!==void 0&&(a=a.setBool("allow_dash_prefetch",e));f!==void 0&&(a=a.setBool("force_hd",f));g!==void 0&&(a=a.setInt("host_number",g));h!==void 0&&(a=a.setBool("include_extra_drm_info",h));i!==void 0&&(a=a.setString("source",i));return a.getURI()};return a}();g["default"]=a}),98);
__d("VideoPlayerMetaData",["ActorURI","AsyncRequest","Promise","TimeSlice","VideoData","VideoDataAsyncControllerUri","asyncToGeneratorRuntime","clearTimeout","err","isHTML5VideoImplementationUnavailable","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h={},i=12e4;a=function(){function a(a){this.videoID=a}var e=a.prototype;e.getVideoID=function(){return this.videoID};e.genVideoData=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,d){var e=this;try{var f=this.$1;(!f||a.forceRefetch)&&(this.$2&&(c("clearTimeout")(this.$2),this.$2=null),f=this.$1=this.$3(a,b),this.$2=c("setTimeout")(c("TimeSlice").guard(function(){e.$1=null,d()},"VideoPlayerMetaData cacheTimeout",{propagationType:c("TimeSlice").PropagationType.ORPHAN}),a.cacheTimeout||i));return yield f}catch(a){throw a}});function d(b,c,d){return a.apply(this,arguments)}return d}();e.$3=function(a,e){var f,g=this;f=(f=a==null?void 0:a.uriBuilder)!=null?f:new(c("VideoDataAsyncControllerUri"))();var h=a.forceFlash,i=a.allowDashPrefetch,j=a.forceHD,k=a.hostNumber,l=a.includeExtraDRMInfo;a=a.source;var m=f.getURI(this.videoID,!c("isHTML5VideoImplementationUnavailable")(!0),h,i,j,k,l,a);e!=null&&(m=d("ActorURI").create(m,e));return new(b("Promise"))(function(a,b){return new(c("AsyncRequest"))(m).setMethod("GET").setURI(m).setReadOnly(!0).setAllowCrossPageTransition(!0).setHandler(function(d){d=d.payload;if(d==null||d.error!=null){var e;e=(e=d==null?void 0:d.error)!=null?e:c("err")("The request succeeded but no video data was available for "+g.videoID);b(e);return}a(new(c("VideoData"))(d))}).setErrorHandler(function(a){a=a.getErrorDescription();b((a=a)!=null?a:c("err")("The request failed but no reason was provided for "+g.videoID))}).send()})};a.get=function(b){h[b]||(h[b]=new a(b));return h[b]};a.genVideoData=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c,d,e){c===void 0&&(c={});d===void 0&&(d=void 0);e===void 0&&(e=function(){});return yield a.get(b).genVideoData(c,d,e)});function d(a,b,d,e){return c.apply(this,arguments)}return d}();return a}();g["default"]=a}),98);
__d("VideoPushParametersHelper",["ShakaConstants","URI","VideoPlayerShakaGlobalConfig"],(function(a,b,c,d,e,f,g){var h=/(.*)\.(xx|fna)\.fbcdn\.net/;a=function(){function a(a){this.$1=new(c("URI"))(a);return this}var b=a.prototype;b.setStreamEndOffset=function(a){this.$2=Math.min(Math.floor(a)+1,c("ShakaConstants").numbers.live_max_segments_to_push);this.$4=Math.floor(a)+1;return this};b.setSegmentStartTime=function(a){this.$3=a;return this};b.setPushVideoRepresentationID=function(a){this.$5=a;return this};b.setPushAudioRepresentationID=function(a){this.$6=a;return this};b.setUseLongCacheForManifest=function(a){this.$7=a;return this};b.getURL=function(){var a=this,b=this.getPushQueryParameters();b.forEach(function(b,c){a.$1.addQueryData(c,b)});return this.$1.toString()};b.getPushQueryParameters=function(){var a=new Map(),b=h.test(this.$1.toString());b&&d("VideoPlayerShakaGlobalConfig").getBool("live_send_push_headers",!0)&&(this.$2!=null&&a.set("_nc_p_n",this.$2),this.$3!=null?a.set("_nc_p_ts",this.$3):this.$4!=null&&a.set("_nc_p_o",this.$4),this.$5!=null&&this.$6!=null&&(a.set("_nc_p_rid",this.$5),a.set("_nc_p_arid",this.$6)),this.$7&&a.set("_nc_nc","1"));return a};b.getSegmentsToPush=function(){return this.$2};b.getSegmentStartTime=function(){return this.$3};b.getSegmentOffset=function(){return this.$4};b.getPushVideoRepresentationID=function(){return this.$5};b.getPushAudioRepresentationID=function(){return this.$6};b.getUseLongCacheForManifest=function(){return this.$7};return a}();g["default"]=a}),98);
__d("getBufferedAheadOf",[],(function(a,b,c,d,e,f){function a(a){var b=1/60,c=a.currentTime;a=a.buffered;for(var d=0;d<a.length;d++){var e=a.start(d)-b,f=a.end(d)+b;if(c>=e&&c<=f)return Math.max(a.end(d)-c,0)}return 0}f["default"]=a}),66);
__d("AbrEvaluationSignal",["EventEmitter","EventListener","SubscriptionsHandler","getBufferedAheadOf"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,d,e,f){var g;g=a.call(this)||this;g.$AbrEvaluationSignal2=!0;g.$AbrEvaluationSignal3=!1;g.$AbrEvaluationSignal4=0;g.$AbrEvaluationSignal5=0;g.$AbrEvaluationSignal6=0;g.$AbrEvaluationSignal9=b;g.$AbrEvaluationSignal1=d;g.$AbrEvaluationSignal10=e;g.$AbrEvaluationSignal7=f;g.$AbrEvaluationSignal8=new(c("SubscriptionsHandler"))();b=[c("EventListener").listen(g.$AbrEvaluationSignal10,"adaptation",g.$AbrEvaluationSignal11.bind(babelHelpers.assertThisInitialized(g)))];f.evaluateAbrOnTracksAndBandwidthChange&&(b.push(c("EventListener").listen(g.$AbrEvaluationSignal10,"trackschanged",g.$AbrEvaluationSignal12.bind(babelHelpers.assertThisInitialized(g)))),b.push(c("EventListener").listen(g.$AbrEvaluationSignal1.getEstimator(),"bandwidth",g.$AbrEvaluationSignal13.bind(babelHelpers.assertThisInitialized(g)))));f.evaluateAbrOnFetchEnd&&b.push(c("EventListener").listen(g.$AbrEvaluationSignal10,"fetch_end",g.$AbrEvaluationSignal14.bind(babelHelpers.assertThisInitialized(g))));(d=g.$AbrEvaluationSignal8).addSubscriptions.apply(d,b);return g}var d=b.prototype;d.notifySwitch=function(){this.$AbrEvaluationSignal3=!0};d.destroy=function(){this.$AbrEvaluationSignal8.release(),this.$AbrEvaluationSignal8.engage(),this.removeAllListeners()};d.$AbrEvaluationSignal11=function(){this.$AbrEvaluationSignal3=!1,this.$AbrEvaluationSignal6=Date.now()};d.$AbrEvaluationSignal15=function(){return this.$AbrEvaluationSignal7.useLowBufferVelocityInterval&&c("getBufferedAheadOf")(this.$AbrEvaluationSignal9)<this.$AbrEvaluationSignal7.lowBufferVelocityIntervalBufferThreshold};d.$AbrEvaluationSignal14=function(a){var b=this.$AbrEvaluationSignal4;this.$AbrEvaluationSignal4=Date.now();a=a.detail&&a.detail.stream_fetch_time_ms&&a.detail.segment_length_ms?{streamFetchTimeMs:a.detail.stream_fetch_time_ms,segmentLengthMs:a.detail.segment_length_ms}:void 0;this.$AbrEvaluationSignal16(this.$AbrEvaluationSignal7.ignoreRecentBandwidthEvalOnFetchEnd?b:this.$AbrEvaluationSignal5,a)};d.$AbrEvaluationSignal13=function(){this.$AbrEvaluationSignal16(this.$AbrEvaluationSignal5)};d.$AbrEvaluationSignal16=function(a,b){if(this.$AbrEvaluationSignal2&&this.$AbrEvaluationSignal7.ignoreTimeLimitForInitialSample){this.$AbrEvaluationSignal2=!1;this.$AbrEvaluationSignal17(b);return}var c=this.$AbrEvaluationSignal7.minEvalInterval,d=this.$AbrEvaluationSignal7.minSwitchInterval;this.$AbrEvaluationSignal15()&&(c=d=this.$AbrEvaluationSignal7.lowBufferVelocityAbrInterval);if(!this.$AbrEvaluationSignal3&&Date.now()>=a+c&&Date.now()>=this.$AbrEvaluationSignal6+d){this.$AbrEvaluationSignal17(b);return}};d.$AbrEvaluationSignal12=function(){this.$AbrEvaluationSignal17()};d.$AbrEvaluationSignal17=function(a){a=babelHelpers["extends"]({clearBufferIfUpgrading:!1,clearBufferOffset:0},a);this.emit("evaluate",a);this.$AbrEvaluationSignal5=Date.now()};return b}(c("EventEmitter"));g["default"]=a}),98);
__d("concatArrayBuffer",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}f["default"]=a}),66);
__d("extractCEA608",["JSResource"],(function(a,b,c,d,e,f,g){var h=null;function a(a){h||(h=c("JSResource")("CEA608Extractor").__setRef("extractCEA608").load());return h.then(function(b){return b.extract(a)})}a.prepare=function(){return};g["default"]=a}),98);
__d("BufferReplacementHelper",[],(function(a,b,c,d,e,f){"use strict";function g(a,b,c,d){return a.startTime>b-c&&a.endTime<b+d}function h(a,b,c,d){d=d.get(a.startTime);return!!d&&c(b,d.id)>0}function i(a,b,c,d,e,f,i){var j=i.thresholdBefore,k=i.thresholdAfter;i=i.wrapReplacementPastEnd;var l=[],m=!1;for(c=c;c<a.length;c++){g(a[c],b,j,k)&&h(a[c],d,e,f)&&l.push(a[c]);if(a[c].endTime>b+k){m=!0;break}}if(!m&&i){c=b+k-a[a.length-1].endTime;for(j=0;j<a.length;j++){c-=a[j].endTime-a[j].startTime;c>=0&&h(a[j],d,e,f)&&l.push(a[j]);if(a[j].endTime>b+k)break}}return l}function j(a,b,c,d,e,f,i){var j=i.thresholdBefore,k=i.thresholdAfter;i.wrapReplacementPastEnd;i=[];for(c=c-1;c>=0;c--){g(a[c],b,j,k)&&h(a[c],d,e,f)&&i.push(a[c]);if(a[c].startTime<b-j)break}return i}function a(a,b,c,d,e,f,g){a=[a,b,c,d,e,f,g];return i.apply(void 0,a).concat(j.apply(void 0,a))}f.getSegmentsToReplaceLowerQuality=a}),66);
__d("BufferVelocity",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=[],this.$2=a*1e3}var b=a.prototype;b.recordBufferAhead=function(a){this.$1.push({bufferAhead:a,timestamp:Date.now()})};b.getVelocity=function(){if(this.$1.length<2)return null;var a=this.$1[this.$1.length-1],b=this.$3(),c=b.oldestValidEntry;b=b.oldestValidEntryIndex;b!=null&&b>0&&this.$1.splice(0,b);return c!=null?(a.bufferAhead-c.bufferAhead)/((a.timestamp-c.timestamp)/1e3):null};b.$3=function(){var a=null,b=null;for(var c=0;c<this.$1.length-1;c++){a=this.$1[c];if(this.$1[c].timestamp>=Date.now()-this.$2)break;b=c}return{oldestValidEntry:a,oldestValidEntryIndex:b}};b.reset=function(){this.$1=[]};return a}();f["default"]=a}),66);
__d("ByteRange",["oz-player/manifests/OzByteRange"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=d("oz-player/manifests/OzByteRange")}),98);
__d("DeferredBuffer",["oz-player/networks/OzDeferredBuffer"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/networks/OzDeferredBuffer")}),98);
__d("ProducerInterruptedError",["oz-player/networks/OzProducerInterruptedError"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/networks/OzProducerInterruptedError")}),98);
__d("ReadableStream",[],(function(a,b,c,d,e,f){a=self.ReadableStream;f["default"]=a}),66);
__d("WritableStream",[],(function(a,b,c,d,e,f){a=self.WritableStream;f["default"]=a}),66);
__d("pipeErrorTo",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){try{a.error(b)}catch(a){}}f["default"]=a}),66);
__d("FixedSizeTransform",["invariant","Deferred","DeferredBuffer","MaybeNativePromise","ProducerInterruptedError","ReadableStream","WritableStream","pipeErrorTo"],(function(a,b,c,d,e,f,g,h){"use strict";a=function(){function a(a){a===void 0&&(a={});this.$1=0;this.$4=0;this.$5=c("MaybeNativePromise").resolve();this.$8=[];a=a;var b=a.disableDeferredBufferArrayShift,d=a.useNativePromiseInDeferredBuffer;a=a.fixFixedSizeTransformOnNullEndByte;this.$12=a||!1;this.$3=new(c("DeferredBuffer"))({disableArrayShift:!!b,useNativePromise:!!d})}var b=a.prototype;b.cancel=function(a){this.$13(a),this.$7&&c("pipeErrorTo")(this.$7,a)};b.cancelAfterBytes=function(a,b){a<=this.$1?this.cancel(b):(this.$10=a,this.$11=b)};b.$13=function(a){this.$9=a,this.$6&&this.$6.reject(this.$9)};b.getSink=function(){var a=this;this.$2||(this.$2=new(c("WritableStream"))({start:function(b){a.$7=b},write:function(b){b instanceof Uint8Array||h(0,3834),a.$3.produce(b),a.$1+=b.length,a.$10!=null&&a.$10<=a.$1&&a.cancel(a.$11)},close:function(){a.$3.signalProducerInterruption(),a.$2=null},abort:function(b){a.$3.produce(b)}}));return this.$2};b.getNextFixedSizeStream=function(a){var b=this,d=a===void 0,e=0;if(this.$9)return c("MaybeNativePromise").reject(this.$9);this.$6=new(c("Deferred"))(c("MaybeNativePromise"));var f=this.$6.getPromise(),g=this.$5;this.$5=f;return g.then(function(){return new(c("ReadableStream"))({start:function(a){b.$8.push(a)},pull:function(f){if(!d&&b.$4===a)return b.$14(f);var g=d?void 0:(a||0)-b.$4;return b.$3.consume(g).then(function(a){f.enqueue(a),b.$4+=a.length})["catch"](function(a){if(a instanceof c("ProducerInterruptedError"))if(b.$12)return d&&(b.$4>0||e>0)?b.$14(f):e++;else return d?b.$14(f):c("MaybeNativePromise").resolve();b.$13(a);b.$8.forEach(function(b){c("pipeErrorTo")(b,a)})})},cancel:function(a){b.$13(a),c("pipeErrorTo")(b.$7,a)}})})};b.$14=function(a){a.close();this.$4=0;this.$6.resolve();return c("MaybeNativePromise").resolve()};return a}();g["default"]=a}),98);
__d("PausableRangeStream",["oz-player/networks/OzPausableRangeStream"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/networks/OzPausableRangeStream")}),98);
__d("ChunkableContinuousRangeStream",["ByteRange","Deferred","FixedSizeTransform","MaybeNativePromise","PausableRangeStream","ReadableStream","WritableStream"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){this.$1=c("MaybeNativePromise").resolve(null);this.$2=null;this.$3=null;this.$5=[];this.$7=null;this.$9=!1;this.$10=!1;this.$12=!1;this.$13=!1;this.$14=!1;this.$15=!1;this.$16=!1;this.$17=!1;this.$18=!1;this.$19=!1;this.$20=!1;this.$4=a;b=b||{};a=b;b=a.disableStreamAutoStart;var d=a.enableStreamRangeConcat,e=a.disableDeferredBufferArrayShift,f=a.useNativePromiseInDeferredBuffer,g=a.fixFixedSizeTransformOnNullEndByte,h=a.fixStreamingUndefinedEndByte,i=a.enablePausableStreamResumeFromStart,j=a.fixPausePreReadableStream;a=a.enableFactoryDestroy;this.$12=!!b;this.$13=!!d;this.$14=!!e;this.$16=!!g;this.$15=!!f;this.$8=new(c("FixedSizeTransform"))({disableDeferredBufferArrayShift:this.$14,useNativePromiseInDeferredBuffer:this.$15,fixFixedSizeTransformOnNullEndByte:this.$16});this.$17=!!h;this.$18=!!i;this.$19=!!j;this.$20=!!a}var b=a.prototype;b.$21=function(){var a=this;this.$6&&(this.$6.resolve(null),this.$6=null);this.$3=null;this.$9=!0;if(this.$20){var b=[];this.$5.map(function(d){var e=a.$7;if(!e)return;c("ByteRange").startsAtSame(d.getByteRange(),e)&&b.push(d)});this.$5=b}};b.isClosed=function(){return this.$9};b.getReservedChunkStream=function(a){if(this.isClosed())return c("MaybeNativePromise").reject();this.updateRangeStream(a);if(this.$7&&!c("ByteRange").startsImmediateAfter(a,this.$7)){this.destroy();return c("MaybeNativePromise").reject(new Error("Bad Range Request"))}this.$7=a;a=c("ByteRange").getLength(a);return this.$8.getNextFixedSizeStream(a===null?void 0:a)};b.$22=function(){var a="close stream";this.$7!=null&&this.$7.endByte!=null&&this.$11!=null?this.$8.cancelAfterBytes(this.$7.endByte-this.$11+1,a):this.$7||this.$8.cancel(a)};b.updateRangeStream=function(a){var b=this;if(this.isClosed())return"closed";if(!this.$23(a)){this.$1.then(function(){b.$22()});this.$21();return"closed"}if(!this.$2)this.$24(a);else{this.$3=this.$25(a);a=this.$5[this.$5.length-1];this.$13&&this.$3!=null&&a&&a.tryConcatByteRange(this.$3)?this.$3=null:!this.$10&&this.$3!=null&&this.$24(this.$3)}return"streaming"};b.getCurrentStreamRange=function(){return this.$2};b.removeQueuedRange=function(){this.$3=null};b.$24=function(a){var b=this;this.$10=!0;this.$26(a).then(function(){b.$10=!1;if(b.$3){var a=b.$3;b.$3=null;b.$24(a)}})["catch"](function(a){b.$10=!1})};b.getPausableStreamFactory=function(){var a=this;return function(){if(a.$5.length)return c("MaybeNativePromise").resolve(a.$5[0]);return a.$6?a.$6.getPromise():c("MaybeNativePromise").resolve(null)}};b.$26=function(a){var b=this;this.$2=a;this.$11==null&&(this.$11=a.startByte);var d=new(c("Deferred"))(c("MaybeNativePromise"));this.$1=d.getPromise();a=new(c("PausableRangeStream"))(c("ReadableStream"),c("WritableStream"),a,this.$4,{disableDeferredBufferArrayShift:this.$14,useNativePromiseInDeferredBuffer:this.$15,fixStreamingUndefinedEndByte:this.$17,enablePausableStreamResumeFromStartDangerously:this.$18,fixPausePreReadableStream:this.$19});this.$12?(a=this.$27(a,d),this.$5.push(a)):a.startStream().then(function(){d.resolve()});a=a.getStream();return a.pipeTo(this.$8.getSink())["catch"](function(a){b.$21();throw a})};b.$27=function(a,b){var d=this,e=a.startStream;a.startStream=function(){return e.call(a).then(function(e){e=e.statusPromise;b.resolve();e=e.then(function(b){if(b!=="stream_paused"){var e=d.$5.indexOf(a);e>-1&&d.$5.splice(e,1)}d.$3&&(d.$6=new(c("Deferred"))(c("MaybeNativePromise")));return b});return{statusPromise:e}})};this.$6&&(this.$6.resolve(a),this.$6=null);return a};b.destroy=function(){this.$22(),this.$21()};b.$25=function(a){a=a;this.$3&&(a=c("ByteRange").union(this.$3,a));a!=null&&this.$2&&(a=c("ByteRange").disjoinAfter(a,this.$2));return a};b.$23=function(a){if(!this.$2)return!0;return!this.$7?c("ByteRange").startsAtSame(a,this.$2):c("ByteRange").startsDuring(a,this.$7)||c("ByteRange").startsImmediateAfter(a,this.$7)};return a}();g["default"]=a}),98);
__d("VideoPriorityCalculator",[],(function(a,b,c,d,e,f){"use strict";function g(){return 2}function h(a,b){var c=a.playhead,d=a.bufferEnd;a=a.isPlaying;d=d-c<=b?0:1;c=a?0:1;return g()-d-c}function a(a,b,c){var d=a.playhead,e=a.bufferEnd;if(!c)return h(a,b);e=e-d;return e<=c?g():h(a,b)}f.getMaxPriority=g;f.calculate=h;f.calculateLive=a}),66);
__d("ContinuousPausableStreamTask",["Deferred","MaybeNativePromise","VideoPriorityCalculator","clearInterval","setInterval"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d,e,f){d===void 0&&(d=0);e===void 0&&(e=null);f===void 0&&(f={});this.$3=!1;this.$9=!1;this.$10=!1;this.$11=!1;this.$12=!1;this.$13=0;this.$14=0;this.$15=1;this.$16=new(c("Deferred"))(c("MaybeNativePromise"));this.$1=a;this.$4=b;this.$7=d;this.$5=e;a=f;b=a.uncancellablePriority;d=a.disableAudioStreamPause;e=a.yieldOnLowPriStream;f=a.lowPriTaskYieldCheckInterval;var g=a.lowPriTaskMinBytesToYield;a=a.lowPriTaskYieldsPerTask;this.$8=b==null?Infinity:b;this.$11=!!d;this.$12=!!e;this.$13=f||0;this.$14=g||0;this.$15=a||1}var b=a.prototype;b.run=function(){var a=this;if(this.$5){var b=this.$5.getOperationLogger("streaming_task").start();b.setType(this.$4);this.$6=b}b=function b(){a.$2=null;return a.$1().then(function(e){a.$2=e;a.$3&&a.$17();if(!e){a.$6&&a.$6.setResult("done").log();return}var f=e.getBytesStreamed(),g=e.getByteRange(),h=g.endByte?(g.endByte-g.startByte)/a.$15:0;return e.startStream().then(function(g){g=g.statusPromise;var i,j=e;a.$13&&j&&(i=c("setInterval")(function(){var b=j.getBytesStreamed()-f;a.$7<d("VideoPriorityCalculator").getMaxPriority()&&b>a.$14&&b>h&&(j.pauseStream(),c("clearInterval")(i))},a.$13));return g.then(function(e){c("clearInterval")(i);if(e==="stream_paused")a.$17();else if(e==="stream_aborted"){a.$6&&a.$6.setResult("failed").log();throw new Error("failed")}(a.$12&&a.$7<d("VideoPriorityCalculator").getMaxPriority()||a.$10)&&(a.$10=!1,a.$17());return b()})["catch"](function(a){c("clearInterval")(i);throw a})})})};b().then(function(){a.$16.resolve()})["catch"](function(b){a.$16.reject(b)});return this.$16.getPromise()};b.getPromise=function(){return this.$16.getPromise()};b.updatePriority=function(a){this.$7=a,this.$9&&this.cancel()};b.cancel=function(){if(this.$11&&this.$4==="audio")return;if(this.$7>=this.$8){this.$9=!0;return}this.$2&&this.$2.pauseStream();this.$3=!0};b.cancelOnCurrentStreamDone=function(){this.$10=!0};b.$17=function(){this.$6&&this.$6.setResult("cancelled").log();throw new Error("cancelled")};return a}();g["default"]=a}),98);
__d("RlAbrModel",["RlAbrUtils","RlAlgebra","ShakaConstants","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a=function(){function a(a){this.$1=a,this.$2=[],this.$3=0,this.$4=0}var e=a.prototype;e.$5=function(a,b){var d=b[3],e=b[4],f=b[5];b=b[6];e=this.$3*e*c("ShakaConstants").numbers.rl_bitrate_reward+d*c("ShakaConstants").numbers.rl_watch_time_reward-f*c("ShakaConstants").numbers.rl_stall_count_penalty-b*c("ShakaConstants").numbers.rl_stall_time_penalty;this.$3=a;return e};e.fetchIfNotExist=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){this.$2.length==0&&(this.$2=(yield d("RlAbrUtils").fetchRlAbrModel(a,b,c)))});function c(b,c,d){return a.apply(this,arguments)}return c}();e.getPolicyReportExperience=function(a,b,e,f,g,h){var i=[].concat(e[0]/c("ShakaConstants").numbers.rl_bandwidth_scale,e[1]/c("ShakaConstants").numbers.rl_buffer_scale,e[2]/c("ShakaConstants").numbers.rl_playback_scale),j=[];for(var k=0;k<f.length;k++)j.push(f[k]/c("ShakaConstants").numbers.rl_bandwidth_scale);k=d("RlAlgebra").policyInference(this.$2[1],this.$2[2],i,j);i=d("RlAlgebra").vectorSample(k);if(i>=g.length)throw new Error("RL chooses unavailable bitrate.");g=this.$5(j[i],e);d("RlAbrUtils").putExperience(a,b,String(this.$2[0]),this.$4,e,f,g,i,k,h);this.$4+=1;return i};e.modelFetched=function(){return this.$2.length==3};return a}();g["default"]=a}),98);
__d("FirstLoadedVideoPriorityAdjuster",["EventListener","SubscriptionsHandler"],(function(a,b,c,d,e,f,g){"use strict";var h=null;a=function(){function a(a){var b=this;this.$1=function(){};this.$2=new(c("SubscriptionsHandler"))();this.$3=!1;this.$4=!1;h===null&&(h=a,this.$4=!0,this.$2.addSubscriptions(c("EventListener").listen(a,"playing",function(){b.$3=!0,b.$1&&b.$1(b.getPriorityAdjustment()),b.cleanup()})))}var b=a.prototype;b.setOnPriorityChanged=function(a){this.$1=a};b.getPriorityAdjustment=function(){return this.$4&&!this.$3?.5:0};b.cleanup=function(){this.$2.release(),this.$1=function(){}};return a}();g["default"]=a}),98);
__d("UnitConstants",[],(function(a,b,c,d,e,f){"use strict";a=8;f.BITS_IN_BYTE=a}),66);
__d("LocalBitrateHelper",["UnitConstants"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){if(!a[b])return null;if(a[b].startTime>c)return b;while(b<a.length){if(a[b].startTime>c)return b;b++}return null}function b(a,b,c){if(b>=a.length||b<0)return null;c=b+c>=a.length?a.length-b-1:c;var e=a[b];a=a[b+c];b=e.url.startByte;c=a.url.endByte;return b===void 0||c===void 0?null:Math.round((c-b)/(a.endTime-e.startTime)*d("UnitConstants").BITS_IN_BYTE)}g.getBufferEndSegmentIndex=a;g.getLocalBitrate=b}),98);
__d("ShakaSegmentReferenceHelper",["BinarySearch","FBLogger"],(function(a,b,c,d,e,f,g){"use strict";var h=.001;function i(a,b){for(var c=a.length-1;c>=0;--c){var d=a[c];if(Math.abs(b-d.startTime)<h)return c}return-1}function j(a,b){var d=i(a,b);if(d>-1)return d;for(d=a.length-1;d>=0;--d){var e=a[d];if(b>=e.startTime&&b<e.endTime){c("FBLogger")("shaka").warn("Segment reference have no matching start time %s, %d",JSON.stringify(e),b);return d}}return-1}function a(a,b){var c=j(a,b.startTime);if(c>=0){a.splice(c,0,b);return c+1}else{a.push(b);return a.length}}function b(a,b){var c=a.startByte;c=d("BinarySearch").leastUpperBound(function(a){a=b[a];return a.url.startByte},c,0,b.length,function(a,b){return a-b});var e=b[c];return e&&e.url.baseUrl===a.baseUrl&&e.url.startByte===a.startByte&&e.url.endByte===a.endByte?c:-1}g.findIndexByStartTimeExact=i;g.findIndexByStartTime=j;g.insertReference=a;g.findIndexByRequestInfo=b}),98);
__d("MultipleSegmentsProvider",["invariant","ShakaSegmentReferenceHelper","VideoPlayerShakaGlobalConfig","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";a=function(){function a(a){this.$2=[],this.$3=[],this.$4=0,this.$5=c("emptyFunction"),this.$1=a}var b=a.prototype;b.getNumberOfSegments=function(){var a=this.$1;this.$1=Math.max(this.$1-d("VideoPlayerShakaGlobalConfig").getNumber("multi_segment_decay",0),1);return Math.ceil(a)};b.setFutureSegments=function(a){this.$2=a};b.setOnSegmentsUpdated=function(a){this.$5=a};b.clearOnSegmentsUpdated=function(){this.setOnSegmentsUpdated(c("emptyFunction"))};b.setSegments=function(a){var b=this.$3;this.$3=a;this.$5(b,a)};b.isRequestInBufferTarget=function(a,b){a=d("ShakaSegmentReferenceHelper").findIndexByRequestInfo(a,this.$3);if(a<0)return!1;a=this.$3[a];return a.startTime<b.bufferStart+b.bufferingGoal};b.setBufferingGoal=function(a){this.$4=a};b.$6=function(a){var b=[],c=d("ShakaSegmentReferenceHelper").findIndexByRequestInfo(a,this.$3);if(c>=0){var e=Math.min(this.$3.length,c+this.$1);for(c=c;c<e;c++)b.push(this.$3[c])}if(!b.length)return[{startByte:a.startByte,endByte:a.endByte}];c=b[0];e=b[b.length-1];return[{startByte:c.url.startByte||0,endByte:e.url.endByte}]};b.getFetchRanges=function(a){var b=this.$2;if(b.length===0)return this.$6(a);b.length>0||h(0,1467);a=b[0];b=b[b.length-1];return b.url.baseUrl!==a.url.baseUrl?[{startByte:a.url.startByte,endByte:a.url.endByte}]:[{startByte:a.url.startByte||0,endByte:b.url.endByte}]};b.getNextRequestInfo=function(a){var b=this.$3.findIndex(function(b){return b.url.baseUrl===a.baseUrl&&b.url.startByte===a.startByte});b=this.$3[b+1];return!b?null:{baseUrl:b.url.baseUrl,startByte:b.url.startByte,endByte:b.url.endByte}};b.getSegmentsBoundaries=function(a){if(this.$2.length===0)return[{startByte:a.startByte,endByte:a.endByte}];this.$2.length>0||h(0,1467);return this.$2.map(function(a){a=a.url;var b=a.startByte;a=a.endByte;return{startByte:b||0,endByte:a}})};b.getTimeRange=function(a){var b={startTime:null,endTime:null};this.$2.forEach(function(c){var d=c.url;if(!d)return;d.startByte===a.startByte&&(b.startTime=c.startTime);d.endByte===a.endByte&&(b.endTime=c.endTime)});return b};return a}();g["default"]=a}),98);
__d("NetworkStatusDetector",["EventEmitter","clearInterval","setIntervalAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";var h=1e3,i=9999;a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b;b=a.call(this)||this;b.$NetworkStatusDetector3=!0;b.$NetworkStatusDetector4=!1;b.$NetworkStatusDetector2=Date.now();b.$NetworkStatusDetector1=c("setIntervalAcrossTransitions")(function(){return b.$NetworkStatusDetector5()},h);return b}var d=b.prototype;d.destroy=function(){c("clearInterval")(this.$NetworkStatusDetector1)};d.$NetworkStatusDetector5=function(){var a=this.$NetworkStatusDetector2;this.$NetworkStatusDetector2=Date.now();var b=this.$NetworkStatusDetector3;this.$NetworkStatusDetector3=this.getOnLineStatus();this.emitIfOnLineStateChanges(a,this.$NetworkStatusDetector2,b,this.$NetworkStatusDetector3)};d.emitIfOnLineStateChanges=function(a,b,c,d){!c&&d?this.emit("onLine"):c&&!d&&this.emit("offLine");c=i;b-a>c&&this.emit("systemWake",{sleepStartTime:a,sleepEndTime:b})};d.informNetworkInterrupted=function(){this.$NetworkStatusDetector4||(this.$NetworkStatusDetector4=!0,this.emit("networkInterrupted"))};d.informNetworkResumed=function(){this.$NetworkStatusDetector4&&(this.$NetworkStatusDetector4=!1,this.emit("networkResumed"))};d.isNetworkInterrupted=function(){return this.$NetworkStatusDetector4};d.getOnLineStatus=function(){return window&&window.navigator&&window.navigator.onLine!==void 0?window.navigator.onLine:!0};return b}(c("EventEmitter"));g["default"]=a}),98);
__d("VideoSegmentInfoHelper",["URI","VideoAkamaiRequestHelper","VideoDashPrefetchCache","XHRRequest","getCrossOriginTransport"],(function(a,b,c,d,e,f){"use strict";var g;function a(a){a=a.requestInfo;var c=new(b("XHRRequest"))(h(a)).setMethod("GET").setResponseType("arraybuffer").setTransportBuilder(b("getCrossOriginTransport")),d=/livestream\-lookaside\.(facebook|workplace)\.com$/;d=d.test(c.getURI().getDomain());d&&c.setTransportBuilder(b("getCrossOriginTransport").withCredentials);if(b("VideoAkamaiRequestHelper").isAkamai(a.baseUrl)){var e=b("VideoAkamaiRequestHelper").getRequestHeaders(a);e&&Object.keys(e).forEach(function(a){c.setRequestHeader(a,e[a])})}return c}function c(a){a=a.requestInfo;var b=a.startByte;a=a.endByte;return b&&a?a-b:null}function h(a){var c=a.baseUrl,d=a.isPredictive,e=a.startByte,f=a.endByte;c=new(g||(g=b("URI")))(c);d&&(c=c.addQueryData({_nc_sc:1}));if(!b("VideoAkamaiRequestHelper").isAkamai(a.baseUrl)){if(e===0&&f==null)return c;c=c.addQueryData({bytestart:e});f!=null&&(c=c.addQueryData({byteend:f}))}return c}function d(a){return b("VideoDashPrefetchCache").hasCacheValue(h(a.requestInfo).toString())}function f(a){return a.baseUrl+","+(a.startByte||0)+(","+(a.endByte||0))}e.exports={createRequest:a,estimateRequestSize:c,getRequestUri:h,isPrefetchedRequest:d,getRequestCacheKey:f}}),null);
__d("SegmentsUpdateHelper",["ODS","ShakaConstants","VideoSegmentInfoHelper"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.updateSegments=function(b,c){var d=this;if(!c.length)return;var e=this.$2.get(b)||[],f=e[e.length-1];f=f?f.startTime:-1;var g=c.length;while(g>0){var h=c[g-1];if(h.startTime<=f)break;g--}h=c.slice(g);f=c.slice(0,g);this.$3(e,f);c=h.map(function(b){return a.createSegmentInfo(b)});c.forEach(function(a){d.$4(a),e.push(a)});this.$2.set(b,e)};a.createSegmentInfo=function(a){var b=a.startTime,c=a.endTime,d=a.url,e=a.unscaledStartTime;a=a.unscaledDuration;var f=d.baseUrl,g=d.isPredictive,h=d.startByte;d=d.endByte;return{segmentID:0,startTime:b,endTime:c,requestInfo:{baseUrl:f,isPredictive:g,startByte:h,endByte:d||void 0},unscaledStartTime:e,unscaledDuration:a}};b.$5=function(a,b){var c=b.startTime,d=b.endTime,e=b.url,f=b.unscaledStartTime;b=b.unscaledDuration;var g=e.baseUrl,h=e.startByte;e=e.endByte;a.segmentID=0;a.startTime=c;a.endTime=d;c=a.requestInfo;c.baseUrl=g;c.startByte=h;c.endByte=e||void 0;a.unscaledStartTime=f;a.unscaledDuration=b;return a};b.$3=function(b,e){if(!e.length)return;var f=e.length,g=function(){var a=e[f-1]||null;f--;return a},h=g(),i=Number.POSITIVE_INFINITY;for(var j=0;j<=b.length&&h!=null;j++){var k=b.length-j,l=b[k-1],m=k>=1?l.startTime:Number.NEGATIVE_INFINITY,n=void 0;if(m<=h.startTime&&h.endTime<=i){if(m===h.startTime){var o=d("VideoSegmentInfoHelper").getRequestCacheKey(l.requestInfo);n=this.$5(l,h);l=d("VideoSegmentInfoHelper").getRequestCacheKey(n.requestInfo);l!==o&&(this.$1["delete"](o),this.$4(n))}else{n=a.createSegmentInfo(h);this.$4(n);b.splice(k,0,n);m=n.startTime;l=c("ShakaConstants").strings.segment_update_helper_splice_path_entity_key;if(l){o=h.unscaledStartTime;k=h.unscaledDuration;typeof o==="number"&&typeof k==="number"&&n.unscaledStartTime===o&&n.unscaledDuration===k&&d("ODS").bumpEntityKey(2966,"videos.www.shaka",l)}}h=g();h!=null&&j+1>b.length&&j--}i=m}};b.$4=function(a){var b=d("VideoSegmentInfoHelper").getRequestCacheKey(a.requestInfo);this.$1.set(b,a)};return a}();g["default"]=a}),98);
__d("TrackedPromise",["Promise"],(function(a,b,c,d,e,f){"use strict";var g=window.Promise||b("Promise");b("Promise").resolve();a=function(){function a(a,b){var c=this;this.$3=!1;this.$1="pending";this.$2=a.then(function(a){c.$1="fulfilled";return a},function(a){c.$1="rejected";return g.reject(a)})}var b=a.prototype;b.getPromise=function(){this.$3=!0;return this.$2};b.isPending=function(){return this.$1==="pending"};b.getState=function(){return this.$1};return a}();f["default"]=a}),66);
__d("VideoSegmentPromiseBuffer",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.appendSegmentPromise=function(a,b){this.$1.set(a,b);return this};b.hasSegmentPromise=function(a){return this.$1.has(a)};b.getSegmentPromise=function(a){var b=this.$1.get(a)||null;b&&b.getState()==="rejected"&&this.$1["delete"](a);return b};b.hasOtherPendingSegments=function(a){var b=new Set(a);return Array.from(this.$1.entries()).some(function(a){return a[1].isPending()&&!b.has(a[0])})};b.isFirstPendingSegment=function(a){var b=this.$1.get(a);if(!b||!b.isPending())return!1;var c;for(var b=this.$1.entries(),d=Array.isArray(b),e=0,b=d?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=b.length)break;f=b[e++]}else{e=b.next();if(e.done)break;f=e.value}f=f;if(f[1].isPending()){c=f[0];break}}return c===a};b.clearAllSegmentPromises=function(){this.$1.clear();return this};b.removeSegmentPromisesOlderThan=function(a,b){if(!this.hasSegmentPromise(a)){this.$1.clear();return}for(var b=this.$1.keys(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;if(e===a)return;this.$1["delete"](e)}};b.removeSegmentPromise=function(a){this.$1["delete"](a)};return a}();f["default"]=a}),66);
__d("VideoClientEdgeCooperation",["clearTimeout","gkx","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){var h=c("gkx")("678909"),i="X-FB-CEC-Video-Limit".toLowerCase(),j=1e3*60*2,k=/[\r\n]+/,l=null,m=null;function n(){l=null,c("clearTimeout")(m),m=null}function a(a){o(a.getAllResponseHeaders())}function o(a){if(!h)return;a=a.trim().split(k);a.forEach(function(a){a=a.split(": ");var b=a.shift().toLowerCase();a=a.shift();b===i&&p(a)})}function b(a){if(!h)return;a=a.headers;if(!a.has(i))return;a=a.get(i);a&&p(a)}function p(a){a=a.match("s:([\\.0-9]+)");if(!a)return;a=Number(a[1]);l===null&&(l=a);a<=l&&(l=a,c("clearTimeout")(m),m=c("setTimeoutAcrossTransitions")(n,j))}function d(a,b){if(!h)return a;return l!==null?Math.min(a,b)*l:a}g.updateFromXHR=a;g.updateFromHeaders=o;g.updateFromResponse=b;g._updateFromLimitHeader=p;g.applyBandwidthLimit=d}),98);
__d("NetworkRequestPipelineStats",[],(function(a,b,c,d,e,f){"use strict";var g=5,h=.5,i=30;a=function(){function a(){this.$1={},this.$2={},this.$3=0,this.$4=new Set()}var b=a.prototype;b.addEntry=function(a,b){this.$3=Math.max(this.$3,a);if(!b)return;this.$1[a]=b;var c=this.$1[a-1];!this.$4.has(a-1)&&c&&this.$5(c,b,a);c=this.$1[a+1];!this.$4.has(a)&&c&&this.$5(b,c,a+1)};b.setNetworkIdle=function(){this.$4.add(this.$3)};b.$5=function(a,b,c){this.$2[c]=b.startTime+b.timeToFirstByte-(a.startTime+a.timeToLastByte)};b.getBandwidthAlignments=function(){return this.$2};b.getBandwidthUtilization=function(){var a=this,b=0,c=0;Object.keys(this.$2).forEach(function(d){d=Number.parseInt(d,10);var e=a.$2[d];d=a.$1[d];d=d.timeToLastByte-d.timeToFirstByte;b+=d;c+=Math.max(0,e)+d});return b/Math.max(1,c)};b.$6=function(a){a=[];var b=0;while(!0){var c=this.$1[this.$3-b];if(!c)break;c.timeToLastByte-c.timeToFirstByte>=i&&a.push(c);b++}return a};b.getEstimatedDownloadTime=function(a){if(a){var b=this.$7();return!b?0:a/b}return this.$8(function(a){return a.timeToLastByte-a.timeToFirstByte},{lastN:g,defaultValue:0})};b.$7=function(){return this.$8(function(a){return a.transferSize/(a.timeToLastByte-a.timeToFirstByte||1)},{lastN:g,defaultValue:0})};b.$8=function(a,b){var c=b.lastN;b=b.defaultValue;c=this.$6(c);return!c.length?b:c.reverse().reduce(function(b,c){return h*a(c)+(1-h)*b},a(c[0]))};b.getEstimatedTimeToFirstByte=function(){return this.$8(function(a){return a.timeToFirstByte},{lastN:g,defaultValue:5e3})};b.getOptimisticTimeToFirstByte=function(){var a=this.$6(g);if(!a.length)return 0;a=Math.min.apply(Math,a.map(function(a){return a.timeToFirstByte}));var b=this.$8(function(a){return a.timeToFirstByte},{lastN:g,defaultValue:5e3});return(a+b)/2};return a}();f["default"]=a}),66);
__d("VideoPlayerResourceTimer",[],(function(a,b,c,d,e,f){"use strict";a=function(a,b,c){if(performance.getEntriesByType){a=performance.getEntriesByName(a,"resource");var d=[];a.forEach(function(a){typeof a.responseEnd==="number"&&typeof a.responseStart==="number"&&typeof a.requestStart==="number"&&typeof a.connectEnd==="number"&&typeof a.connectStart==="number"&&typeof a.domainLookupEnd==="number"&&typeof a.domainLookupStart==="number"&&typeof a.transferSize==="number"&&a.responseEnd<=c&&a.startTime>=b&&d.push({entry:{timeToFirstByte:a.responseStart-a.startTime,timeToLastByte:a.responseEnd-a.startTime,timeToRequestStart:a.requestStart-a.startTime,timeToConectionEnd:a.connectEnd-a.startTime,timeToConnectionStart:a.connectStart-a.startTime,timeToDomainLookupEnd:a.domainLookupEnd-a.startTime,timeToDomainLookupStart:a.domainLookupStart-a.startTime,transferSize:a.transferSize,startTime:a.startTime},sort:a.responseEnd})});d.sort(function(a,b){return b.sort-a.sort});if(d.length)return d[0].entry}return null};f.getResourceTimingEntry=a}),66);
__d("getXHRRequestHandlerHelper",[],(function(a,b,c,d,e,f){"use strict";function g(a,b,c,d){var e=b.call(a);c.call(a,Object.assign(function(){e&&e.apply(void 0,arguments),d.apply(void 0,arguments)},e,d))}var h=function(){function a(a){this.$1=a}var b=a.prototype;b.addResponseHandler=function(a){g(this.$1,this.$1.getResponseHandler,this.$1.setResponseHandler,a);return this};b.addAbortHandler=function(a){g(this.$1,this.$1.getAbortHandler,this.$1.setAbortHandler,a);return this};b.addErrorHandler=function(a){g(this.$1,this.$1.getErrorHandler,this.$1.setErrorHandler,a);return this};b.addTimeoutHandler=function(a){g(this.$1,this.$1.getTimeoutHandler,this.$1.setTimeoutHandler,a);return this};b.addNetworkFailureHandler=function(a){g(this.$1,this.$1.getNetworkFailureHandler,this.$1.setNetworkFailureHandler,a);return this};return a}();function a(a){return new h(a)}f["default"]=a}),66);
__d("NetworkRequestPipeline",["EventEmitter","NetworkRequestPipelineStats","VideoPlayerResourceTimer","clearTimeout","getXHRRequestHandlerHelper","performanceNow","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";var h=2,i=1;a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,d){var e;e=a.call(this)||this;e.$NetworkRequestPipeline1=h;e.$NetworkRequestPipeline2=i;e.$NetworkRequestPipeline3=0;e.$NetworkRequestPipeline4=new(c("NetworkRequestPipelineStats"))();e.$NetworkRequestPipeline5=0;e.$NetworkRequestPipeline9=null;e.$NetworkRequestPipeline10=null;e.$NetworkRequestPipeline11=0;e.$NetworkRequestPipeline13=function(){e.$NetworkRequestPipeline12||(e.$NetworkRequestPipeline12=e.$NetworkRequestPipeline14(),e.$NetworkRequestPipeline10=null,e.$NetworkRequestPipeline15())};e.$NetworkRequestPipeline6=b;b=d||{};d=b.xhrHandleNetworkFailure;var f=b.maxConcurrentRequests,g=b.soothingFactor,j=b.fixFinishRequest;b=b.requestTimeout;e.$NetworkRequestPipeline7=!!d;e.$NetworkRequestPipeline8=!!j;e.$NetworkRequestPipeline6.setOnItemAdded(e.$NetworkRequestPipeline13);f!==void 0&&(e.$NetworkRequestPipeline1=f);g!==void 0&&(e.$NetworkRequestPipeline2=g);b!==void 0&&(e.$NetworkRequestPipeline11=b);e.$NetworkRequestPipeline13();return e}var e=b.prototype;e.$NetworkRequestPipeline16=function(){var a=this.$NetworkRequestPipeline3;this.$NetworkRequestPipeline3++;return a};e.$NetworkRequestPipeline15=function(){if(this.$NetworkRequestPipeline12&&this.$NetworkRequestPipeline5<this.$NetworkRequestPipeline1){var a=this.$NetworkRequestPipeline17(this.$NetworkRequestPipeline12);a||(this.$NetworkRequestPipeline12=null)}};e.$NetworkRequestPipeline18=function(a){if(a.hasEnded)return!1;c("clearTimeout")(a.timeout);a.hasEnded=!0;this.$NetworkRequestPipeline12=this.$NetworkRequestPipeline14();this.$NetworkRequestPipeline15();return!0};e.$NetworkRequestPipeline17=function(a){var b=this;if(a.xhrRequest)return!0;var e=c("performanceNow")(),f=this.$NetworkRequestPipeline6.dequeue();if(!f){this.$NetworkRequestPipeline4.setNetworkIdle();return!1}var g=f.xhrRequest;f=f.estimatedSize;var h=!1,i=function(){if(!b.$NetworkRequestPipeline8)return!1;if(h)return!0;h=!0;return!1},j,k=function(f){if(!i()){f=d("VideoPlayerResourceTimer").getResourceTimingEntry(g.getURI().toString(),e,c("performanceNow")());b.$NetworkRequestPipeline4.addEntry(a.id,f);b.$NetworkRequestPipeline5--;b.$NetworkRequestPipeline18(a)||b.$NetworkRequestPipeline15()}j&&j.remove()},l=function(){i()||(b.$NetworkRequestPipeline5--,b.$NetworkRequestPipeline18(a)||b.$NetworkRequestPipeline15()),j&&j.remove()};h||(j=this.addListener("evict",function(a){g===a.xhrRequest&&l()}));k=c("getXHRRequestHandlerHelper")(g).addResponseHandler(k).addAbortHandler(l).addErrorHandler(l).addNetworkFailureHandler(function(){b.$NetworkRequestPipeline7&&l()});this.$NetworkRequestPipeline11&&k.addTimeoutHandler(l);a.xhrRequest=g;this.$NetworkRequestPipeline5++;a.timeout=c("setTimeoutAcrossTransitions")(function(){b.$NetworkRequestPipeline18(a)},this.$NetworkRequestPipeline19(g,f||void 0));this.$NetworkRequestPipeline9=this.$NetworkRequestPipeline10;this.$NetworkRequestPipeline10=g.getURI().toString();this.$NetworkRequestPipeline11&&g.setTimeout(this.$NetworkRequestPipeline11);g.send();return!0};e.evictRequest=function(a){this.emit("evict",{xhrRequest:a})};e.getRecentBlockingRequestUrl=function(){return this.$NetworkRequestPipeline9};e.$NetworkRequestPipeline14=function(){var a=this.$NetworkRequestPipeline16();return{id:a,hasEnded:!1,xhrRequest:null,timeout:null}};e.$NetworkRequestPipeline19=function(a,b){a=this.$NetworkRequestPipeline4.getEstimatedDownloadTime(b);b=this.$NetworkRequestPipeline4.getEstimatedTimeToFirstByte();var c=this.$NetworkRequestPipeline4.getOptimisticTimeToFirstByte();return(a+b-c)*this.$NetworkRequestPipeline2};return b}(c("EventEmitter"));g["default"]=a}),98);
__d("PriorityRequestQueue",["invariant","EventEmitter"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$PriorityRequestQueue1=new Map(),c.$PriorityRequestQueue2=new Map(),c.$PriorityRequestQueue3=function(){},b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.dequeue=function(){return this.$PriorityRequestQueue4(Infinity)};c.setOnItemAdded=function(a){this.$PriorityRequestQueue3=a};c.$PriorityRequestQueue4=function(a){var b=-Infinity;Array.from(this.$PriorityRequestQueue1.keys()).forEach(function(c){c<a&&(b=Math.max(b,c))});if(b===-Infinity)return null;var c=this.$PriorityRequestQueue1.get(b);c||g(0,2413);c=this.$PriorityRequestQueue5(c);return c?c:this.$PriorityRequestQueue4(b)};c.$PriorityRequestQueue5=function(a){var b=a.queues,c=a.lastDequeued;if(!b.size)return null;var d=Array.from(b),e=c?d.findIndex(function(a){return a===c}):-1;for(var f=e+1;f<=e+b.size;f++){var g=f%b.size;g=d[g];var h=g.dequeue();if(h){a.lastDequeued=g;return h}}return null};c.setQueue=function(a,b){var c=this,d=this.$PriorityRequestQueue2.get(a);if(d===b)return;d||this.$PriorityRequestQueue3("append");this.removeQueue(a);d=this.$PriorityRequestQueue1.get(b);d||(d={lastDequeued:null,queues:new Set()});d.queues.add(a);a.setOnItemAdded(function(b){c.$PriorityRequestQueue6(a,b)});this.$PriorityRequestQueue2.set(a,b);this.$PriorityRequestQueue1.set(b,d)};c.removeQueue=function(a){var b=this.$PriorityRequestQueue7(a);a.setOnItemAdded(function(){});this.$PriorityRequestQueue2["delete"](a);b&&b.queues["delete"](a)};c.$PriorityRequestQueue6=function(a,b){this.$PriorityRequestQueue3(b),b==="prepend"&&this.$PriorityRequestQueue7(a)};c.$PriorityRequestQueue7=function(a){var b=this.$PriorityRequestQueue2.get(a);if(b!=null){b=this.$PriorityRequestQueue1.get(b);b||g(0,2414);var c=b.queues;if(b.lastDequeued===a){c=Array.from(c);var d=c.findIndex(function(b){return b===a});b.lastDequeued=c[d-1]||null}return b}return null};c.demandReschedule=function(){this.emit("demand_reschedule")};return b}(b("EventEmitter"));e.exports=a}),null);
__d("VideoPipelineProvider",["NetworkRequestPipeline","PriorityRequestQueue","ShakaConstants"],(function(a,b,c,d,e,f){"use strict";var g=new Map();function a(a){var c=g.get(a);if(!c){var d=new(b("PriorityRequestQueue"))(),e=b("ShakaConstants").numbers.request_pipeline_soothing_factor,f=b("ShakaConstants").numbers.request_pipeline_max_concurrent_requests;a==="audio"&&(e=b("ShakaConstants").numbers.audio_request_pipeline_soothing_factor,f=b("ShakaConstants").numbers.audio_request_pipeline_max_concurrent_requests);f=new(b("NetworkRequestPipeline"))(d,{xhrHandleNetworkFailure:!0,maxConcurrentRequests:f,soothingFactor:e,fixFinishRequest:!1,requestTimeout:b("ShakaConstants").numbers.request_pipeline_timeout_ms});c={requestQueue:d,pipeline:f};g.set(a,c)}return c}e.exports={getPriorityRequestQueueAndPipeline:a}}),null);
__d("VideoSegmentRequestQueue",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=function(){},this.$2=new Map(),this.$3=new Map()}var b=a.prototype;b.dequeue=function(){var a=this.$3.entries().next().value;if(a){this.$3["delete"](a[0]);return a[1]||null}a=this.$2.entries().next().value;if(!a)return null;this.$2["delete"](a[0]);return a[1]||null};b.setOnItemAdded=function(a){this.$1=a};b.append=function(a,b,c){this.$4(a,b,c,this.$2,"append");return this};b.clearNormalQueue=function(){this.$2.clear()};b.changeToTopPri=function(a){var b=this.$2.get(a);b&&(this.$2["delete"](a),this.$3.set(a,b))};b.removeTopPriSegment=function(a){var b=this.$3.get(a);this.$3["delete"](a);return b?b.xhrRequest:null};b.isEmpty=function(){return this.$2.size===0&&this.$3.size===0};b.prependTopPri=function(a,b,c){var d=this.$3;this.$3=new Map();this.$5(a,b,c,d,this.$3)};b.prepend=function(a,b,c){var d=this.$2;this.$2=new Map();this.$5(a,b,c,d,this.$2)};b.$5=function(a,b,c,d,e){var f=this;this.$4(a,b,c,e,"prepend");d.forEach(function(b,c){var a=b.xhrRequest;b=b.estimatedSize;f.$6(c,a,b,e)})};b.$4=function(a,b,c,d,e){this.$6(a,b,c,d),this.$1(e)};b.$6=function(a,b,c,d){b={xhrRequest:b,estimatedSize:c};d.set(a,b)};return a}();f["default"]=a}),66);
__d("createVideoResponsePromise",["Promise","ShakaConstants","VideoPlayerShakaError","getXHRRequestHandlerHelper","performanceNow"],(function(a,b,c,d,e,f,g){"use strict";var h=window.Promise||b("Promise");b("Promise").resolve();function a(a){var b,e=a.getURI().toString(),f=a.send;a.send=function(){b=c("performanceNow")(),f.call(a)};return new h(function(f,g){var h=c("getXHRRequestHandlerHelper")(a).addResponseHandler(function(a){f({response:a,responseTime:c("performanceNow")()-b})}).addAbortHandler(function(a){if(a==="reschedule")return;a={errorMsg:"Request aborted.",errorType:"abort",errorCode:"",errorRawTransportStatus:0,errorRawResponseHeaders:null};a=d("VideoPlayerShakaError").translateError(a,e,"aborted");g(a)}).addErrorHandler(function(a){a=d("VideoPlayerShakaError").translateError(a,e,"net");g(a)}).addNetworkFailureHandler(function(a){a=d("VideoPlayerShakaError").translateError(a,e,"net");g(a)});c("ShakaConstants").numbers.request_pipeline_timeout_ms&&h.addTimeoutHandler(function(){var a=d("VideoPlayerShakaError").createTimeoutError(e);g(a)})})}g["default"]=a}),98);
__d("VideoSegmentRequestPipeline",["ShakaConstants","SubscriptionsHandler","VideoClientEdgeCooperation","VideoPipelineProvider","VideoPlayerResourceTimer","VideoPlayerShakaError","VideoPriorityCalculator","VideoSegmentInfoHelper","VideoSegmentRequestQueue","createVideoResponsePromise","getXHRRequestHandlerHelper","performanceNow"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,e,f,g,h,i){var j=this;this.$2=new Map();this.$3=new Map();this.$4=null;this.$10=new Map();this.$11=new Map();this.$12=null;this.$14=0;this.$15=new(c("SubscriptionsHandler"))();this.$18=function(){if(j.$17()===d("VideoPriorityCalculator").getMaxPriority())return};this.$1=a;this.$16=h;this.$9=new(c("VideoSegmentRequestQueue"))();g=d("VideoPipelineProvider").getPriorityRequestQueueAndPipeline(b);a=g.requestQueue;h=g.pipeline;this.$12=a;this.$13=h;g=this.$12;g&&(g.setQueue(this.$9,this.$17()),this.$15.addSubscriptions(g.addListener("demand_reschedule",this.$18)));this.$7=b;this.$5=e;this.$6=i;this.$8=f}var b=a.prototype;b.enqueue=function(a,b){var e=this,f=d("VideoSegmentInfoHelper").createRequest(a),g=d("VideoSegmentInfoHelper").estimateRequestSize(a),h=c("createVideoResponsePromise")(f),i=f.send;f.send=function(){e.$10.set(a,f),e.$19(a,f,b),i.call(f)};this.$9.append(a,f,g);this.$20();return h};b.lockRequest=function(a){this.$9.changeToTopPri(a),this.$11.set(a,{lockedTime:c("performanceNow")(),rescheduleCount:0})};b.cancelUnlockedRequests=function(){var a=this;this.$9.clearNormalQueue();this.$10.forEach(function(b,c){a.$11.has(c)||(b.abort(),a.$10["delete"](c))})};b.abortLockedRequest=function(a){var b=this.$9.removeTopPriSegment(a);b&&b.abort();b=this.$10.get(a);b&&(b.abort(),this.$21(a))};b.$21=function(a){this.$10["delete"](a),this.$11["delete"](a)};b.unload=function(){this.$12&&this.$12.removeQueue(this.$9),this.$15.release()};b.setPriority=function(a){if(this.$17()===a)return;this.$14=a;var b=this.$12;b&&(b.setQueue(this.$9,a),this.$20())};b.getResourceTimingEntry=function(a){return this.$3.get(a)||null};b.$20=function(){var a=this.$12;a&&!this.$9.isEmpty()&&this.$17()>=d("VideoPriorityCalculator").getMaxPriority()&&a.demandReschedule()};b.$17=function(){return this.$14};b.$22=function(a){var b=this.$11.get(a)||{},c=b.lockedTime;b=b.rescheduleCount;b=(b||0)+1;this.$21(a);this.$11.set(a,{lockedTime:c,rescheduleCount:b})};b.$19=function(a,b,e){var f=this,g=b.getURI().toString(),h=this.$17(),i,j,k=this.$13.getRecentBlockingRequestUrl(),l=!1;k&&k!==this.$4&&(l=!0);j=this.$4;this.$4=g;if(a){var m=this.$23(g,h,l,e),n=c("performanceNow")(),o=function(){return!1};k=c("getXHRRequestHandlerHelper")(b).addResponseHandler(Object.assign(function(e,h){d("VideoClientEdgeCooperation").updateFromHeaders(h);f.$6&&f.$6.handleHeadersString(h);if(!o()){h=c("performanceNow")();var k=d("VideoPlayerResourceTimer").getResourceTimingEntry(g,n,h),l=e.byteLength;if(f.$8){h=k?f.$24(k,b,i,j):h-n;f.$8.sample(h,l,f.$7==="video",{timeToLastByte:h},null,f.$5,f.$1.getBool("evaluate_abr_on_fetch_end",!1))}m&&f.$25(a,m,e.byteLength,k,n);f.$21(a)}},{includeHeaders:!0})).addAbortHandler(function(b){if(!o()){var c={errorMsg:"Request aborted.",errorType:"abort",errorCode:"",errorRawTransportStatus:0,errorRawResponseHeaders:null};c=d("VideoPlayerShakaError").translateError(c,g,"aborted");b==="reschedule"?f.$22(a):f.$21(a);m&&m.setError(c).log()}}).addErrorHandler(function(b){if(!o()){b=d("VideoPlayerShakaError").translateError(b,g,"net");m&&m.setError(b).log();f.$21(a)}}).addNetworkFailureHandler(function(b){if(!o()){b=d("VideoPlayerShakaError").translateError(b,g,"net");m&&m.setError(b).log();f.$21(a)}});c("ShakaConstants").numbers.request_pipeline_timeout_ms&&k.addTimeoutHandler(function(){var b=d("VideoPlayerShakaError").createTimeoutError(g);m&&m.setError(b).log();f.$21(a)})}};b.$23=function(a,b,c,d){var e=null;this.$5&&(e=this.$5.getOperationLogger("request").setResource(a).start(),e.setReason(d).setPriorityFloat(b).setType(this.$7||null).setWasDelayed(c).setInitiator("pipeline"),this.$16&&e.setPushed(this.$16.getPushCountForUrl(a)));return e};b.$25=function(a,b,c,d,e){a=this.$11.get(a)||{};var f=a.lockedTime;a=a.rescheduleCount;var g=0;f&&(g=e-f);a||(a=0);b.setLength(c);if(d){e=d.timeToFirstByte;f=d.timeToLastByte;c=d.timeToRequestStart;b.setTimeToFirstByte(Math.round(e)).setTimeToLastByte(Math.round(f)).setTimeToRequestStart(Math.round(c)).setTimeToRequestSent(Math.round(g)).setRescheduleCount(Math.round(a))}b.log()};b.$24=function(a,b,c,d){var e=null;c&&(e=this.$2.get(c),this.$2["delete"](c));d&&(e=this.$3.get(d),this.$3["delete"](d));this.$3.set(b.getURI().toString(),a);if(e){c=e.startTime+e.timeToLastByte;d=a.startTime+a.timeToLastByte;b=Math.min(d-c,a.timeToLastByte);return Math.max(a.timeToLastByte-a.timeToFirstByte,b)}return a.timeToLastByte};return a}();g["default"]=a}),98);
__d("SegmentRequestManager",["invariant","BinarySearch","SegmentsUpdateHelper","ShakaConstants","TrackedPromise","VideoPriorityCalculator","VideoSegmentInfoHelper","VideoSegmentPromiseBuffer","VideoSegmentRequestPipeline"],(function(a,b,c,d,e,f,g,h){"use strict";var i=3;a=function(){function a(a,b,e,f,g,h,i,j){this.$2=new Map(),this.$3=new Map(),this.$4=new Map(),this.$5=null,this.$7=new(c("VideoSegmentPromiseBuffer"))(),this.$8=!1,this.$10=0,this.$1=a,this.$6=new(c("VideoSegmentRequestPipeline"))(a,b,f,g,h,i,j),this.$11=e||d("VideoPriorityCalculator").calculate}var b=a.prototype;b.updateSegmentIndex=function(a,b){this.$2.set(a,b)};b.updateSegmentsByShakaReferences=function(a,b){new(c("SegmentsUpdateHelper"))(this.$4,this.$3).updateSegments(a,b)};b.updateSegments=function(a,b){var c=this,e=this.getSegments_INTERNAL_USE_ONLY(a);b.forEach(function(a){var b=d("VideoSegmentInfoHelper").getRequestCacheKey(a.requestInfo);c.$4.has(b)||(c.$4.set(b,a),c.$12(e,a))});this.$3.set(a,e)};b.getSegments_INTERNAL_USE_ONLY=function(a){a=this.$3.get(a);return a||[]};b.hasSegment_INTERNAL_USE_ONLY=function(a){a=d("VideoSegmentInfoHelper").getRequestCacheKey(a.requestInfo);return this.$4.has(a)};b.updatePriorityWithNewPlayhead=function(a){this.$9&&(this.$9.playhead=a);this.$13();return this};b.updatePriorityWithNewPlayingState=function(a){this.$9&&(this.$9.isPlaying=a);this.$13();return this};b.updatePriorityWithNewAdjustment=function(a){if(a===this.$10)return this;a<=0||h(0,4433);this.$10=a;this.$13();return this};b.updatePlayerState=function(a,b){var c=this,d=this.$3.get(a);this.$9=b;if(!d)return this;var e=this.$5;this.$5=a;if(this.$8)return this;this.$13();d=this.$14(b,d);b=b.additionalSegmentsRequired;var f=[];b.length>0&&(f=this.$15(b),d=d.concat(f).sort(function(a,b){return a.startTime-b.startTime}));if(e!==a){this.$16();this.$17(d,f);return this}b=[];this.$7.hasOtherPendingSegments(d)?(this.$16(),b=d):(b=d.filter(function(a){return!c.$7.hasSegmentPromise(a)}),this.$7.removeSegmentPromisesOlderThan(d[0],this.$1));this.$17(b,f);return this};b.getPromise=function(a){a=d("VideoSegmentInfoHelper").getRequestCacheKey(a);a=this.$4.get(a);if(!a)throw new Error("the given request info is not found it segments cache ");var b=this.$7.getSegmentPromise(a),e;b&&(!b.isPending()||this.$7.isFirstPendingSegment(a))?e=b.getPromise():(this.$16(),e=this.$6.enqueue(a),b=new(c("TrackedPromise"))(e,this.$1),this.$7.appendSegmentPromise(a,b));this.$6.lockRequest(a);return e};b.getResourceTimingEntry=function(a){return this.$6.getResourceTimingEntry(a)};b.$15=function(a){var b=this,e=[];a.forEach(function(a){a=b.$4.get(d("VideoSegmentInfoHelper").getRequestCacheKey(c("SegmentsUpdateHelper").createSegmentInfo(a).requestInfo));a&&e.push(a)});return e};b.$12=function(a,b){var c=Number.POSITIVE_INFINITY;for(var d=0;d<=a.length;d++){var e=a.length-d,f=e>=1?a[e-1].startTime:Number.NEGATIVE_INFINITY;if(f<=b.startTime&&b.startTime<c){e===a.length?a.push(b):a.splice(e,0,b);return}c=f}};b.$13=function(){if(!this.$9)return;var a=this.$11(this.$9,c("ShakaConstants").numbers.global_scheduler_priority_threshold);a+=this.$10;this.$6.setPriority(a)};b.$16=function(){this.$6.cancelUnlockedRequests(),this.$7.clearAllSegmentPromises()};b.$17=function(a,b){for(var e=0;e<a.length;e++){var f=a[e];if(d("VideoSegmentInfoHelper").isPrefetchedRequest(f))return;var g=b.includes(f)?"replacing_lower_quality_buffer":null;g=this.$6.enqueue(f,g);this.$7.appendSegmentPromise(f,new(c("TrackedPromise"))(g,this.$1))}};b.abortRequest=function(a){a=d("VideoSegmentInfoHelper").getRequestCacheKey(a);a=this.$4.get(a);a&&(this.$6.abortLockedRequest(a),this.$7.removeSegmentPromise(a))};b.disable=function(){if(this.$8)return;this.$6.cancelUnlockedRequests();this.$6.unload();this.$8=!0};b.enable=function(){this.$8=!1};b.isDisabled=function(){return this.$8};b.$14=function(a,b){var c=a.playhead,d=a.bufferEnd;a=a.bufferingGoal;d=Math.max(d,c);var e=[];d=this.$18(d,b);for(d=Math.max(d,0);d<b.length;d++){var f=b[d];if(f.startTime>c+a)break;e.push(f)}return e};b.$18=function(a,b){var d=c("ShakaConstants").numbers.templated_chunked_segment_update_limit_int,e=b.length;if(!d)return this.$19(a,b);if(b.length>0){e=this.$19(a,b);if(e<b.length){var f=this.$20(b[e].startTime),g=this.$20(b[e].endTime),h=this.$20(a);if(f<=h&&g>h)return e}}f=this.$5||"";g=this.$2.get(f);if(!g)return e;e=g.findIndex(a);if(e<0)return b.length;h=Math.min(g.length(),e+d);d=[];for(var i=e;i<h;++i)d.push(g.get(i));e=b.length;this.updateSegmentsByShakaReferences(f,d);h=this.$3.get(f);return h?this.$19(a,h):e};b.$19=function(a,b){var c=this;return d("BinarySearch").leastUpperBound(function(d){var e=c.$20(b[d].startTime);d=c.$20(b[d].endTime);a=c.$20(a);return e<=a&&d>a?0:e-a},0,0,b.length,function(a,b){return a-b})};b.$20=function(a){return+a.toFixed(i)||0};return a}();g["default"]=a}),98);
__d("ShakaTimelineSegmentIndexUtils",["BinarySearch"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a,b,c){return Math.abs(a-b)<c},i=function(a,b,c){return!h(a,b,c)&&a-b<0},j=function(a,b,c){return h(a,b,c)||a-b<0},k=function(a,b,c){return h(a,b,c)||a-b>0};function l(b){var a=0;for(var c=0;c<b.length;++c)b[c].startSegmentIndex=a,a+=b[c].repeat+1;return a}function m(b,c,a){c=a-c;var d=0;if(a<1||c<0||b.length<1)throw new RangeError("Index out of range.");for(a=b.length-1;a>-1;--a){var e=b[a].repeat+1;d=e-c;if(d<0){c=Math.abs(d);continue}break}return{S:a,r:d}}function a(a,b,c,d){var e=b.length-1,f=1e-7,g=function(a){return a/c+d};for(;e>-1;--e)if(j(g(b[e].startTime),a,f))break;if(e===-1)return e;var h=b[e],l=h.duration/c,m=0;for(var n=0;n<e;++n)m+=b[n].repeat+1;n=g(h.startTime);var o=n+l*(h.repeat+1);if(k(a,o,f)&&b[e+1]&&i(a,g(b[e+1].startTime),f))return m+h.repeat;else if(k(a,o,f)&&!b[e+1])return-1;g=m+Math.floor((a-n)/l);n+=l*(g-m);o=n+l;return k(a,n,f)&&i(a,o,f)?g:g+1}function b(a,b,c,d){b=b-a;a=a;var e=0,f=0;for(var g=0;g<c.length;++g){var h=c[g],i=h.repeat;i=i+1;var j=Math.min(f+i,a);j=j-f;var k=h.startTime,l=void 0;j&&(l=k+j*h.duration,c[g+1]&&l>c[g+1].startTime&&(l=c[g+1].startTime),k=l,e=l);for(h=j;h<i;++h){j=null;l=k+c[g].duration;var m=c[g+1]&&h+1>=i&&l!==c[g+1].startTime;m&&(j=c[g+1].startTime-l,e=l,l=c[g+1].startTime);m=f+h;d(k,l,m,j,j!==null?e:j);if(--b<=0)return;a++;k=l;e=l}f+=i}}function c(a,b,c){var d=[];if(a.length>1){var e=0;for(var f=0;f<a.length;++f){var g=a[f],h=g.startTime;g=h+(g.repeat+1)*g.duration;if(f&&h!==e){var i=h-e;i>0&&d.push({start:e/b+c,end:h/b+c})}e=g}}return d}function n(a){var b=[];if(a.length===0)return b;b.push(a[0]);for(var c=1;c<a.length;++c){var d=b[b.length-1];if(d.duration!==a[c].duration){b.push(a[c]);continue}var e=d.startTime+d.duration*(d.repeat+1);if(e===a[c].startTime){d.repeat++;continue}b.push(a[c])}return b}function e(a,b){a=a.slice();b=b.slice();if(b.length===0)return a;if(a.length===0){for(var c=0;c<b.length;++c)a.push(b[c]);return a}c=a[a.length-1];var d=c.startTime+c.duration*c.repeat;c=d+c.duration;var e=b[b.length-1];e=e.startTime+e.duration*(e.repeat+1);var f=l(b),g=[];if(c!==e){for(c=f-1;c>-1;--c){e=m(b,c,f);var h=b[e.S],i=h.duration;h=h.startTime+i*e.r;if(d!==h)g.push({startTime:h,duration:i,repeat:0,startSegmentIndex:0});else break}while(g.length)a.push(g.pop())}return n(a)}function o(b,c,a){if(c+1>=a)return p(b,a);a=m(b,c+1,a);var d=a.S;a=a.r;var e=d,f=a;f===0?(d=e-1,a=b[d].repeat):(d=e,a=f-1);a=b[d].startTime+b[d].duration*a;d=a+b[d].duration;f=f!==0?null:b[e].startTime-d;var g=f?d:null;d=f?b[e].startTime:d;return{unscaledStartTime:a,unscaledEndTime:d,segmentReplacement:c,delta:f,previousEndTime:g}}function f(b,a){if(a<1||!b.length)throw new RangeError("Index out of range");return o(b,0,a)}function p(b,a){if(a<1||!b.length)throw new RangeError("Index out of range");var c=b.length-1,d=b[c].repeat;d=b[c].startTime+b[c].duration*d;b=d+b[c].duration;return{unscaledStartTime:d,unscaledEndTime:b,segmentReplacement:a-1,delta:null,previousEndTime:null}}function q(a,b,c){var d=c-a.startSegmentIndex;d=a.startTime+a.duration*d;var e=d+a.duration,f=null,g=null;if(b&&a.startSegmentIndex+a.repeat===c){a=b.startTime;f=a-e;f&&(g=e,e=a)}return{unscaledStartTime:d,unscaledEndTime:e,segmentReplacement:c,delta:f,previousEndTime:g}}function r(a,b,c){var d=a.startTime;c=(c-d)/a.duration;d=Math.floor(c)+1;var e=1e-7;c=h(c,d,e)?d:Math.floor(c);c+=a.startSegmentIndex;e=a.startSegmentIndex+a.repeat;return c<=e?c:b?e:-1}function s(a,b){return d("BinarySearch").findBoundInArray(a,b,function(a,b){return a.startTime-b},d("BinarySearch").GREATEST_LOWER_BOUND)}function t(a,b,c,d){a=(a-d)*c;d=s(b,a);c=b[d];b=b[d+1]||null;if(!c)return null;d=r(c,b,a);return d<0?null:q(c,b,d)}g.length=l;g.findSTagAndRepeatValueByIndex=m;g.findIndex=a;g.getSegments=b;g.getSeekRangeGaps=c;g.compressTimePoints=n;g.integrateTimePoints=e;g.get=o;g.first=f;g.last=p;g.find=t}),98);
__d("VideoPlayerBitrateEstimator",[],(function(a,b,c,d,e,f){"use strict";(function(){function a(){}var b=a.prototype;b.sample=function(a,b){};b.getTotalWeight=function(){return 0};b.getEstimate=function(){return 0};b.reset=function(){};return a})();a=function(){function a(a,b,c,d){this.$1=a,this.$2=b,this.$3=c,this.$4=d}var b=a.prototype;b.getEstimate=function(){return this.$1.getTotalWeight()<this.$3?this.$2:Math.round(this.$1.getEstimate())};b.sample=function(a,b){a=a/b;b=b;a>this.getEstimate()&&(b*=this.$4,this.$1.reset());this.$1.sample(b,a)};return a}();f["default"]=a}),66);
__d("VideoPlayerShakaBandwidthUtils",[],(function(a,b,c,d,e,f){"use strict";function g(a){var b=0;for(var c=0;c<a.length;c++)b+=a[c].bytes*8e3/a[c].timeInMs;return b/a.length}function h(a){var b=g(a),c=0;for(var d=0;d<a.length;d++)c+=Math.pow(a[d].bytes*8e3/a[d].timeInMs-b,2);return Math.round(Math.sqrt(c/a.length))}function i(a,b){b=Math.exp(Math.log(.5)/b);var c=0,d=0;for(var e=0;e<a.length;e++){var f=a[e].bytes*8e3/a[e].timeInMs,g=Math.pow(b,a[e].timeInMs/1e3);c=f*(1-g)+c*g;d+=a[e].timeInMs/1e3}return Math.round(c/(1-Math.pow(b,d)))}function j(a,b){var c=g(a),d=[];for(var e=0;e<a.length;e++)Math.abs(c-a[e].bytes*8e3/a[e].timeInMs)<b&&d.push(a[e]);return d}function a(a,b,c,d){var e=h(a);a=j(a,e*c);c=i(a,b);return c-e*d}f.getMeanBandwidth=g;f.getStandardDeviationOfBandwidth=h;f.getExponentiallyWeightedMovingAverageOfBandwidth=i;f.getBandwidthSamplesWithinRangeOfMean=j;f.getBandwidthEstimate=a}),66);
__d("RoundRobinPriorityTaskQueue",["oz-player/scheduling/OzRoundRobinPriorityTaskQueue"],(function(a,b,c,d,e,f,g){g["default"]=c("oz-player/scheduling/OzRoundRobinPriorityTaskQueue")}),98);
__d("SequentialTaskScheduler",["oz-player/scheduling/OzSequentialTaskScheduler"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/scheduling/OzSequentialTaskScheduler")}),98);
__d("VideoStreamingTaskQueueProvider",["RoundRobinPriorityTaskQueue","SequentialTaskScheduler","ShakaConstants","VideoPriorityCalculator"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map(),i=new Map();function a(a){a=j(a);return a?a.getLength():0}function j(a){var b=h.get(a);if(!b){b=new(c("RoundRobinPriorityTaskQueue"))(d("VideoPriorityCalculator").getMaxPriority(),c("ShakaConstants").numbers.priority_precision);var e=new(c("SequentialTaskScheduler"))(b,{taskTimeout:6e4});e.start();h.set(a,b);i.set(a,e)}return b}function b(a){return i.get(a)||null}g.getQueueSize=a;g.getQueue=j;g.getSchedulerForDebug=b}),98);
__d("getBandwidthPenaltyFactorForScheduledVideoCount",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c,d){a=Math.max(0,a-b+1);b=0;c=c;for(var e=1;e<=a;e++)b+=c,c*=d;return 1-b}f["default"]=a}),66);
__d("getNeuralBandwidthEstimate",[],(function(a,b,c,d,e,f){function a(a){var b=a;if(b.length>8)b=b.slice(0,8);else if(b.length<8)while(b.length<8)b.push(0);var c=1e9;return j(a.map(function(a){return a/c}))[0]*c}var g=[function(a,b){a=1/(1+Math.exp(-a));return!b?a:a*(1-a)}],h=[776e-6,0,0,0,0,0,0,0,.07993045087713074,.019315817148901328,.49837995466162727,.019521651881765512,.00021613261390548784,.07750491170273517,.06736225161443557,.0007569189868508071,.8409143388252623,.01986646603812691,.0007195506066612518],i=[0,0,0,0,0,0,0,0,-2.443292371536531,-3.9273261721766457,-.0064802040303537645,-3.9165163604073605,-8.439402229432238,-2.4767407404009374,-2.6279320641013375,-7.185497123350212,1.6650469917803437,-3.8986556349267514,-7.2361638886289805];function j(a){for(var b=0;b<a.length;b++)h[b]=a[b];i[8]=h[0]*-20.85073990285843+h[1]*-.17466848432563759+h[2]*-.057525299304308844+h[3]*.03110003879725791+h[4]*-.008895762588835858+h[5]*-.0683893713124604+h[6]*.06576749148339567+h[7]*-.01772020718777774+-2.4271121973719127;h[8]=g[0](i[8]);i[9]=h[0]*-529.6211404152259+h[1]*-10.085931929547788+h[2]*-4.540198005288279+h[3]*-2.6352715249222896+h[4]*-2.047125192304325+h[5]*-1.8521580652576841+h[6]*-2.4005121520581447+h[7]*-.07718938908000435+-3.5163401672144303;h[9]=g[0](i[9]);i[10]=h[0]*189.221355777461+h[1]*10.199243264545071+h[2]*4.697355964097093+h[3]*2.6339556539173423+h[4]*1.7925547331406204+h[5]*1.7015875595365062+h[6]*2.255633060777646+h[7]*.01805203313602992+-.15331597611366352;h[10]=g[0](i[10]);i[11]=h[0]*-19.43067537504266+h[1]*8.73022147952729+h[2]*4.820819354033675+h[3]*2.709578269559789+h[4]*1.978560568303787+h[5]*1.9830323294564676+h[6]*2.5745137738069044+h[7]*.09334179618953584+-3.9014381563163276;h[11]=g[0](i[11]);i[12]=h[0]*-5.048452581794674+h[1]*14.938163257617958+h[2]*8.784340440836452+h[3]*4.64012793867896+h[4]*3.1756670528730058+h[5]*2.620356039948262+h[6]*3.7942580850886625+h[7]*-.029713142657160185+-8.435484630228766;h[12]=g[0](i[12]);i[13]=h[0]*-21.10308480104038+h[1]*-.18020886205098594+h[2]*-.03715917747193107+h[3]*-.014443058733183056+h[4]*.08847178195128587+h[5]*.142772115586438+h[6]*-.0069832531579266015+h[7]*-.0921071783400488+-2.46036474659533;h[13]=g[0](i[13]);i[14]=h[0]*-24.614999084523344+h[1]*-.5706213316377333+h[2]*-.5315686923846422+h[3]*-.41561197239084546+h[4]*-.4622208593249528+h[5]*-.47076637110996444+h[6]*-.5160286139457088+h[7]*.09458872769476198+-2.6088308248117476;h[14]=g[0](i[14]);i[15]=h[0]*-10.646367946852898+h[1]*9.894069563224784+h[2]*6.38876106194455+h[3]*4.440529733916467+h[4]*3.4585448009421538+h[5]*3.1241038175984204+h[6]*3.6086610959448384+h[7]*-.05630455554937189+-7.177235541823454;h[15]=g[0](i[15]);i[16]=h[0]*169.19579326461104+h[1]*10.173311065987626+h[2]*4.643577083747655+h[3]*2.5947613769479383+h[4]*1.8128565992680805+h[5]*1.7184203818262473+h[6]*2.2652341722655147+h[7]*-.013828130098586827+1.5337510562070056;h[16]=g[0](i[16]);i[17]=h[0]*-18.836521088957262+h[1]*.07459368402448659+h[2]*.060777588023931+h[3]*.18289413867450946+h[4]*.16801985006774095+h[5]*.16611109930358084+h[6]*.09992971037111033+h[7]*.01144813346735582+-3.8840384945617203;h[17]=g[0](i[17]);i[18]=h[8]*-10.700053978575285+h[9]*-137.47854623908006+h[10]*11.958608720277157+h[11]*-7.615750916889078+h[12]*-5.975976449386021+h[13]*-10.809028988340401+h[14]*-11.738069079393329+h[15]*-5.935205222074537+h[16]*-38.98332368718187+h[17]*-9.626144857503322+25.07046089429775;h[18]=g[0](i[18]);return[h[18]]}f["default"]=a}),66);
__d("VideoPlayerLocalBandwidthEstimator",["EventEmitter","EventListener","ShakaConstants","SubscriptionsHandler","VideoPlayerShakaBandwidthUtils","VideoStreamingTaskQueueProvider","getBandwidthPenaltyFactorForScheduledVideoCount","getNeuralBandwidthEstimate","guid","requireWeak"],(function(a,b,c,d,e,f,g){c("requireWeak")("Shaka",function(a){a&&a.util&&a.util.EWMACacheBandwidthEstimator});a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,d,e){var f;f=a.call(this)||this;f.$VideoPlayerLocalBandwidthEstimator3=b;f.$VideoPlayerLocalBandwidthEstimator1=d;f.$VideoPlayerLocalBandwidthEstimator4=e;f.$VideoPlayerLocalBandwidthEstimator5=[];f.$VideoPlayerLocalBandwidthEstimator6=null;f.$VideoPlayerLocalBandwidthEstimator7=c("guid")();f.$VideoPlayerLocalBandwidthEstimator10=new(c("SubscriptionsHandler"))();f.$VideoPlayerLocalBandwidthEstimator10.addSubscriptions(c("EventListener").listen(f.$VideoPlayerLocalBandwidthEstimator1,"bandwidth",function(a){return f.emit("bandwidth",a)}));return f}var e=b.prototype;e.destroy=function(){this.$VideoPlayerLocalBandwidthEstimator10!=null&&this.$VideoPlayerLocalBandwidthEstimator10.release()};e.setRepresentationID=function(a){this.$VideoPlayerLocalBandwidthEstimator6=a};e.sample=function(a,b,c,d,e,f,g){g===void 0&&(g=!1);c&&this.$VideoPlayerLocalBandwidthEstimator6&&this.$VideoPlayerLocalBandwidthEstimator11(a,b,this.$VideoPlayerLocalBandwidthEstimator6,this.$VideoPlayerLocalBandwidthEstimator3.getVideoTracks());a=[a,b,c,d,e,f,g,!1];(b=this.$VideoPlayerLocalBandwidthEstimator1).sample.apply(b,a);if(this.$VideoPlayerLocalBandwidthEstimator2){(c=this.$VideoPlayerLocalBandwidthEstimator2).sample.apply(c,a)}};e.getRecentSamples=function(){return this.$VideoPlayerLocalBandwidthEstimator1.getRecentSamples()};e.supportsCaching=function(){return this.$VideoPlayerLocalBandwidthEstimator1.supportsCaching()};e.getEstimator=function(){return this.$VideoPlayerLocalBandwidthEstimator1};e.getBandwidth=function(a){var b=0,e=this.$VideoPlayerLocalBandwidthEstimator12(),f=c("ShakaConstants").numbers.minimum_sample_count_to_use_new_estimator,g=c("ShakaConstants").numbers.minimum_sample_count_to_use_deviation_penalty;if(f>0){var h=this.getRecentSamples();if(h.length>=f){f=d("VideoPlayerShakaBandwidthUtils").getBandwidthEstimate(h.map(function(a){return{bytes:a[0],timeInMs:a[1]}}),c("ShakaConstants").numbers.new_estimator_half_life,c("ShakaConstants").numbers.new_estimator_standard_deviation_exclusion_factor,c("ShakaConstants").numbers.bandwidth_standard_deviation_penalty_factor);if(f>0)return e*f}}else if(g>0){h=this.getRecentSamples();if(h.length>=g){f=d("VideoPlayerShakaBandwidthUtils").getStandardDeviationOfBandwidth(h.map(function(a){return{bytes:a[0],timeInMs:a[1]}}));b=f*c("ShakaConstants").numbers.bandwidth_standard_deviation_penalty_factor}}g=c("ShakaConstants").numbers.neural_estimate_weight;return g>0?e*this.$VideoPlayerLocalBandwidthEstimator13():e*this.$VideoPlayerLocalBandwidthEstimator1.getBandwidth(a)-b};e.setResolutionConstraint=function(a,b){this.$VideoPlayerLocalBandwidthEstimator8=a,this.$VideoPlayerLocalBandwidthEstimator9=b};e.$VideoPlayerLocalBandwidthEstimator12=function(){var a=c("getBandwidthPenaltyFactorForScheduledVideoCount")(d("VideoStreamingTaskQueueProvider").getQueue("video").getLength(),c("ShakaConstants").numbers.multiple_videos_queue_penalty_start_count,this.$VideoPlayerLocalBandwidthEstimator4.getNumber("bandwidth_penalty_per_additional_video",0),c("ShakaConstants").numbers.bandwidth_penalty_decay_per_video);return a>0&&a<=1?a:1};e.$VideoPlayerLocalBandwidthEstimator13=function(a){var b=c("ShakaConstants").numbers.minimum_samples_to_use_neural_estimate,d=this.$VideoPlayerLocalBandwidthEstimator1.getRecentSamples();a=this.$VideoPlayerLocalBandwidthEstimator1.getBandwidth(a);if(b>d.length)return a;d.reverse();b=c("getNeuralBandwidthEstimate")(d.map(function(a){return a[0]/a[1]*8e3}));d=c("ShakaConstants").numbers.neural_estimate_weight;return b*d+a*(1-d)};e.$VideoPlayerLocalBandwidthEstimator11=function(a,b,c,d){var e=this;b=8e3*b/a;a=d.filter(function(a){return a.width<=e.$VideoPlayerLocalBandwidthEstimator8||a.height<=e.$VideoPlayerLocalBandwidthEstimator9});var f=this.$VideoPlayerLocalBandwidthEstimator14(b,d);b=this.$VideoPlayerLocalBandwidthEstimator14(b,a);a=d.find(function(a){return a.streamInfoID===c});if(a){d=a.id;a=this.$VideoPlayerLocalBandwidthEstimator15(f,d);f=this.$VideoPlayerLocalBandwidthEstimator15(b,d);a!==f&&(a==="conservative"&&f==="ideal"&&(a="conservative_resolution_constrained"));this.$VideoPlayerLocalBandwidthEstimator5.push(a)}};e.$VideoPlayerLocalBandwidthEstimator14=function(a,b){var c=0;for(var d=0;d<b.length;d++){if(a<=b[d].bandwidth)break;c=b[d].id}return c};e.$VideoPlayerLocalBandwidthEstimator15=function(a,b){return a===b?"ideal":a>b?"conservative":"aggressive"};e.flushABREvaluationSet=function(){var a=this.$VideoPlayerLocalBandwidthEstimator5;this.$VideoPlayerLocalBandwidthEstimator5=[];return a};return b}(c("EventEmitter"));g["default"]=a}),98);
__d("crc16",[],(function(a,b,c,d,e,f){var g=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];function h(a){var b=65535;for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);if(d>255)throw new RangeError();d=(d^b>>8)&255;b=g[d]^b<<8}return(b^0)&65535}function a(a){return h(a).toString(16).padStart(4,"0")}h.hex=a;b=h;f["default"]=b}),66);
__d("VideoPushTracker",["URI","crc16"],(function(a,b,c,d,e,f,g){a=function(){function a(){this.$1=0,this.$2=new Map()}var b=a.prototype;b.addPushDataFromXHR=function(a){var b=this,c=a.getResponseHeader("X-FB-Debug-Num-Pushed");a=a.getResponseHeader("X-FB-Debug-List-Pushed");if(!a||!c)return;c=parseInt(c,10);var d=[];if(a.length%4)return;var e=a.length/4;for(var f=0;f<e;f++)d.push(a.substr(f*4,4));c!=d.length;if(!c)return;this.$1+=c;d.forEach(function(a){b.$2.set(a,(b.$2.get(a)||0)+1)})};b.getPushCountForUrl=function(a){a=new(c("URI"))(a);a=c("crc16").hex(a.getPath());return this.$2.get(a)||0};return a}();g["default"]=a}),98);
__d("FetchStreamStateTracker",["invariant"],(function(a,b,c,d,e,f,g,h){"use strict";a=function(){function a(){}var b=a.prototype;b.setNextRequestInfo=function(a){this.$1=this.$2,this.$2=a};b.setFetchRange=function(a){this.$3=a};b.isNextRequestContinuous=function(){this.$2||h(0,3883);if(!this.$1)return!1;return this.$1.baseUrl!==this.$2.baseUrl||(this.$1.endByte||0)+1!==(this.$2.startByte||0)?!1:!0};b.isNextRequestInRange=function(){this.$2||h(0,3883);if(!this.$3)return!1;var a=Infinity,b=this.$3.endByte;b!=null&&(a=b);return(this.$2.endByte||0)<=a};return a}();g["default"]=a}),98);
__d("NetworkErrorTransformStream",["ReadableStream","WritableStream","pipeErrorTo"],(function(a,b,c,d,e,f,g){"use strict";a=function(){var a=b.prototype;a.$3=function(a){this.$1.enqueue(a)};function b(){var a=this;this.writable=new(c("WritableStream"))({start:function(b){a.$2=b},write:function(b){a.$3(b)},close:function(){a.$1.close()},abort:function(b){var d=b;b instanceof TypeError&&(d={type:"net",status:0,message:"Network failure."});c("pipeErrorTo")(a.$1,d)}});this.readable=new(c("ReadableStream"))({start:function(b){a.$1=b},cancel:function(b){c("pipeErrorTo")(a.$2,b)}})}return b}();g["default"]=a}),98);
__d("StreamBandwidthReporter",["EventEmitter","ReadableStream","ShakaConstants","WritableStream","performanceNow","pipeErrorTo"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(d,a);var b=d.prototype;b.$StreamBandwidthReporter13=function(a){this.$StreamBandwidthReporter11.enqueue(a)};function d(b,d,e){var f;f=a.call(this)||this;f.$StreamBandwidthReporter2=null;f.$StreamBandwidthReporter3=0;f.$StreamBandwidthReporter4=0;f.$StreamBandwidthReporter8=0;f.$StreamBandwidthReporter9=Infinity;f.$StreamBandwidthReporter1=b;f.$StreamBandwidthReporter2=f.$StreamBandwidthReporter1.getNumber("streaming_bandwidth_update_interval",18e4);f.$StreamBandwidthReporter7=e;f.$StreamBandwidthReporter9=d;f.$StreamBandwidthReporter2&&(f.$StreamBandwidthReporter10=f.$StreamBandwidthReporter9,f.$StreamBandwidthReporter14());f.writable=new(c("WritableStream"))({start:function(a){f.$StreamBandwidthReporter5=f.$StreamBandwidthReporter6=c("performanceNow")(),f.$StreamBandwidthReporter12=a},write:function(a){a.length!=null&&(f.$StreamBandwidthReporter3+=a.length),f.$StreamBandwidthReporter15(),f.$StreamBandwidthReporter13(a)},close:function(){f.$StreamBandwidthReporter11.close(),f.$StreamBandwidthReporter16()},abort:function(a){c("pipeErrorTo")(f.$StreamBandwidthReporter11,a)}});f.readable=new(c("ReadableStream"))({start:function(a){f.$StreamBandwidthReporter11=a},cancel:function(a){c("pipeErrorTo")(f.$StreamBandwidthReporter12,a)}});return f}b.$StreamBandwidthReporter17=function(){var a=c("ShakaConstants").numbers.max_bandwidth_update_interval;return a>0?c("performanceNow")()>this.$StreamBandwidthReporter5+a:!1};b.$StreamBandwidthReporter15=function(){var a=this.$StreamBandwidthReporter9+this.$StreamBandwidthReporter3,b=this.$StreamBandwidthReporter18();(this.$StreamBandwidthReporter17()||b!=null&&a>=b)&&this.$StreamBandwidthReporter16()};b.$StreamBandwidthReporter16=function(){if(this.$StreamBandwidthReporter4===this.$StreamBandwidthReporter3)return;var a=c("performanceNow")();this.$StreamBandwidthReporter14();this.emit("bandwidthUpdate",{bytesRead:this.$StreamBandwidthReporter3-this.$StreamBandwidthReporter4,timeTaken:a-this.$StreamBandwidthReporter5});this.$StreamBandwidthReporter5=a;this.$StreamBandwidthReporter4=this.$StreamBandwidthReporter3};b.$StreamBandwidthReporter18=function(){return this.$StreamBandwidthReporter10!=null?this.$StreamBandwidthReporter10:this.$StreamBandwidthReporter7[this.$StreamBandwidthReporter8]};b.$StreamBandwidthReporter14=function(){this.$StreamBandwidthReporter17()?this.$StreamBandwidthReporter10=this.$StreamBandwidthReporter9+this.$StreamBandwidthReporter3+this.$StreamBandwidthReporter2:this.$StreamBandwidthReporter10!=null?this.$StreamBandwidthReporter10+=this.$StreamBandwidthReporter2:this.$StreamBandwidthReporter8++};return d}(c("EventEmitter"));g["default"]=a}),98);
__d("StreamFetchRequestLogger",["PausableRangeStream","ReadableStream","VideoPlayerResourceTimer","WritableStream","performanceNow","pipeErrorTo"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d,e,f,g,h){var i=this;this.$6=0;this.$9=null;this.$10=0;this.$3=d;this.$2=g;this.$1=a;this.$4=b;this.$5=f;this.$11=e;this.$8=h;this.writable=new(c("WritableStream"))({start:function(a){i.$14(),i.$13=a},write:function(a){i.$6+=a.byteLength,i.$9&&(i.$10=Math.round(Math.max(i.$10,c("performanceNow")()-(i.$9||Infinity)))),i.$9=c("performanceNow")(),i.$15(a)},close:function(){i.$12.close(),i.$16()},abort:function(a){c("pipeErrorTo")(i.$12,a),i.$17(a)}});this.readable=new(c("ReadableStream"))({start:function(a){i.$12=a},cancel:function(a){c("pipeErrorTo")(i.$13,a);a={type:a===c("PausableRangeStream").STREAM_PAUSED?"paused":"aborted",status:0,url:i.$3};i.$17(a)}})}var b=a.prototype;b.$14=function(){this.$7=this.$1.getOperationLogger("fetch_stream").setSegmentStartTime(this.$11.startTime).setSegmentEndTime(this.$11.endTime).setResource(this.$3).start();this.$7.setPriorityFloat(this.$8);var a=this.$5,b=a.startByte;a=a.endByte;a=a===null?null:(a||0)+1-b;this.$7.setType(this.$4).setExpectedLength(a)};b.$17=function(a){this.$7.setError(a).setTimeBetweenBytesMax(this.$10).setLength(this.$6).log()};b.$16=function(){var a=d("VideoPlayerResourceTimer").getResourceTimingEntry(this.$3,this.$2,c("performanceNow")());if(a){var b=a.timeToFirstByte,e=a.timeToLastByte;a=a.timeToRequestStart;this.$7.setTimeToFirstByte(Math.round(b)).setTimeToLastByte(Math.round(e)).setTimeToRequestStart(Math.round(a)).setLength(this.$6)}this.$7.setTimeBetweenBytesMax(this.$10).log()};b.$15=function(a){this.$12.enqueue(a)};return a}();g["default"]=a}),98);
__d("VideoPriorityUpdater",["EventEmitter","ShakaConstants","VideoPriorityCalculator"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var d;c===void 0&&(c=[]);d=a.call(this)||this;d.$VideoPriorityUpdater3=0;d.$VideoPriorityUpdater4=[];d.$VideoPriorityUpdater1=b;d.$VideoPriorityUpdater4=c.slice(0);c.forEach(function(a){return a.setOnPriorityChanged(function(){d.$VideoPriorityUpdater5()})});return d}var e=b.prototype;e.updatePriorityWithNewPlayhead=function(a){this.$VideoPriorityUpdater2&&(this.$VideoPriorityUpdater2.playhead=a);this.$VideoPriorityUpdater5();return this};e.updatePriorityWithNewPlayingState=function(a){this.$VideoPriorityUpdater2&&(this.$VideoPriorityUpdater2.isPlaying=a);this.$VideoPriorityUpdater5();return this};e.updatePriorityWithNewPlayerState=function(a){this.$VideoPriorityUpdater2=a;this.$VideoPriorityUpdater5();return this};e.$VideoPriorityUpdater5=function(){if(!this.$VideoPriorityUpdater2)return;var a=c("ShakaConstants").numbers.global_scheduler_priority_downgrade_bufferahead_threshold,b=c("ShakaConstants").numbers.global_scheduler_priority_threshold;this.$VideoPriorityUpdater3>=d("VideoPriorityCalculator").getMaxPriority()&&a&&(b=a);a=this.$VideoPriorityUpdater4.reduce(function(a,b){return a+b.getPriorityAdjustment()},0);b=d("VideoPriorityCalculator").calculate(this.$VideoPriorityUpdater2,b)+a;b!==this.$VideoPriorityUpdater3&&(this.$VideoPriorityUpdater3=b,this.emit("priority_updated",b))};return b}(c("EventEmitter"));g["default"]=a}),98);
__d("createErrorStream",["oz-player/networks/OzCreateErrorStream"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("oz-player/networks/OzCreateErrorStream")}),98);
__d("VideoSegmentStreamByFetch",["invariant","VideoAkamaiRequestHelper","VideoClientEdgeCooperation","VideoSegmentInfoHelper","createErrorStream"],(function(a,b,c,d,e,f,g,h){"use strict";var i=window.fetch;a=function(){function a(a){this.$1=a}var b=a.prototype;b.getResourceUrl=function(a){a=this.$2(a);a=d("VideoSegmentInfoHelper").getRequestUri(a);return a.toString()};b.startStream=function(a){i||h(0,3362);var b=this.getResourceUrl(a),e={};if(d("VideoAkamaiRequestHelper").isAkamai(b)){a=this.$2(a);e=d("VideoAkamaiRequestHelper").getRequestHeaders(a)||{}}return i(b,{headers:e}).then(function(a){d("VideoClientEdgeCooperation").updateFromResponse(a);var e=a.body,f=a.status;a=a.ok;if(!a)return c("createErrorStream")({type:"net",status:f,url:b,message:"HTTP error."});e.getReader||h(0,3287);return e})["catch"](function(a){return a instanceof TypeError?c("createErrorStream")({type:"net",status:0,url:b,message:"Network failure."}):c("createErrorStream")({type:"stream_processing",status:0,url:b,message:"Stream processing error."+a})})};b.$2=function(a){return{baseUrl:this.$1,startByte:a.startByte,endByte:a.endByte===null?void 0:a.endByte}};return a}();g["default"]=a}),98);
__d("VideoStreamingManager",["ChunkableContinuousRangeStream","ContinuousPausableStreamTask","EventEmitter","FetchStreamStateTracker","FixedSizeTransform","MaybeNativePromise","NetworkErrorTransformStream","PausableRangeStream","ReadableStream","ShakaConstants","StreamBandwidthReporter","StreamFetchRequestLogger","SubscriptionsHandler","VideoPriorityCalculator","VideoPriorityUpdater","VideoSegmentStreamByFetch","VideoStreamingTaskQueueProvider","WritableStream","performanceNow"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,e,f,g,h){var i;f===void 0&&(f="video");g===void 0&&(g=null);h===void 0&&(h=[]);i=a.call(this)||this;i.$VideoStreamingManager9=[];i.$VideoStreamingManager10=null;i.$VideoStreamingManager13=new(c("SubscriptionsHandler"))();i.$VideoStreamingManager14=Infinity;i.$VideoStreamingManager16=null;i.$VideoStreamingManager17=!1;i.$VideoStreamingManager20=function(a,b){i.$VideoStreamingManager17=!1};i.$VideoStreamingManager19=function(a){if(a===i.$VideoStreamingManager14)return;i.$VideoStreamingManager14=a;i.$VideoStreamingManager5&&i.$VideoStreamingManager5.getEventLogger("priority_changed").setPriorityFloat(i.$VideoStreamingManager14).log();var b=i.$VideoStreamingManager10;if(!b)return;b.updatePriority(i.$VideoStreamingManager14);var c=i.$VideoStreamingManager6;if(!c||c.isClosed())return;a>=d("VideoPriorityCalculator").getMaxPriority()?i.$VideoStreamingManager15&&i.$VideoStreamingManager25(i.$VideoStreamingManager15):c.removeQueuedRange();i.$VideoStreamingManager11&&i.$VideoStreamingManager11.updatePriority(b,i.$VideoStreamingManager14)};i.$VideoStreamingManager1=b;i.$VideoStreamingManager4=new(c("FetchStreamStateTracker"))();i.$VideoStreamingManager3=e;i.$VideoStreamingManager5=g;i.$VideoStreamingManager7=f;i.$VideoStreamingManager11=d("VideoStreamingTaskQueueProvider").getQueue(f);i.$VideoStreamingManager12=new(c("VideoPriorityUpdater"))(i.$VideoStreamingManager1,h);i.$VideoStreamingManager13.addSubscriptions(i.$VideoStreamingManager12.addListener("priority_updated",i.$VideoStreamingManager19));i.$VideoStreamingManager3.setOnSegmentsUpdated(i.$VideoStreamingManager20);return i}var e=b.prototype;e.getStream=function(a){return this.$VideoStreamingManager1.getBool("use_continuous_streaming",!0)?this.$VideoStreamingManager21(a):this.$VideoStreamingManager22(a)};e.getPriorityUpdater=function(){return this.$VideoStreamingManager12};e.getProgressTracker=function(){return this.$VideoStreamingManager16};e.resumeVideoFetching=function(){this.$VideoStreamingManager17=!1,this.$VideoStreamingManager23()};e.stopUntilSegmentsUpdate=function(){this.$VideoStreamingManager10&&this.$VideoStreamingManager10.cancelOnCurrentStreamDone(),this.$VideoStreamingManager17=!0};e.updatePlayerState=function(a){this.$VideoStreamingManager18=a,this.$VideoStreamingManager12.updatePriorityWithNewPlayerState(a)};e.destroy=function(){this.$VideoStreamingManager16!=null&&this.$VideoStreamingManager16.destroy(),this.$VideoStreamingManager13.release(),this.$VideoStreamingManager10&&this.$VideoStreamingManager10.cancel(),this.$VideoStreamingManager10&&this.$VideoStreamingManager11&&this.$VideoStreamingManager11.remove(this.$VideoStreamingManager10),this.$VideoStreamingManager24(),this.$VideoStreamingManager3&&this.$VideoStreamingManager3.clearOnSegmentsUpdated()};e.$VideoStreamingManager24=function(){this.$VideoStreamingManager6&&this.$VideoStreamingManager6.destroy(),this.$VideoStreamingManager6=null};e.$VideoStreamingManager26=function(){var a=this,b=function b(){if(!a.$VideoStreamingManager9.length)return c("MaybeNativePromise").resolve(null);var d=a.$VideoStreamingManager9[0];return d().then(function(c){if(!c){if(a.$VideoStreamingManager9.length===1)return null;a.$VideoStreamingManager9.shift();return b()}return c})};return b};e.$VideoStreamingManager23=function(){var a=this;if(this.$VideoStreamingManager10||this.$VideoStreamingManager17)return;var b=new(c("ContinuousPausableStreamTask"))(this.$VideoStreamingManager26(),this.$VideoStreamingManager7,this.$VideoStreamingManager14,this.$VideoStreamingManager5,{uncancellablePriority:Infinity,disableAudioStreamPause:!1,yieldOnLowPriStream:!1,lowPriTaskYieldCheckInterval:c("ShakaConstants").numbers.low_pri_task_yield_check_interval,lowPriTaskMinBytesToYield:c("ShakaConstants").numbers.low_pri_task_min_bytes_to_yield,lowPriTaskYieldsPerTask:c("ShakaConstants").numbers.low_pri_task_yields_per_task});this.$VideoStreamingManager10=b;var d;this.$VideoStreamingManager11?(this.$VideoStreamingManager11.enqueue(b,this.$VideoStreamingManager14),d=b.getPromise()):d=b.run();d.then(function(){a.$VideoStreamingManager10=null})["catch"](function(b){a.$VideoStreamingManager10=null,b.message==="cancelled"&&a.$VideoStreamingManager23()})};e.$VideoStreamingManager27=function(a,b){var c=a.startByte,e=a.endByte;return b>=d("VideoPriorityCalculator").getMaxPriority()?this.$VideoStreamingManager3.getFetchRanges(a):[{startByte:c,endByte:e}]};e.$VideoStreamingManager28=function(a){this.$VideoStreamingManager15=a;a=a.baseUrl;this.$VideoStreamingManager8&&this.$VideoStreamingManager8!==a&&this.$VideoStreamingManager24();this.$VideoStreamingManager8=a};e.$VideoStreamingManager29=function(a){this.$VideoStreamingManager6==null&&(this.$VideoStreamingManager6=this.$VideoStreamingManager30(a)),this.$VideoStreamingManager25(a)};e.$VideoStreamingManager21=function(a){var b=this;this.$VideoStreamingManager28(a);this.$VideoStreamingManager29(a);var d=a.startByte,e=a.endByte;return!this.$VideoStreamingManager6?c("MaybeNativePromise").reject():this.$VideoStreamingManager6.getReservedChunkStream({startByte:d,endByte:e}).then(function(a){b.$VideoStreamingManager23();return a})["catch"](function(c){b.$VideoStreamingManager6=b.$VideoStreamingManager30(a);return b.$VideoStreamingManager6.getReservedChunkStream({startByte:d,endByte:e}).then(function(a){b.$VideoStreamingManager23();return a})})};e.$VideoStreamingManager30=function(a){var b=this.$VideoStreamingManager3.getSegmentsBoundaries(a);a=this.$VideoStreamingManager31(a.baseUrl,b);b=new(c("ChunkableContinuousRangeStream"))(a,{disableStreamAutoStart:!0,enableStreamRangeConcat:!1,disableDeferredBufferArrayShift:!1,fixFixedSizeTransformOnNullEndByte:!0,useNativePromiseInDeferredBuffer:!0,fixStreamingUndefinedEndByte:!0,enablePausableStreamResumeFromStart:!0,fixPausePreReadableStream:!1,enableFactoryDestroy:!1});this.$VideoStreamingManager9.push(b.getPausableStreamFactory());return b};e.$VideoStreamingManager25=function(a){var b=this.$VideoStreamingManager6;if(!b)return;var c=this.$VideoStreamingManager27(a,this.$VideoStreamingManager14);for(var c=c,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g=b.updateRangeStream(f),h=b.getCurrentStreamRange();if(g==="closed")this.$VideoStreamingManager6=this.$VideoStreamingManager30(a),this.$VideoStreamingManager25(a);else if(h&&h.endByte===f.endByte)continue;return}};e.$VideoStreamingManager22=function(a){var b=this,d=a.startByte,e=a.endByte;if(d===void 0)return c("MaybeNativePromise").reject("request range does not exist");var f=function(){b.$VideoStreamingManager4.setNextRequestInfo(a);(!b.$VideoStreamingManager4.isNextRequestContinuous()||!b.$VideoStreamingManager4.isNextRequestInRange()||!b.$VideoStreamingManager2)&&(b.$VideoStreamingManager2&&b.$VideoStreamingManager2.cancel("reset stream"),b.$VideoStreamingManager2=b.$VideoStreamingManager32(a));var c;e==null?c=void 0:c=e-d+1;return b.$VideoStreamingManager2.getNextFixedSizeStream(c)};return f()["catch"](function(){b.$VideoStreamingManager33();return f()})};e.$VideoStreamingManager32=function(a){var b=this.$VideoStreamingManager3.getSegmentsBoundaries(a);b=this.$VideoStreamingManager31(a.baseUrl,b);a=this.$VideoStreamingManager3.getFetchRanges(a)[0];this.$VideoStreamingManager4.setFetchRange(a);a=new(c("PausableRangeStream"))(c("ReadableStream"),c("WritableStream"),a,b,{fixStreamingUndefinedEndByte:!0});b=new(c("FixedSizeTransform"))({fixFixedSizeTransformOnNullEndByte:!0});a.startStream();a.getStream().pipeTo(b.getSink());return b};e.$VideoStreamingManager31=function(a,b){var d=this,e=new(c("VideoSegmentStreamByFetch"))(a);a=function(a){return e.getResourceUrl(a)};var f=function(a){return d.$VideoStreamingManager3.getTimeRange(a)},g=e,h=this.$VideoStreamingManager34(g);g=this.$VideoStreamingManager35(h,a,f);this.$VideoStreamingManager7==="video"&&(g=this.$VideoStreamingManager36(g,b));return g};e.$VideoStreamingManager34=function(a){return{startStream:function(b){var d=new(c("NetworkErrorTransformStream"))();return a.startStream(b).then(function(a){return a.pipeThrough(d)})}}};e.$VideoStreamingManager36=function(a,b){var d=this;return{startStream:function(e){var f=b[0].startByte,g=new(c("StreamBandwidthReporter"))(d.$VideoStreamingManager1,f,b.filter(function(a){return a!==null}).map(function(a){return a.endByte||0}));g.addListener("bandwidthUpdate",function(a){return d.emit("bandwidthUpdate",a)});return a.startStream(e).then(function(a){return a.pipeThrough(g)})}}};e.$VideoStreamingManager35=function(a,b,d){var e=this,f=this.$VideoStreamingManager5;return!f?a:{startStream:function(g){var h=new(c("StreamFetchRequestLogger"))(f,e.$VideoStreamingManager7,b(g),d(g),g,c("performanceNow")(),e.$VideoStreamingManager14);return a.startStream(g).then(function(a){return a.pipeThrough(h)})}}};e.$VideoStreamingManager33=function(){this.$VideoStreamingManager4=new(c("FetchStreamStateTracker"))()};return b}(c("EventEmitter"));g["default"]=a}),98);
__d("ViewportPriorityAdjuster",["Event","SubscriptionsHandler","getElementPosition","getViewportDimensions","throttle"],(function(a,b,c,d,e,f,g){"use strict";var h=500,i=800;a=function(){function a(a){var b=this;this.$1=function(){};this.$2=new(c("SubscriptionsHandler"))();this.$3=a;this.$2.addSubscriptions(c("Event").listen(window,"scroll",c("throttle")(function(){return b.$4(a)},h)))}var b=a.prototype;b.$5=function(a){if(!a.paused)return 0;var b=c("getViewportDimensions")();a=c("getElementPosition")(a);var d=a.y;a=a.height;b=b.height;if(!d&&!a)return-2;if(d+a<0)return-2;return d>=0&&d+a<=b+i||d<=0&&d+a>=0?0:-1};b.$4=function(a){this.$1(this.$5(a))};b.setOnPriorityChanged=function(a){this.$1=a};b.getPriorityAdjustment=function(){return this.$5(this.$3)};b.cleanup=function(){this.$1=function(){},this.$2.release()};return a}();g["default"]=a}),98);
__d("canUseFetchStream",[],(function(a,b,c,d,e,f){"use strict";function a(){var a=!!window.fetch,b=!!(window.ReadableStream&&window.WritableStream),c=!!(window.ReadableStream&&window.ReadableStream.prototype.pipeTo);return a&&b&&c}f["default"]=a}),66);
__d("getSeekRangeGapsFromShakaReferences",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=[];for(var d=0;d<a.length;++d)if(a[d].timescaledGapInfo&&a[d].timescaledGapInfo.gapDistance>0){var e=0;a[d].unscaledStartTime&&(e=a[d].startTime-a[d].unscaledStartTime/b);c.push({start:a[d].timescaledGapInfo.segmentOriginalEndTime+e,end:a[d].endTime})}return c}f["default"]=a}),66);
__d("logLongAkamaiRequest",["CurrentUser","FBLogger"],(function(a,b,c,d,e,f,g){var h=!1,i=2,j=[];function a(a){c("CurrentUser").isEmployee()&&!h&&(j=j.filter(function(a){a=a.time;return Date.now()-a<1e3*60*2}),j.push({data:a,time:Date.now()}),j.length>=i&&(h=!0,c("FBLogger")("shaka").warn("Long latency video request to akamai: %s",j.map(function(a){a=a.data;return a}).join(" ; "))))}g["default"]=a}),98);
__d("maybeConvertHiveErrorToShakaNetError",[],(function(a,b,c,d,e,f){"use strict";function a(a){a&&a.type==="Hive"&&a.status!=null&&(a.type="net");return a}f["default"]=a}),66);
__d("mergeSeekRangeGaps",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=[];if(a.length){a.sort(function(a,b){return a.start-b.start});var c=a[0].start,d=a[0].end;for(var e=1;e<a.length;++e)a[e].start<=d?d=Math.max(d,a[e].end):(b.push({startTime:c,endTime:d}),c=a[e].start,d=a[e].end);b.push({startTime:c,endTime:d})}return b}f["default"]=a}),66);
__d("getBandwidthUpgradeTargetFactor",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c,d){return b<c||c<=0?1:1-a/b*d}f["default"]=a}),66);
__d("getVideoTracksWithoutSmoothPlayback",["Promise"],(function(a,b,c,d,e,f){"use strict";function a(a,c){if(!window.navigator||!window.navigator.mediaCapabilities||typeof window.navigator.mediaCapabilities.decodingInfo!=="function")return b("Promise").resolve([]);var d=window.navigator.mediaCapabilities.decodingInfo,e={type:"media-source",audio:{contentType:(c.mimeType||"")+'; codecs="'+(c.codecs||"")+'"',channels:String(c.channels),bitrate:c.bandwidth,samplerate:c.samplingRate}};return b("Promise").all(a.map(function(a){return d(babelHelpers["extends"]({},e,{video:{contentType:(a.mimeType||"")+'; codecs="'+(a.codecs||"")+'"',width:a.width,height:a.height,bitrate:a.bandwidth,framerate:a.frameRate}}))})).then(function(b){var c=[];a.forEach(function(a,d){(!b[d].supported||!b[d].smooth)&&c.push(a)});return c})["catch"](function(a){return[]})}f["default"]=a}),66);
__d("CustomAbrManager",["invariant","AbrEvaluationSignal","RlAbrModel","RlAbrUtils","Shaka","ShakaConstants","SubscriptionsHandler","VideoClientEdgeCooperation","VideoDashPrefetchCache","VideoPlaybackQuality","VideoPlayerConnectionQuality","VideoPlayerLocalBandwidthEstimator","VideoQualityClasses","asyncToGeneratorRuntime","getBandwidthUpgradeTargetFactor","getBufferedAheadOf","getVideoTracksWithoutSmoothPlayback"],(function(a,b,c,d,e,f,g,h){var i=window.devicePixelRatio||1;a=function(){function a(a){this.$38=!1,this.$2=null,this.$3=null,this.$4=a.shakaConfig,this.$5=a.performanceLogger,this.$7=new(c("SubscriptionsHandler"))(),this.$8=!0,this.$9=!1,this.$6=a.isSpherical,this.$10=a.width,this.$11=a.height,this.$13=a.resolutionConstraintMaxWidth,this.$12=a.resolutionConstraintMaxHeight,this.$14=a.minPlayQuality?a.minPlayQuality:null,this.$15=a.maxPlayQuality?a.maxPlayQuality:null,this.$16=a.initiallyForcedRepresentations||c("VideoDashPrefetchCache").getCachedRepresentations(a.videoID),this.$17=a.video,this.$18=a.videoID,this.$29=null,this.$27=null,this.$28=null,this.$40=!1,this.$30=a.getSource,this.$36=typeof a.useStrictTrackDimensionsExclusionLogic==="boolean"?a.useStrictTrackDimensionsExclusionLogic:!1,a.enableAdaptation&&(this.$19=a.bandwidthModel,this.$20=a.bandwidthDowngradeTarget,this.$21=a.bandwidthUpgradeTarget,this.$22=a.useNewBandwidthBandLogic,this.$23=a.hvqUpgradeAggressiveness,this.$24=a.hvqInlineUpgradeAggressiveness,this.$25=a.preHvqUpgradeAggressiveness,this.$26=a.preHvqInlineUpgradeAggressiveness,this.$31=a.enableReinforcementLearning,this.$33=a.rlModelId,this.$32=a.rlUseShortFeatures,this.$39=a.videoWatchTimeTracker,this.$41=new(c("RlAbrModel"))(this.$4),this.$43=a.chosenVideoTrackChangedCallback)}var e=a.prototype;e.destroy=function(){this.$1&&(this.$1.destroy(),this.$1=null),this.$7.release(),this.$7.engage(),this.$2=null,this.$3=null,this.$8=!1};e.setDimensions=function(a,b){this.$10=a;this.$11=b;this.$2&&this.$2.setResolutionConstraint(this.$45(),this.$46());a=this.$17.paused?c("ShakaConstants").numbers.clear_buffer_on_constraint_change_paused_offset:c("ShakaConstants").numbers.clear_buffer_on_constraint_change_offset;this.$47({clearBufferIfUpgrading:!1,clearBufferOffset:a})};e.initialize=function(a,b){if(this.$2||this.$3)return;this.$2=a;this.$3=b;a.setResolutionConstraint(this.$45(),this.$46())};e.start=function(){if(!this.$2||!this.$3||this.$9)return;this.$2&&(this.$1=new(c("AbrEvaluationSignal"))(this.$17,this.$2,this.$3,{minEvalInterval:this.$4.getNumber("min_eval_interval",1e3),minSwitchInterval:this.$4.getNumber("min_switch_interval",5e3),ignoreTimeLimitForInitialSample:!0,useLowBufferVelocityInterval:!1,lowBufferVelocityIntervalBufferThreshold:c("ShakaConstants").numbers.low_buffer_velocity_abr_interval_buffer_threshold,lowBufferVelocityAbrInterval:c("ShakaConstants").numbers.low_buffer_velocity_abr_interval,evaluateAbrOnFetchEnd:this.$4.getBool("evaluate_abr_on_fetch_end",!1),evaluateAbrOnTracksAndBandwidthChange:this.$4.getBool("evaluate_abr_on_tracks_and_bandwidth_change",!0),ignoreRecentBandwidthEvalOnFetchEnd:this.$4.getBool("ignore_recent_bandwidth_eval_on_fetch_end",!1)}),this.$1.addListener("evaluate",this.$48.bind(this)));this.$9=!0};e.$49=function(){this.$16||(this.$16=c("VideoDashPrefetchCache").getCachedRepresentations(this.$18));return this.$16};e.$48=function(a){this.$47(a)};e.$50=function(){var a=this.$4.getNumber("resolution_constraint_factor",2);return a*i};e.$45=function(){return this.$6?Infinity:Math.min(this.$10*this.$50(),this.$13)};e.$46=function(){return this.$6?Infinity:Math.min(this.$11*this.$50(),this.$12)};e.setPreferredVideoTrack=function(a){this.$29=a,this.$47({clearBufferIfUpgrading:!0,clearBufferOffset:0})};e.unsetPreferredVideoTrack=function(){this.$29=null,this.$47()};e.enable=function(a){this.$8=a};e.getInitialVideoTrackId=function(){if(!this.$2||!this.$3)return null;var a=this.$51();return a?a.id:null};e.getInitialSwitchReason=function(){return this.$28};e.getInitialAudioTrackId=function(){if(!this.$2||!this.$3)return null;var a=this.$52();return a?a.id:null};e.selectVideoTrack=function(d,e,f,g){if(!this.$9)return;var h=c("ShakaConstants").numbers.abr_abort_when_fetch_estimate_exceeds_buffer_factor,i=c("ShakaConstants").numbers.abr_abort_when_fetch_estimate_exceeds_time,j=c("ShakaConstants").numbers.abr_abort_on_zero_stream_progress_below_threshold,k=this.$3.getVideoStreamProgressTracker(),l=a.$53(this.$3.getVideoTracks());l=l&&b("Shaka").player.VideoTrack.compare(l,d)<0?!1:!0;if(k&&k.canTrackProgress()&&k.hasStarted()){var m=c("getBufferedAheadOf")(this.$17),n=k.getEstimatedTimeRemainingOfStream();m=h>0&&n>m*h;h=i>0&&n>i;n=j>-1?k.getProgress()<=j:!1;if(l&&(m||h||n)){this.$3.selectVideoTrack(d.id,e,f,g,!0);return}}this.$3.selectVideoTrack(d.id,e,f,g,!1)};a.$53=function(a){for(var b=0;b<a.length;++b)if(a[b].active)return a[b];return null};e.$54=function(a){var b=c("ShakaConstants").numbers.live_predictive_abr_up_buffer,d=c("ShakaConstants").numbers.live_predictive_abr_down_buffer,e=c("ShakaConstants").numbers.live_predictive_abr_up_retry_interval,f=c("ShakaConstants").numbers.live_predictive_abr_ttfb_ratio,g=c("ShakaConstants").numbers.live_predictive_abr_floor_ttfb_ratio,h=c("ShakaConstants").numbers.live_predictive_abr_floor_swich_lanes,i=this.$55();this.$56(i);i=this.$57(i);var j=c("getBufferedAheadOf")(this.$17),k=0;if(!this.$40)return this.$51(i);g>0&&a.streamFetchTimeMs>a.segmentLengthMs*g?(k=h<-100?-Infinity:h,this.$27="download_longer_than_duration"):f>0&&a.streamFetchTimeMs>a.segmentLengthMs*f?(k=-1,this.$27="download_longer_than_duration"):j<d/1e3?(k=-1,this.$27="low_buffer_availability"):j>=b/1e3&&this.$42+e<Date.now()&&(k=1,this.$27="high_buffer_availability");k<0&&(this.$42=Date.now());g=i[Math.max(Math.min(this.$35+k,i.length-1),0)];k!=0&&this.$58(this.$27,g,i);return g};e.$59=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=[];this.$4.getBool("exclude_tracks_without_smooth_playback",!1)&&(a=(yield c("getVideoTracksWithoutSmoothPlayback")(this.$55(),this.$60())));var b;this.$31?b=(yield this.$61()):b=this.$51(a);return b});function d(){return a.apply(this,arguments)}return d}();e.$47=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){c===void 0&&(c={clearBufferIfUpgrading:!1,clearBufferOffset:0});if(!this.$8)return;var d=c,e=d.clearBufferIfUpgrading;d=d.clearBufferOffset;var f=null;c&&c.streamFetchTimeMs&&c.segmentLengthMs&&this.$4.getBool("shaka_buffer_abr",!1)?f=this.$54({streamFetchTimeMs:c.streamFetchTimeMs,segmentLengthMs:c.segmentLengthMs}):f=(yield this.$59());if(f){if(f.active)return;c=!1;if(e){e=a.$53(this.$3.getVideoTracks());c=e?b("Shaka").player.VideoTrack.compare(e,f)<0:!1}this.$1&&this.$1.notifySwitch();this.selectVideoTrack(f,c,d,this.$27)}});function d(a){return c.apply(this,arguments)}return d}();e.$62=function(){var a=this;this.$38=this.$38||d("VideoPlayerConnectionQuality").evaluate(function(){return a.$63()})==="POOR";return this.$38};e.$64=function(){if(!this.$3)return!1;var a=this.$3.getBufferVelocity();return a!==null&&a<c("ShakaConstants").numbers.low_buffer_velocity_threshold};e.$58=function(b,c,d){d=this.$34||a.$53(d);this.$5&&this.$5.getEventLogger("abr_evaluation").setDynamicBitrate(c.bandwidth).setStreamSwitchReason(b).setInitiator(d?d.streamInfoID:null).setConcluder(c.streamInfoID).setResult(c.active?"paused":"success").log()};e.$60=function(){return this.$3.getAudioTracks().find(function(a){return a.active})};e.$55=function(){return this.$3.getVideoTracks({useLocalBitrate:!1})};e.$56=function(b){this.$34=a.$53(b),this.$35=this.$34?b.indexOf(this.$34):-1};e.$57=function(a){var d=this;if(a.length==0)return[];a=a.filter(function(a){return!(a.avoidOnPoorConnection&&d.$62())});var e=this.$49();if(!this.$9)for(var f=0;f<a.length;f++)if(e&&e.includes(a[f].streamInfoID)){this.$27="forced";this.$28="forced";this.$58(this.$27,a[f],[a[f]]);return[a[f]]}if(this.$29){var g=this.$29.id;f=a.find(function(a){return a.id===g});if(f){this.$27="user";this.$58(this.$27,f,[f]);return[f]}}a.sort(b("Shaka").player.VideoTrack.compare);if(this.$14!==null||this.$15!==null){var h=this.$14!==null?c("VideoQualityClasses").indexOf(this.$14):0,i=this.$15!==null?c("VideoQualityClasses").indexOf(this.$15):c("VideoQualityClasses").length-1;if(h<=i){e=a.filter(function(a){return c("VideoQualityClasses").indexOf(a.fbQualityClass)>=h&&c("VideoQualityClasses").indexOf(a.fbQualityClass)<=i});this.$27="prefer_quality_class";if(!e.length){this.$58(this.$27,a[a.length-1],[a[a.length-1]]);return[a[a.length-1]]}f=c("VideoQualityClasses").indexOf("sd");if(a.length==2&&e.length==2&&i<=f){this.$58(this.$27,a[0],[a[0]]);return[a[0]]}a=e}}return a};e.$65=function(a){var b=this,c=this.$46(),d=this.$45();a=a.filter(function(a){return b.$36?(a.width||0)<=d&&(a.height||0)<=c:(a.width||0)<=d||(a.height||0)<=c});return a};e.$66=function(a,b){return b.length===0?a:a.filter(function(a){return!b.find(function(b){return a.id===b.id})})};e.$67=function(){if(this.$3===null)return!1;var a=c("ShakaConstants").numbers.buffer_velocity_time_in_past_to_consider>0;return a&&!this.$64()?!0:!1};e.$68=function(a){if(!this.$43)return;(a==null&&this.$44!=null||a!=null&&this.$44==null||a!=null&&this.$44!=null&&this.$44.streamInfoID!=a.streamInfoID)&&this.$43(a);this.$44=a};e.$51=function(b){b===void 0&&(b=[]);var e=this.$55();this.$56(e);e=this.$57(e);var f=this.$63();if(e.length==0){this.$68(null);return null}else if(e.length==1){this.$68(e[0]);return e[0]}this.$40=!0;var g=e[0];e=this.$66(e,b);b=e.reduce(function(a,b){return a>(b.bandwidth||0)?a:b.bandwidth||0},0);f=d("VideoClientEdgeCooperation").applyBandwidthLimit(f,b);e=this.$65(e);b=a.$53(this.$3.getAudioTracks());b=b?b.bandwidth:0;var h=c("getBufferedAheadOf")(this.$17);if(h<this.$4.getNumber("force_lowest_representation_threshold",0)&&!this.$67()){var i=0;this.$35>-1&&(i=Math.floor(this.$35*this.$4.getNumber("force_lower_representation_step_ratio",0)));i>=e.length&&(i=e.length-1);this.$27="low_buffer_availability";g=e[i]||g;this.$58(this.$27,g,e);this.$68(g);return g}else{i=0;for(var j=0;j<e.length;j++){var k=e[j],l=j+1<e.length?e[j+1]:{bandwidth:Number.POSITIVE_INFINITY};if(!k.bandwidth)continue;var m=this.$69(k,l,h,this.$30&&this.$30()),n=this.$22?i:(k.bandwidth+b)/this.$20;l=(l.bandwidth+b)/m;i=l;if(f>=n&&f<=l){g=k;if(g.active)break}}this.$27="bandwidth"}this.$58(this.$27,g,e);this.$68(g);return g};e.$63=function(){this.$2 instanceof c("VideoPlayerLocalBandwidthEstimator")||h(0,2969);return this.$2.getBandwidth(this.$19)};e.$69=function(a,b,e,f){var g=1;!a.isInlineHVQ&&b.isInlineHVQ?g=this.$26:a.isInlineHVQ&&f==="inline"?g=this.$24:a.isHVQ&&(g=this.$23);b=c("ShakaConstants").numbers.buffer_target;f=b>-1;if(f){a=e>b;f=a?c("ShakaConstants").numbers.buffer_target_overflow_upgrade_aggressiveness:c("ShakaConstants").numbers.buffer_target_underflow_upgrade_aggressiveness;g*=f}e=c("ShakaConstants").numbers.frame_drop_penalty_minimum_frame_count;e>0&&(g*=c("getBandwidthUpgradeTargetFactor")(d("VideoPlaybackQuality").getDroppedFrames(this.$17),d("VideoPlaybackQuality").getTotalFrames(this.$17),e,c("ShakaConstants").numbers.frame_drop_penalty_factor));return this.$21*g};e.$52=function(){var a=this.$3.getAudioTracks();if(a.length==0)return null;var b=this.$49();if(!this.$9)for(var c=0;c<a.length;c++)if(b&&b.includes(a[c].streamInfoID))return a[c];return null};e.$61=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this,b=this.$55();this.$56(b);b=this.$57(b);if(b.length==0)return null;else if(b.length==1)return b[0];b=this.$65(b);if(b.length==0)return null;else if(b.length==1)return b[0];this.$27="forced";var e=b[0],f=c("getBufferedAheadOf")(this.$17),g=this.$63(),h=this.$32?d("RlAbrUtils").getRlAbrShortFeatures(this.$17,b,f,g):d("RlAbrUtils").getRlAbrFeatures(this.$17,b,f,g,this.$39);if(!h)return this.$51();var i=this.$45(),j=this.$46();try{if(this.$32)yield* (function*(){var c=(yield d("RlAbrUtils").genRlAbrShortFeaturesRecommendation(h,a.$4.getNumber("min_eval_interval",1e3),a.$33));if(!c||c.length==0)throw new Error("RL service not available.");var f=function(f){var g=b.find(function(a){var b=d("RlAbrUtils").getQualityLabelBracket(a.fbQualityLabel,this.$32);return b===c[f]&&(a.width<=i||a.height<=j)});if(g){e=g;a.$27="rl_decision";return"break"}};for(var g=0;g<c.length;g++){var k=f(g);if(k==="break")break}})();else{g=this.$39?this.$39.getGuid():null;if(g===null)return this.$51();var k=d("RlAbrUtils").getRlAbrAvailableBitrates(b);if(k.length>c("ShakaConstants").numbers.rl_max_number_of_bitrates)return this.$51();var l=c("ShakaConstants").numbers.rl_request_timeout;l=Math.min(l,(f-1)*1e3);if(l<0)return this.$51();f=c("ShakaConstants").strings.rl_smc_tier;if(!this.$41.modelFetched()){this.$41.fetchIfNotExist(g,f,l);return this.$51()}else{g=this.$41.getPolicyReportExperience(g,f,h,k,b,l);e=b[g];this.$27="rl_decision"}}}catch(a){return this.$51()}this.$37=h;this.$58(this.$27,e,b);return e});function e(){return a.apply(this,arguments)}return e}();return a}();g["default"]=a}),98);
__d("LowLatencyPlayheadManager",["LowLatencyPlaybackTypedLogger","clearInterval","getBufferedAheadOf","setIntervalAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c,d,e,f){this.$1=a,this.$2=b,this.$3=c,this.$4=d,this.$5=e,this.$6=f,this.$11=0,this.$9=0}var b=a.prototype;b.$12=function(a){var b=this.$4.getLowLatencyWorldTiming();this.$11=b.worldCurrentTimeMs;return a-b.worldCurrentTimeMs+b.worldLastVideoFrameMs};b.$13=function(a){a=this.$12(a);return a-this.$6.lowLatencyMs};b.getLowLatencyPlayheadMs=function(){var a=this.$5.currentTimeMillis();return this.$13(a)};b.startFixedLatencySync=function(){this.$7=c("setIntervalAcrossTransitions")(this.adjustPlaybackForLowLatency.bind(this),this.$6.lowLatencyAdjustPlaybackIntervalMs)};b.stopFixedLatencySync=function(){c("clearInterval")(this.$7)};b.setState=function(a){this.$10=a};b.state=function(){return this.$10};b.adjustPlaybackForLowLatency=function(){if(!this.$4.isReady())return;if(!this.$4.isLive())return;if(!this.$5.isReady())return;var a=this.$5.currentTimeMillis(),b=this.$13(a);b=b/1e3;this.$10=="playing"&&this.$2.currentTime<b-this.$6.lowLatencyThresholdMs/1e3?(this.$2.currentTime=b+this.$6.lowLatencySeekForwardMs/1e3,this.$2.paused&&(this.$10="playing",this.$1.play()),this.$8=Date.now(),this.$9++):this.$10=="playing"&&this.$2.currentTime>b+this.$6.lowLatencyThresholdMs/1e3?(this.$1.pause(),this.$10="paused"):this.$10=="paused"&&(this.$10="playing",this.$1.play());new(c("LowLatencyPlaybackTypedLogger"))().setBehindByMs(a-this.$11).setBufferMs(c("getBufferedAheadOf")(this.$2)*1e3).setPlaybackDesiredTimeMs(this.$6.lowLatencyMs).setSeekCount(this.$9).setServerTimeMs(a).setTimeSinceLastSeekMs(Date.now()-this.$8).setVideoID(this.$3).setVideoTimeMs(this.$2.currentTime*1e3).log()};return a}();g["default"]=a}),98);
__d("LowLatencyShakaTimingProvider",["Shaka"],(function(a,b,c,d,e,f){"use strict";b("Shaka").player.Player;a=function(){function a(a){this.$1=a}var b=a.prototype;b.getLowLatencyWorldTiming=function(){var a=this.$1.getManifest();return{worldCurrentTimeMs:a.currentServerTimeMs,worldLastVideoFrameMs:a.lastVideoFrameTs}};b.isReady=function(){return this.$1.getManifest()!=null};b.isLive=function(){return this.$1.getManifest().type=="dynamic"};return a}();f["default"]=a}),66);
__d("PerformanceResourceBuffer",["EventEmitter","ODS"],(function(a,b,c,d,e,f){"use strict";var g=a.__isResourceTimingBufferFull;delete a.__isResourceTimingBufferFull;performance.onresourcetimingbufferfull=function(){g=!0,h&&h.emit("full")};var h;c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.isBufferFull=function(){return g};return b}(b("EventEmitter"));h=new c();h.isBufferFull()?b("ODS").bumpEntityKey(2966,"performance","resourcetimingbufferfull"):h.addListener("full",function(){return b("ODS").bumpEntityKey(2966,"performance","resourcetimingbufferfull")});e.exports=h}),null);
__d("TaggedTimeRanges",["oz-player/utils/OzTaggedTimeRanges"],(function(a,b,c,d,e,f,g){g["default"]=c("oz-player/utils/OzTaggedTimeRanges")}),98);
__d("SkywalkerHelpers",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=a.split("/").slice(0,-1);return a.some(function(a){return/\d/.test(a)})?null:a.join("_")}f.topicToUseCaseName=a}),66);
__d("SkywalkerManager",["Bootloader","Promise","SkywalkerHelpers","TransportSelectingClientSingleton","TransportSelectingClientUtils","asyncToGeneratorRuntime","gkx","nullthrows","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){var h="request_stream",i="mqtt_skywalker",j="dgw_request_stream";a=function(){function a(){}var e=a.prototype;e.subscribe=function(a,b,d){d===void 0&&(d={});var e=this.$3(a,b,d);c("promiseDone")(e);return{getTopic:function(){return a},getContext:function(){return d.context},isUnsubscribed:function(){return this.$4},unsubscribe:function(){this.$4=!0;return e.then(function(a){return a.unsubscribe()})},$4:!1}};e.once=function(a,b,c){c===void 0&&(c={});var d=this.subscribe(a,function(){d.isUnsubscribed()||(d.unsubscribe(),b.apply(this,arguments))},c);return d};e.getSubscriptionType=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("TransportSelectingClientUtils").isDGWSupportedSKYTopic(a));if(a&&c("gkx")("5200"))return j;if(b!=null&&b.headers!=null)return h;return a?j:i});function e(b,c){return a.apply(this,arguments)}return e}();e.getSubscriptions=function(){var a=[],b=this.$1;b!=null&&(a=b.getSubscriptions().map(function(a){return{getTopic:function(){return a.getTopic()},getMessageListener:function(){return a.getMessageListener()},getCreationTime:function(){return a.getCreationTime()},isUnsubscribed:function(){return!b.isSubscribed(a)}}}));return a};e.$3=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=(yield this.getSubscriptionType(a,e));if(f===h){var g=e.headers!=null?e.headers.method:null;return this.$5(c("nullthrows")(g),a,b,e)}else if(f===j){f=e==null?void 0:(g=e.headers)==null?void 0:g.method;if(f==null){g=d("SkywalkerHelpers").topicToUseCaseName(a);g!=null?f="SKY:"+g:f="SKY"}return this.$5(c("nullthrows")(f),a,b,e)}else return this.$6(a,b,e)});function e(b,c,d){return a.apply(this,arguments)}return e}();e.$6=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var d=(yield this.$7());return d.subscribe(a,b,c)});function c(b,c,d){return a.apply(this,arguments)}return c}();e.$5=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,d,e,f){var g=(yield this.$8());g=g.patchContext(f.context);a=babelHelpers["extends"]({},f.headers||{},{method:a,topic:d});var h={onData:function(a){a=JSON.parse(a);var b=d!=null?d:a.topic;e({topic:b,payload:a.payload})},onTermination:function(a){return void 0},onLog:function(a){return void 0},onFlowStatus:function(a){return void 0}},i=(yield c("TransportSelectingClientSingleton").requestStream(a,JSON.stringify(g),h,f.instrumentationData));f.onSubscribe&&f.onSubscribe({data:{},error:null});return{unsubscribe:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){f.onUnsubscribeEager&&f.onUnsubscribeEager(),i.cancel(),f.onUnsubscribe&&f.onUnsubscribe({data:{},error:null})});function c(){return a.apply(this,arguments)}return c}()}});function d(b,c,d,e){return a.apply(this,arguments)}return d}();e.$7=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(this.$1!=null)return this.$1;var a=new(b("Promise"))(function(a){c("Bootloader").loadModules(["MqttSkywalkerManager"],a,"SkywalkerManager")});a=(yield a);this.$1=a;return a});function d(){return a.apply(this,arguments)}return d}();e.$8=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(this.$2!=null)return this.$2;var a=new(b("Promise"))(function(a){c("requireDeferred")("SkywalkerUtils").__setRef("SkywalkerManager").onReady(function(b){a(b)})});a=(yield a);this.$2=a;return a});function d(){return a.apply(this,arguments)}return d}();return a}();e=new a();g["default"]=e}),98);
__d("VideoPlayerLiveStreamState",["EventEmitter","SkywalkerManager"],(function(a,b,c,d,e,f,g){"use strict";var h={interrupt:"streamInterruptAt",ended:"endedAt"};a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this)||this;c.$VideoPlayerLiveStreamState2=b;c.$VideoPlayerLiveStreamState1=[];return c}var d=b.prototype;d.subscribe=function(){this.$VideoPlayerLiveStreamState1=[];for(var a in h)this.$VideoPlayerLiveStreamState1.push(c("SkywalkerManager").subscribe("video_broadcast/"+a+"_"+this.$VideoPlayerLiveStreamState2,this.$VideoPlayerLiveStreamState3.bind(this,h[a])))};d.unsubscribe=function(){for(var a=this.$VideoPlayerLiveStreamState1,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d.unsubscribe()}this.$VideoPlayerLiveStreamState1=[]};d.$VideoPlayerLiveStreamState3=function(a,b){b=JSON.parse(b.payload||"{}")||{};b=b.time_position;typeof b==="number"&&(b/=1e3,this.emit(a,b))};return b}(c("EventEmitter"));g["default"]=a}),98);
__d("getVideoPlayerShakaSeekableRanges",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=[];if(a.seekRangeGaps.length===0)b.push({startTime:a.start,endTime:a.end});else{var c=a.start,d;for(var e=0;e<a.seekRangeGaps.length;++e)d=a.seekRangeGaps[e].startTime,b.push({startTime:c,endTime:d}),c=a.seekRangeGaps[e].endTime;d=a.end;b.push({startTime:c,endTime:d})}return b}f["default"]=a}),66);
__d("VideoPlayerHTML5Shaka",["invariant","CustomAbrManager","EventEmitter","EventListener","FBLogger","LiveClock","LowLatencyPlayheadManager","LowLatencyShakaTimingProvider","P2PPlaybackSessionLogger","PerformanceResourceBuffer","Promise","Shaka","ShakaConstants","SubscriptionsHandler","TaggedTimeRanges","TimeRanges","URI","VideoDashPrefetchCache","VideoPlayerConnectionQuality","VideoPlayerLiveStreamState","VideoPlayerMemLeakExperiments","VideoPlayerMetaData","VideoPlayerPlayLogger","VideoPlayerQualitiesArray","VideoPlayerShakaBandwidthEstimator","VideoPlayerShakaPerformanceLogger","VideoPriorityCalculator","VideoStreamingTaskQueueProvider","asyncToGeneratorRuntime","clearInterval","dangerouslyOverrideMediaElementEndedProperty","dispatchCustomEvent","dispatchEvent","getVideoPlayerShakaSeekableRanges","nullthrows","qex","throttle"],(function(a,b,c,d,e,f,g,h){var i="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",j="com.widevine.alpha",k="urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",l="com.microsoft.playready";b("PerformanceResourceBuffer");b("Shaka");var m=c("VideoPlayerShakaBandwidthEstimator").getEstimator(),n=function(a,b,c){a.addEventListener(b,c);return{remove:function(){a.removeEventListener(b,c)}}};a=function(a){babelHelpers.inheritsLoose(e,a);function e(b,f,g){var h,i=g.config,j=g.videoID,k=g.playerInstanceKey,l=g.width,m=g.height,o=g.manifest,p=g.manifestUrl,q=g.isLive,r=g.isServableViaFbms,s=g.minPlayQuality,t=g.maxPlayQuality,u=g.accessToken,v=g.startTimestamp,w=g.disableStreaming,x=g.playerOrigin,y=g.playerSuborigin,z=g.resolutionConstraintMaxHeight,A=g.resolutionConstraintMaxWidth,B=g.isSpherical,C=g.getSource,D=g.vpcPlayingStateEmitter,E=g.streamPriorityAdjuster,F=g.videoLiveTrace,G=g.videoLicenseUriMap,H=g.graphApiVideoLicenseUri,I=g.widevineCert,J=g.videoWatchTimeTracker,K=g.desiredLatencyMs,L=g.latencyToleranceMs,M=g.disableAbr,N=g.p2pSettings;g=g.disableLogging;h=a.call(this)||this;h.$VideoPlayerHTML5Shaka32=null;h.$VideoPlayerHTML5Shaka45=new(c("SubscriptionsHandler"))();h.$VideoPlayerHTML5Shaka59=!1;h.$VideoPlayerHTML5Shaka2=i;h.$VideoPlayerHTML5Shaka5=s;h.$VideoPlayerHTML5Shaka6=t;h.$VideoPlayerHTML5Shaka7=!1;h.$VideoPlayerHTML5Shaka8=null;h.$VideoPlayerHTML5Shaka9=1;h.$VideoPlayerHTML5Shaka10=!1;h.$VideoPlayerHTML5Shaka11=q;h.$VideoPlayerHTML5Shaka12=q;h.$VideoPlayerHTML5Shaka13=r;h.$VideoPlayerHTML5Shaka14=!1;h.$VideoPlayerHTML5Shaka15=B;h.$VideoPlayerHTML5Shaka51=!!M;N&&(h.$VideoPlayerHTML5Shaka60=N.community_info,h.$VideoPlayerHTML5Shaka52=N.ticket,h.$VideoPlayerHTML5Shaka55=N.hive_initialization_options,h.$VideoPlayerHTML5Shaka53=N.config);h.$VideoPlayerHTML5Shaka59=(i=g)!=null?i:!1;h.$VideoPlayerHTML5Shaka17=l;h.$VideoPlayerHTML5Shaka18=m;h.$VideoPlayerHTML5Shaka46=G;h.$VideoPlayerHTML5Shaka47=H;h.$VideoPlayerHTML5Shaka49=I;h.$VideoPlayerHTML5Shaka32=o||p;h.$VideoPlayerHTML5Shaka40=J;h.$VideoPlayerHTML5Shaka43=(typeof z==="number"?z:c("ShakaConstants").numbers.resolution_constraint_max_height)||Infinity;h.$VideoPlayerHTML5Shaka44=(typeof A==="number"?A:c("ShakaConstants").numbers.resolution_constraint_max_width)||Infinity;h.$VideoPlayerHTML5Shaka3=f;h.$VideoPlayerHTML5Shaka35=null;h.$VideoPlayerHTML5Shaka20=C;s=h.$VideoPlayerHTML5Shaka35;h.$VideoPlayerHTML5Shaka4=j;h.$VideoPlayerHTML5Shaka48=u;h.$VideoPlayerHTML5Shaka59?h.$VideoPlayerHTML5Shaka26=null:h.$VideoPlayerHTML5Shaka26=c("VideoPlayerShakaPerformanceLogger").shouldInitialize()?new(c("VideoPlayerShakaPerformanceLogger"))({videoID:j,video:b,representationId:s,isLive:q,isServableViaFbms:r,accessToken:u,playerOrigin:x,playerSuborigin:y,playerVersion:h.getPlayerVersion(),uniqueID:k,getBandwidthEstimate:function(a){return c("VideoPlayerShakaBandwidthEstimator").getBandwidthByVideoType(a)},getApproximateFBLSToPlayerDisplayLatency:function(){return null},getPreferredEdgeLatency:function(){return null},isDrm:h.isDrm()}):null;h.$VideoPlayerHTML5Shaka26&&(h.$VideoPlayerHTML5Shaka28=new(c("VideoPlayerPlayLogger"))(b,h.$VideoPlayerHTML5Shaka26));h.$VideoPlayerHTML5Shaka61();c("VideoPlayerMemLeakExperiments").www_videos_memleak_on_tv?h.$VideoPlayerHTML5Shaka45.addSubscriptions(c("EventListener").listen(b,"playing",h.$VideoPlayerHTML5Shaka62.bind(babelHelpers.assertThisInitialized(h))),c("EventListener").listen(b,"timeupdate",function(a){h.$VideoPlayerHTML5Shaka63(a.target.currentTime)}),c("EventListener").listen(b,"pause",h.$VideoPlayerHTML5Shaka64.bind(babelHelpers.assertThisInitialized(h))),c("EventListener").listen(b,"play",h.$VideoPlayerHTML5Shaka65.bind(babelHelpers.assertThisInitialized(h))),c("EventListener").listen(b,"ended",h.disableP2PPlayback.bind(babelHelpers.assertThisInitialized(h)))):(c("EventListener").listen(b,"playing",h.$VideoPlayerHTML5Shaka62.bind(babelHelpers.assertThisInitialized(h))),c("EventListener").listen(b,"timeupdate",function(a){h.$VideoPlayerHTML5Shaka63(a.target.currentTime)}),c("EventListener").listen(b,"pause",h.$VideoPlayerHTML5Shaka64.bind(babelHelpers.assertThisInitialized(h))),c("EventListener").listen(b,"play",h.$VideoPlayerHTML5Shaka65.bind(babelHelpers.assertThisInitialized(h))),c("EventListener").listen(b,"ended",h.disableP2PPlayback.bind(babelHelpers.assertThisInitialized(h))));h.$VideoPlayerHTML5Shaka31=Date.now();h.$VideoPlayerHTML5Shaka22=d("VideoPlayerQualitiesArray").ensureVideoPlayerQualitiesArray([]);h.$VideoPlayerHTML5Shaka23=null;h.$VideoPlayerHTML5Shaka24=null;h.$VideoPlayerHTML5Shaka37=D;h.$VideoPlayerHTML5Shaka38=E;h.$VideoPlayerHTML5Shaka19=new(c("Shaka").player.Player)(b,h.$VideoPlayerHTML5Shaka2,h.$VideoPlayerHTML5Shaka26,null,h.$VideoPlayerHTML5Shaka37,h.$VideoPlayerHTML5Shaka38,F);if(h.$VideoPlayerHTML5Shaka12&&h.$VideoPlayerHTML5Shaka2.getBool("is_low_latency",!1)){t=new(c("LiveClock"))();t.startClock();h.$VideoPlayerHTML5Shaka50=new(c("LowLatencyPlayheadManager"))(babelHelpers.assertThisInitialized(h),b,h.$VideoPlayerHTML5Shaka4,new(c("LowLatencyShakaTimingProvider"))(h.$VideoPlayerHTML5Shaka19),t,{lowLatencyMs:K||h.$VideoPlayerHTML5Shaka2.getNumber("ll_desired_latency_ms",7e3),lowLatencyThresholdMs:L||h.$VideoPlayerHTML5Shaka2.getNumber("ll_latency_behind_threshold_ms",500),lowLatencySeekForwardMs:h.$VideoPlayerHTML5Shaka2.getNumber("ll_latency_seek_forward_ms",400),lowLatencyAdjustPlaybackIntervalMs:h.$VideoPlayerHTML5Shaka2.getNumber("ll_adjust_playback_interval_ms",250)});h.$VideoPlayerHTML5Shaka50.setState("stopped")}c("VideoPlayerMemLeakExperiments").www_videos_memleak_on_tv?h.$VideoPlayerHTML5Shaka45.addSubscriptions(n(h.$VideoPlayerHTML5Shaka19,"seekrangechanged",function(){return h.$VideoPlayerHTML5Shaka66()}),n(h.$VideoPlayerHTML5Shaka19,"bufferingStart",function(){return h.$VideoPlayerHTML5Shaka67()}),n(h.$VideoPlayerHTML5Shaka19,"bufferingEnd",function(){return h.$VideoPlayerHTML5Shaka68()}),n(h.$VideoPlayerHTML5Shaka19,"bufferingProgress",h.$VideoPlayerHTML5Shaka69.bind(babelHelpers.assertThisInitialized(h))),n(h.$VideoPlayerHTML5Shaka19,"error",function(a){return h.$VideoPlayerHTML5Shaka70(a)}),n(h.$VideoPlayerHTML5Shaka19,"adaptation",h.$VideoPlayerHTML5Shaka71.bind(babelHelpers.assertThisInitialized(h))),n(h.$VideoPlayerHTML5Shaka19,"trackschanged",h.$VideoPlayerHTML5Shaka72.bind(babelHelpers.assertThisInitialized(h))),n(h.$VideoPlayerHTML5Shaka19,"debug/dashPlayerEvent",function(a){return h.emit("debug/dashPlayerEvent",a.detail)}),n(h.$VideoPlayerHTML5Shaka19,"manifestwrapped",h.$VideoPlayerHTML5Shaka73.bind(babelHelpers.assertThisInitialized(h))),n(h.$VideoPlayerHTML5Shaka19,"cea608CaptionsBytesReceived",function(a){h.emit("cea608CaptionsBytesReceived",a.detail)}),n(h.$VideoPlayerHTML5Shaka19,"cea608AvailabilityChanged",function(){h.emit("cea608AvailabilityChanged")}),n(h.$VideoPlayerHTML5Shaka19,"manifestIsUpdating",h.$VideoPlayerHTML5Shaka74.bind(babelHelpers.assertThisInitialized(h))),n(h.$VideoPlayerHTML5Shaka19,"replicaswitch",h.$VideoPlayerHTML5Shaka75.bind(babelHelpers.assertThisInitialized(h))),n(h.$VideoPlayerHTML5Shaka19,"initiallivemanifestrequestfailure",h.$VideoPlayerHTML5Shaka76.bind(babelHelpers.assertThisInitialized(h))),n(h.$VideoPlayerHTML5Shaka19,"networkinterrupted",h.$VideoPlayerHTML5Shaka77.bind(babelHelpers.assertThisInitialized(h))),n(h.$VideoPlayerHTML5Shaka19,"networkresumed",h.$VideoPlayerHTML5Shaka78.bind(babelHelpers.assertThisInitialized(h)))):(h.$VideoPlayerHTML5Shaka19.addEventListener("seekrangechanged",function(){return h.$VideoPlayerHTML5Shaka66()}),h.$VideoPlayerHTML5Shaka19.addEventListener("bufferingStart",function(){return h.$VideoPlayerHTML5Shaka67()}),h.$VideoPlayerHTML5Shaka19.addEventListener("bufferingEnd",function(){return h.$VideoPlayerHTML5Shaka68()}),h.$VideoPlayerHTML5Shaka19.addEventListener("bufferingProgress",h.$VideoPlayerHTML5Shaka69.bind(babelHelpers.assertThisInitialized(h))),h.$VideoPlayerHTML5Shaka19.addEventListener("error",function(a){return h.$VideoPlayerHTML5Shaka70(a)}),h.$VideoPlayerHTML5Shaka19.addEventListener("adaptation",h.$VideoPlayerHTML5Shaka71.bind(babelHelpers.assertThisInitialized(h))),h.$VideoPlayerHTML5Shaka19.addEventListener("trackschanged",h.$VideoPlayerHTML5Shaka72.bind(babelHelpers.assertThisInitialized(h))),h.$VideoPlayerHTML5Shaka19.addEventListener("debug/dashPlayerEvent",function(a){return h.emit("debug/dashPlayerEvent",a.detail)}),h.$VideoPlayerHTML5Shaka19.addEventListener("manifestwrapped",h.$VideoPlayerHTML5Shaka73.bind(babelHelpers.assertThisInitialized(h))),h.$VideoPlayerHTML5Shaka19.addEventListener("cea608CaptionsBytesReceived",function(a){h.emit("cea608CaptionsBytesReceived",a.detail)}),h.$VideoPlayerHTML5Shaka19.addEventListener("cea608AvailabilityChanged",function(){h.emit("cea608AvailabilityChanged")}),h.$VideoPlayerHTML5Shaka19.addEventListener("manifestIsUpdating",h.$VideoPlayerHTML5Shaka74.bind(babelHelpers.assertThisInitialized(h))),h.$VideoPlayerHTML5Shaka19.addEventListener("replicaswitch",h.$VideoPlayerHTML5Shaka75.bind(babelHelpers.assertThisInitialized(h))),h.$VideoPlayerHTML5Shaka19.addEventListener("initiallivemanifestrequestfailure",h.$VideoPlayerHTML5Shaka76.bind(babelHelpers.assertThisInitialized(h))),h.$VideoPlayerHTML5Shaka19.addEventListener("networkinterrupted",h.$VideoPlayerHTML5Shaka77.bind(babelHelpers.assertThisInitialized(h))),h.$VideoPlayerHTML5Shaka19.addEventListener("networkresumed",h.$VideoPlayerHTML5Shaka78.bind(babelHelpers.assertThisInitialized(h))));B=!1;M=null;N=null;h.$VideoPlayerHTML5Shaka41=h.$VideoPlayerHTML5Shaka2.getBool("live_send_push_headers",!0);h.$VideoPlayerHTML5Shaka42=p;if(h.$VideoPlayerHTML5Shaka2.getBool("test_use_embedded_cb",!1)){g=new(c("URI"))(h.$VideoPlayerHTML5Shaka42);g.addQueryData("cbk","12345");h.$VideoPlayerHTML5Shaka42=g.toString()}o?h.$VideoPlayerHTML5Shaka34=c("Shaka").dash.mpd.parseMpd(o,h.$VideoPlayerHTML5Shaka42):(h.$VideoPlayerHTML5Shaka34=h.$VideoPlayerHTML5Shaka42,B=h.$VideoPlayerHTML5Shaka42&&h.$VideoPlayerHTML5Shaka42.indexOf("dash-abr")!==-1);B&&(h.$VideoPlayerHTML5Shaka41=h.$VideoPlayerHTML5Shaka2.getBool("live_abr_send_push_headers",!0),h.$VideoPlayerHTML5Shaka41&&(M=c("ShakaConstants").strings.live_abr_initial_push_representation,N=c("ShakaConstants").strings.live_abr_audio_push_representation,h.$VideoPlayerHTML5Shaka3=[c("ShakaConstants").strings.live_abr_initial_push_representation]));h.$VideoPlayerHTML5Shaka1=b;h.$VideoPlayerHTML5Shaka39=h.$VideoPlayerHTML5Shaka79();h.$VideoPlayerHTML5Shaka25=h.$VideoPlayerHTML5Shaka80();i=h.$VideoPlayerHTML5Shaka12?h.$VideoPlayerHTML5Shaka2.getBool("enable_request_pipelining_for_live",!0):h.$VideoPlayerHTML5Shaka2.getBool("enable_request_pipelining_for_vod",!0);h.$VideoPlayerHTML5Shaka52&&q&&h.$VideoPlayerHTML5Shaka53&&(h.$VideoPlayerHTML5Shaka53.delay_p2p_until_play||h.$VideoPlayerHTML5Shaka81(),i=!1);h.$VideoPlayerHTML5Shaka19.configure({enableAdaptation:h.getIsAbrEnabled(),appendPlayingQueryParam:!0,endBufferingOnPlaying:!1,usePlaybackRateForBuffering:!0,streamBufferSize:h.$VideoPlayerHTML5Shaka82(),initialStreamBufferSize:e.isAutoplayBandwidthRestrained(q)?c("ShakaConstants").numbers.initial_stream_buffer_size_for_blocked_autoplay:h.$VideoPlayerHTML5Shaka83(),dynamicStreamBufferSize:q?c("ShakaConstants").numbers.live_dynamic_stream_buffer_size:null,includeStreamBufferSizeInStartOffset:!0,minMpdRefreshInterval:c("ShakaConstants").numbers.min_mpd_refresh_interval,disableCacheBustingEvenThoughItMayAffectBandwidthEstimation:!0,liveStreamEndTimeout:c("ShakaConstants").numbers.live_stream_end_timeout,enableLiveInterruptionDetection:!0,liveInterruptionConsecutiveUpdatesWithoutChange:c("ShakaConstants").numbers.live_interruption_consecutive_updates_without_change,liveInterruptionConsecutiveUpdatesWithChange:c("ShakaConstants").numbers.live_interruption_consecutive_updates_with_change,liveMaxSegmentsToPush:c("ShakaConstants").numbers.live_max_segments_to_push,liveSendPushHeaders:e.isAutoplayBandwidthRestrained(q)?!1:h.$VideoPlayerHTML5Shaka84(),liveMaxManifestFetchesWithPush:c("ShakaConstants").numbers.live_max_manifest_fetches_with_push,resolveVideoTimeUpdateOnFragmentedTimeRanges:h.$VideoPlayerHTML5Shaka2.getBool("resolve_video_time_update_on_fragmented_time_ranges",!0),enableManifestDebug:h.$VideoPlayerHTML5Shaka2.getBool("enable_video_debug",!1),reappendInitSegmentAfterAbort:h.$VideoPlayerHTML5Shaka2.getBool("reappend_init_segment_after_abort",!1),useInlineInitSegment:!1,currentTimeDuringReadyStateZeroThrows:h.$VideoPlayerHTML5Shaka2.getBool("current_time_during_ready_state_zero_throws",!1),liveInitialPushRepresentation:M,liveAudioPushRepresentation:N,jumpToLiveThreshold:c("ShakaConstants").numbers.jump_to_live_threshold,liveDataFetchMaxRetries:c("ShakaConstants").numbers.live_data_fetch_max_retries,liveSourceBufferClearMaxRetries:c("ShakaConstants").numbers.live_source_buffer_clear_max_retries,useLongCacheForManifest:!1,jumpToEarliestPositionInCurrentBlock:!0,ignoreMinBufferTime:!1,playheadFragmentedGapDiffAllowance:c("ShakaConstants").numbers.playhead_fragmented_gap_diff_allowance,fixBufferingGoalDetermination:!0,skipEmptySegments:!1,useMicroTaskTimeouts:!0,enableRequestPipelining:i,enableStreaming:!w&&(h.$VideoPlayerHTML5Shaka12?!1:h.$VideoPlayerHTML5Shaka2.getBool("enable_streaming_for_vod",!0)),enableContentProtection:h.$VideoPlayerHTML5Shaka2.getBool("enable_content_protection",!1)});if(q){l=new(c("VideoPlayerLiveStreamState"))(j);h.$VideoPlayerHTML5Shaka36=l;c("VideoPlayerMemLeakExperiments").www_videos_memleak_on_tv?h.$VideoPlayerHTML5Shaka45.addSubscriptions(n(h.$VideoPlayerHTML5Shaka19,"liveheadIdleAt",function(a){a=a.seconds;a>(h.$VideoPlayerHTML5Shaka8||0)&&(h.$VideoPlayerHTML5Shaka85(a),h.$VideoPlayerHTML5Shaka27&&h.$VideoPlayerHTML5Shaka86()&&(h.$VideoPlayerHTML5Shaka87(),h.emit("bufferingEnd")))})):h.$VideoPlayerHTML5Shaka19.addEventListener("liveheadIdleAt",function(a){a=a.seconds;a>(h.$VideoPlayerHTML5Shaka8||0)&&(h.$VideoPlayerHTML5Shaka85(a),h.$VideoPlayerHTML5Shaka27&&h.$VideoPlayerHTML5Shaka86()&&(h.$VideoPlayerHTML5Shaka87(),h.emit("bufferingEnd")))});h.addListenersToLiveStreamState(l)}v&&h.$VideoPlayerHTML5Shaka19.setPlaybackStartTime(v);h.$VideoPlayerHTML5Shaka58=h.$VideoPlayerHTML5Shaka19.load(h.$VideoPlayerHTML5Shaka25).then(function(){h.$VideoPlayerHTML5Shaka58=null})["catch"](function(a){h.$VideoPlayerHTML5Shaka58=null;if(h.$VideoPlayerHTML5Shaka7&&h.$VideoPlayerHTML5Shaka2.getBool("ignore_errors_after_unload",!0))return;throw a});h.$VideoPlayerHTML5Shaka50&&h.$VideoPlayerHTML5Shaka50.startFixedLatencySync();return h}var f=e.prototype;f.$VideoPlayerHTML5Shaka81=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this,b=this.$VideoPlayerHTML5Shaka57;if(b==null){var d;this.$VideoPlayerHTML5Shaka57=b=new(c("P2PPlaybackSessionLogger"))(this.$VideoPlayerHTML5Shaka4,{communityId:(d=(d=this.$VideoPlayerHTML5Shaka60)==null?void 0:d.community_id)!=null?d:"unknowncustomer",communityName:(d=(d=this.$VideoPlayerHTML5Shaka60)==null?void 0:d.community_name)!=null?d:"Unknown Customer"})}try{b.logEnableP2P();d=this.$VideoPlayerHTML5Shaka55?this.$VideoPlayerHTML5Shaka55:{};var e=d.HiveJS?d.HiveJS:{};e.renderStatsCallback=function(b){a.emit("debug/dashPlayerEvent",{type:"P2PStats",event:b}),c("nullthrows")(a.$VideoPlayerHTML5Shaka57).setCurrentHiveStats(b)};d.onActiveSession=function(b){a.$VideoPlayerHTML5Shaka57&&a.$VideoPlayerHTML5Shaka57.logSessionActive(b.tech),a.emit("debug/dashPlayerEvent",{type:"P2PTech",event:b.tech})};var f=d.hiveTechOrder!=null?d.hiveTechOrder.indexOf("HiveJava"):-1;this.$VideoPlayerHTML5Shaka53&&this.$VideoPlayerHTML5Shaka53.disable_hivejava_for_livevc&&this.$VideoPlayerHTML5Shaka34&&this.$VideoPlayerHTML5Shaka34.startsWith("https://livestream-lookaside")&&d.hiveTechOrder&&f!==-1&&d.hiveTechOrder.splice(f,1);d.HiveJS=e;d.telemetryId=b.getSessionID();d.onError=this.$VideoPlayerHTML5Shaka88.bind(this);window.HiveConfig.SensitiveInfo.restrictedConnectivityInfo=!0;f=new window.HiveFacebook(this.$VideoPlayerHTML5Shaka19,this.$VideoPlayerHTML5Shaka1,d);if(!this.$VideoPlayerHTML5Shaka34)return;e=this.$VideoPlayerHTML5Shaka34.substring(this.$VideoPlayerHTML5Shaka34.indexOf("?"));this.$VideoPlayerHTML5Shaka54=f.initSession(c("nullthrows")(this.$VideoPlayerHTML5Shaka52)+e);d=this.$VideoPlayerHTML5Shaka54=(yield this.$VideoPlayerHTML5Shaka54);if(!this.$VideoPlayerHTML5Shaka19)return;d.manifest!=this.$VideoPlayerHTML5Shaka34&&b.logManifestMismatch(d.manifest,this.$VideoPlayerHTML5Shaka34);b.logSessionInit(d.tech,this.$VideoPlayerHTML5Shaka34);this.$VideoPlayerHTML5Shaka56=f;this.$VideoPlayerHTML5Shaka54=d;this.emit("p2pPluginReady")}catch(a){b.logError(a),this.$VideoPlayerHTML5Shaka54=void 0}});function d(){return a.apply(this,arguments)}return d}();f.$VideoPlayerHTML5Shaka88=function(a){this.$VideoPlayerHTML5Shaka57&&this.$VideoPlayerHTML5Shaka57.logHiveError(a)};f.disableP2PPlayback=function(){try{this.$VideoPlayerHTML5Shaka57&&this.$VideoPlayerHTML5Shaka57.logEndSession(),this.$VideoPlayerHTML5Shaka56&&this.$VideoPlayerHTML5Shaka56.closeHiveSession()}catch(a){c("FBLogger")("www_p2p_playback").warn(a.message)}this.$VideoPlayerHTML5Shaka57=null;this.$VideoPlayerHTML5Shaka56=null;this.$VideoPlayerHTML5Shaka54=null;this.$VideoPlayerHTML5Shaka52=null};f.setup=function(){};f.addListenersToLiveStreamState=function(a){var b=this;a.addListener("streamInterruptAt",this.$VideoPlayerHTML5Shaka85.bind(this));["streamInterruptAt","commercialBreakAt","endedAt"].forEach(function(c){a.addListener(c,function(a){b.emit("debug/dashPlayerEvent",{type:c,event:a})})})};f.areInbandCaptionsExpected=function(){return this.$VideoPlayerHTML5Shaka25.hasInlinedCea608Subtitles()};f.areInbandCaptionsAutogenerated=function(){return this.$VideoPlayerHTML5Shaka25.isUsingASRCaptions()||this.$VideoPlayerHTML5Shaka25.isUsingASRCaptionsEmployeeDogfooding()};f.setEnableInbandCaptionsParsing=function(a){this.$VideoPlayerHTML5Shaka25.setEnableCea608Parsing(a)};f.getDebug=function(){return{manifest:this.$VideoPlayerHTML5Shaka32,AbrManager:this.$VideoPlayerHTML5Shaka39,VideoSource:this.$VideoPlayerHTML5Shaka25,DashPlayer:this.$VideoPlayerHTML5Shaka19,VideoTaskQueue:d("VideoStreamingTaskQueueProvider").getQueue("video"),VideoTaskScheduler:d("VideoStreamingTaskQueueProvider").getSchedulerForDebug("video")}};e.getEstimatedBandwidth=function(){return m.getBandwidth()};e.isAutoplayBandwidthRestrained=function(a){return c("VideoPlayerShakaBandwidthEstimator").isAutoplayBandwidthRestrained(a)};f.$VideoPlayerHTML5Shaka61=function(){var a=this,b=this.$VideoPlayerHTML5Shaka2.getNumber("connection_quality_context_throttle_frequency",0);if(b===0)return;this.$VideoPlayerHTML5Shaka45.addSubscriptions(c("EventListener").listen(m,"bandwidth",c("throttle")(function(){a.$VideoPlayerHTML5Shaka2.setContext("connection_quality",d("VideoPlayerConnectionQuality").evaluate(e.getEstimatedBandwidth))},b)))};f.$VideoPlayerHTML5Shaka63=function(a){a=this.$VideoPlayerHTML5Shaka21.get(a);if(!a)return;var b=a.id,c=a.reason;a=a.performanceLogger;if(!this.$VideoPlayerHTML5Shaka35&&b)this.$VideoPlayerHTML5Shaka35=b;else if(this.$VideoPlayerHTML5Shaka35!==b){if(this.$VideoPlayerHTML5Shaka1.paused){this.emit("blocked_paused_representation_ended");return}var d=this.$VideoPlayerHTML5Shaka35;this.$VideoPlayerHTML5Shaka35=b;a&&(a.setStreamSwitchReason(c),a.log());this.emit("representation_ended",{representationID:d,nextRepresentationID:b,streamSwitchReason:c})}};f.getVideoStreamInfoIDForTimePosition=function(a){a=this.$VideoPlayerHTML5Shaka21.get(a);var b=null;a&&(b=a.id);return b};f.getAudioStreamInfoIDForTimePosition=function(a){return null};f.$VideoPlayerHTML5Shaka89=function(a){if(a.fbQualityLabel)return a.fbQualityLabel;else if(a.height)return[a.height,"p"].join("");return null};f.$VideoPlayerHTML5Shaka90=function(a,b){var d=this.$VideoPlayerHTML5Shaka89(a);if(d)return d;else if(c("Shaka").player.VideoTrack.compare(a,b[0])==0)return"SD";else if(c("Shaka").player.VideoTrack.compare(a,b[b.length-1])==0)return"HD";else return null};f.getAvailableVideoQualities=function(){var a=this;if(this.$VideoPlayerHTML5Shaka7)return this.$VideoPlayerHTML5Shaka22;var b=this.$VideoPlayerHTML5Shaka25.getVideoTracks();b.sort(c("Shaka").player.VideoTrack.compare);return d("VideoPlayerQualitiesArray").ensureVideoPlayerQualitiesArray(b.every(function(b){return a.$VideoPlayerHTML5Shaka89(b)!==null})?b.map(function(b){return a.$VideoPlayerHTML5Shaka89(b)}):b.length>1?["SD","HD"]:["SD"])};f.getVideoProjection=function(){return this.$VideoPlayerHTML5Shaka25.getVideoProjection()};f.getIsAbrEnabled=function(){return!this.$VideoPlayerHTML5Shaka51};f.getSelectedVideoQuality=function(){if(this.$VideoPlayerHTML5Shaka7)return this.$VideoPlayerHTML5Shaka23;var a=this.$VideoPlayerHTML5Shaka25.getVideoTracks();a.sort(c("Shaka").player.VideoTrack.compare);var b=a.find(function(a){return a.active});return b?this.$VideoPlayerHTML5Shaka90(b,a):null};f.clearBufferAfterSeekingIfLowerQuality=function(a){a=this.$VideoPlayerHTML5Shaka21.get(a);var b=a&&a.id;if(!b)return;a=this.$VideoPlayerHTML5Shaka25.getVideoTracks();var d=a.find(function(a){return a.active});a=a.find(function(a){return a.streamInfoID===b});c("Shaka").player.VideoTrack.compare(d,a)>0&&this.$VideoPlayerHTML5Shaka25.setClearBufferAfterSeeking()};f.getDashAudioConfiguration=function(){return this.$VideoPlayerHTML5Shaka25.getMpdAudioConfig()};f.canAutoSelectVideoQuality=function(){return!0};f.setPreloadDisabled=function(a){};f.restoreStreamBufferSize=function(){return};f.$VideoPlayerHTML5Shaka83=function(){return this.$VideoPlayerHTML5Shaka11?this.$VideoPlayerHTML5Shaka2.getNumber("live_initial_stream_buffer_size_float",3.5):this.$VideoPlayerHTML5Shaka2.getNumber("initial_stream_buffer_size_float",7.5)};f.$VideoPlayerHTML5Shaka82=function(){return this.$VideoPlayerHTML5Shaka11?this.$VideoPlayerHTML5Shaka2.getNumber("live_stream_buffer_size_float",3):this.$VideoPlayerHTML5Shaka2.getNumber("stream_buffer_size_float",15)};f.$VideoPlayerHTML5Shaka84=function(){return this.$VideoPlayerHTML5Shaka41};f.setPreferredVideoQuality=function(a){var b=this,d=this.$VideoPlayerHTML5Shaka25.getVideoTracks();d.sort(c("Shaka").player.VideoTrack.compare);var e=d.find(function(c){return a==b.$VideoPlayerHTML5Shaka90(c,d)});e&&(this.$VideoPlayerHTML5Shaka24=a,this.$VideoPlayerHTML5Shaka39.setPreferredVideoTrack(e))};f.unsetPreferredVideoQuality=function(){this.$VideoPlayerHTML5Shaka24=null,this.$VideoPlayerHTML5Shaka39.unsetPreferredVideoTrack()};f.isDrm=function(){if(this.$VideoPlayerHTML5Shaka16)return!0;if(this.$VideoPlayerHTML5Shaka32&&this.$VideoPlayerHTML5Shaka32!==this.$VideoPlayerHTML5Shaka42)return this.$VideoPlayerHTML5Shaka32.indexOf("<ContentProtection")>=0};f.pause=function(){this.$VideoPlayerHTML5Shaka50&&this.$VideoPlayerHTML5Shaka50.setState("stopped"),this.$VideoPlayerHTML5Shaka1.pause()};f.play=function(){this.$VideoPlayerHTML5Shaka14=!0;this.$VideoPlayerHTML5Shaka28&&this.$VideoPlayerHTML5Shaka28.playStarted();this.$VideoPlayerHTML5Shaka19.setPendingPlayRequest(!0);if(this.$VideoPlayerHTML5Shaka4){var a=c("VideoDashPrefetchCache").getPrefetchTaskByID(""+this.$VideoPlayerHTML5Shaka4);a&&d("VideoStreamingTaskQueueProvider").getQueue("video").updatePriority(a,d("VideoPriorityCalculator").getMaxPriority())}this.$VideoPlayerHTML5Shaka50&&this.$VideoPlayerHTML5Shaka50.setState("playing");return this.$VideoPlayerHTML5Shaka1.play()};f.$VideoPlayerHTML5Shaka86=function(){var a=this.$VideoPlayerHTML5Shaka8;if(a){var b=this.$VideoPlayerHTML5Shaka1.currentTime,c=4;c=b>a-c;b=b>a;b?(this.emit("debug/dashPlayerEvent",{type:"streamResumedAt",event:this.$VideoPlayerHTML5Shaka8}),this.$VideoPlayerHTML5Shaka8=null):this.$VideoPlayerHTML5Shaka27&&(this.$VideoPlayerHTML5Shaka10=c)}return this.$VideoPlayerHTML5Shaka10};f.$VideoPlayerHTML5Shaka67=function(){this.$VideoPlayerHTML5Shaka27=!0,this.$VideoPlayerHTML5Shaka86()?this.$VideoPlayerHTML5Shaka87():(this.$VideoPlayerHTML5Shaka19.setResumeAfterBuffering(!0),this.emit("bufferingStart"))};f.$VideoPlayerHTML5Shaka69=function(a){a.progress&&this.emit("bufferingProgress",a.progress)};f.$VideoPlayerHTML5Shaka66=function(){this.emit("seekRangeChanged")};f.$VideoPlayerHTML5Shaka76=function(a){this.emit("initialLiveManifestRequestFailure",{url:a.url,status:a.status})};f.$VideoPlayerHTML5Shaka75=function(a){a.replica!=null&&this.emit("replicaSwitch",{replica:a.replica,url:a.url,status:a.status,timestamp:new Date().valueOf()})};f.$VideoPlayerHTML5Shaka77=function(){this.emit("networkInterrupted")};f.$VideoPlayerHTML5Shaka78=function(){this.emit("networkResumed")};f.$VideoPlayerHTML5Shaka87=function(){this.$VideoPlayerHTML5Shaka26&&!this.$VideoPlayerHTML5Shaka29&&(this.$VideoPlayerHTML5Shaka29=this.$VideoPlayerHTML5Shaka26.getOperationLogger("stream_interrupted").start()),this.$VideoPlayerHTML5Shaka25.setIsLiveInterrupted(!0),this.emit("streamInterrupted")};f.$VideoPlayerHTML5Shaka68=function(){this.$VideoPlayerHTML5Shaka27=!1,this.$VideoPlayerHTML5Shaka29&&(this.$VideoPlayerHTML5Shaka29.log(),this.$VideoPlayerHTML5Shaka29=null),this.$VideoPlayerHTML5Shaka25.setIsLiveInterrupted(!1),this.$VideoPlayerHTML5Shaka10?this.$VideoPlayerHTML5Shaka91():this.emit("bufferingEnd")};f.$VideoPlayerHTML5Shaka70=function(a){a=a.detail||{};var b=a.status!==void 0?a.status:null,d=a.url||null;if(a.type==="Hive"&&this.$VideoPlayerHTML5Shaka54){this.$VideoPlayerHTML5Shaka88({message:a.message,code:b,severity:1});if(c("qex")._("2105"))return}this.$VideoPlayerHTML5Shaka92();var e=c("ShakaConstants").strings.block_play_request_http_status_list.split(",");if(this.$VideoPlayerHTML5Shaka11&&e.map(function(a){return parseInt(a,10)}).indexOf(b)!==-1){this.$VideoPlayerHTML5Shaka14&&(c("dispatchEvent")(this.$VideoPlayerHTML5Shaka1,"playing"),this.$VideoPlayerHTML5Shaka14=!1);return this.$VideoPlayerHTML5Shaka93()}this.emit("error",{error:("SHAKA_"+a.type).toUpperCase(),message:a.message,httpStatus:b,url:d,stack:a.stack})};f.getPlayerLoadPromise=function(){return this.$VideoPlayerHTML5Shaka58};f.unload=function(){if(this.$VideoPlayerHTML5Shaka58)return this.$VideoPlayerHTML5Shaka58.then(this.$VideoPlayerHTML5Shaka94.bind(this))["catch"](this.$VideoPlayerHTML5Shaka94.bind(this));else return this.$VideoPlayerHTML5Shaka94()};f.$VideoPlayerHTML5Shaka94=function(){var a=this;this.$VideoPlayerHTML5Shaka23=this.getSelectedVideoQuality();this.$VideoPlayerHTML5Shaka22=this.getAvailableVideoQualities();!this.$VideoPlayerHTML5Shaka25?this.$VideoPlayerHTML5Shaka11=!1:this.$VideoPlayerHTML5Shaka25.isLive()!==null&&(this.$VideoPlayerHTML5Shaka11=this.$VideoPlayerHTML5Shaka25.isLive());this.$VideoPlayerHTML5Shaka7=!0;c("clearInterval")(this.$VideoPlayerHTML5Shaka33);this.$VideoPlayerHTML5Shaka50&&this.$VideoPlayerHTML5Shaka50.stopFixedLatencySync();var b=this.$VideoPlayerHTML5Shaka36;b&&(b.unsubscribe(),b.removeAllListeners());this.$VideoPlayerHTML5Shaka28&&this.$VideoPlayerHTML5Shaka28.unload();this.$VideoPlayerHTML5Shaka57&&this.$VideoPlayerHTML5Shaka57.logUnload();this.$VideoPlayerHTML5Shaka45.release();if(c("VideoPlayerMemLeakExperiments").www_videos_memleak_on_tv){b=this.getLocalEstimator();b!=null&&b.destroy!=null&&b.destroy()}return this.$VideoPlayerHTML5Shaka19.unload()["catch"](function(b){if(a.$VideoPlayerHTML5Shaka2.getBool("ignore_errors_after_unload",!0))return;throw b})};f.$VideoPlayerHTML5Shaka79=function(){var a=this,b={shakaConfig:this.$VideoPlayerHTML5Shaka2,performanceLogger:this.$VideoPlayerHTML5Shaka26,enableAdaptation:this.getIsAbrEnabled(),minPlayQuality:this.$VideoPlayerHTML5Shaka5,maxPlayQuality:this.$VideoPlayerHTML5Shaka6,width:this.$VideoPlayerHTML5Shaka17,height:this.$VideoPlayerHTML5Shaka18,resolutionConstraintMaxWidth:this.$VideoPlayerHTML5Shaka44,resolutionConstraintMaxHeight:this.$VideoPlayerHTML5Shaka43,isSpherical:this.$VideoPlayerHTML5Shaka15,initiallyForcedRepresentations:this.$VideoPlayerHTML5Shaka3,bandwidthModel:c("VideoPlayerShakaBandwidthEstimator").getBandwidthModel(this.$VideoPlayerHTML5Shaka11),bandwidthDowngradeTarget:this.$VideoPlayerHTML5Shaka11?c("ShakaConstants").numbers.live_bandwidth_downgrade_target:c("ShakaConstants").numbers.bandwidth_downgrade_target,bandwidthUpgradeTarget:this.$VideoPlayerHTML5Shaka11?this.$VideoPlayerHTML5Shaka2.getNumber("live_bandwidth_upgrade_target",1):this.$VideoPlayerHTML5Shaka2.getNumber("bandwidth_upgrade_target",.9),useNewBandwidthBandLogic:!0,hvqUpgradeAggressiveness:this.$VideoPlayerHTML5Shaka11?c("ShakaConstants").numbers.live_hvq_upgrade_aggressiveness:c("ShakaConstants").numbers.hvq_upgrade_aggressiveness,hvqInlineUpgradeAggressiveness:this.$VideoPlayerHTML5Shaka11?c("ShakaConstants").numbers.live_hvq_inline_upgrade_aggressiveness:c("ShakaConstants").numbers.hvq_inline_upgrade_aggressiveness,preHvqUpgradeAggressiveness:this.$VideoPlayerHTML5Shaka11?c("ShakaConstants").numbers.live_pre_hvq_upgrade_aggressiveness:c("ShakaConstants").numbers.pre_hvq_upgrade_aggressiveness,preHvqInlineUpgradeAggressiveness:this.$VideoPlayerHTML5Shaka11?c("ShakaConstants").numbers.live_pre_hvq_inline_upgrade_aggressiveness:c("ShakaConstants").numbers.pre_hvq_inline_upgrade_aggressiveness,video:this.$VideoPlayerHTML5Shaka1,videoID:this.$VideoPlayerHTML5Shaka4,getSource:this.$VideoPlayerHTML5Shaka20,enableReinforcementLearning:!1,rlModelId:c("ShakaConstants").numbers.rl_model_id,rlUseShortFeatures:!1,useStrictTrackDimensionsExclusionLogic:!0,videoWatchTimeTracker:this.$VideoPlayerHTML5Shaka40,chosenVideoTrackChangedCallback:function(b){a.$VideoPlayerHTML5Shaka19.dispatchEventExtern({type:"bitrateswitch",data:b})}};return new(c("CustomAbrManager"))(b)};f.$VideoPlayerHTML5Shaka95=function(){var a=this;if(!this.$VideoPlayerHTML5Shaka2.getBool("enable_content_protection",!1))return null;var b=this.$VideoPlayerHTML5Shaka4,d=null,e=!1,f=null,g=null,h=!0,m=null;this.$VideoPlayerHTML5Shaka26&&(d=this.$VideoPlayerHTML5Shaka26.getOperationLogger("request").setType("license"));this.$VideoPlayerHTML5Shaka47!=null&&this.$VideoPlayerHTML5Shaka48!==null&&this.$VideoPlayerHTML5Shaka48!==void 0?(f=encodeURI(this.$VideoPlayerHTML5Shaka47+"&access_token="+this.$VideoPlayerHTML5Shaka48),e=!0,h=!1):"0"in this.$VideoPlayerHTML5Shaka46?f=this.$VideoPlayerHTML5Shaka46["0"]:f="/video/drm/getlicense?video_id="+b;"PLAYREADY"in this.$VideoPlayerHTML5Shaka46&&(g=this.$VideoPlayerHTML5Shaka46.PLAYREADY);var n=function(a){"body"in a&&delete a.body;if("url"in a&&a.url.search("access_token=")!==-1)try{var b=new(c("URI"))(a.url);b!=null?(b.removeQueryData(["access_token"]),a.url=b.toString()):delete a.url}catch(b){delete a.url}return JSON.stringify(a)},o=function(a){d&&d.start();var b;a.key_system===l?b=window.btoa(a.body):b=window.btoa(String.fromCharCode.apply(null,new Uint8Array(a.body)));if(e){var c={request:b};a.body=JSON.stringify(c);a.headers["Content-Type"]="application/json"}else a.body=b,a.headers["Content-Type"]="application/text";a.method="POST"},p=function(a){var b=null;a=String.fromCharCode.apply(null,a);var c=null,e=null,f;try{f=JSON.parse(a)}catch(a){f=void 0}if(f!==void 0&&f.data!==void 0&&f.data.length===1){f=f.data[0];f.error!=null?e=n(f.error):c=f.license}else c=a;if(c!==null&&c!==""){f=window.atob(c);f!==null&&f!==""&&(b=new Uint8Array(f.split("").map(function(a){return a.charCodeAt(0)})))}if(d){e!==null&&d.setError(e);a=b!==null?"success":"failed";d.setResult(a).log()}return b},q=function(b){var a=null;b===i?a=j:b===k&&(a=l);return a},r=function(a){if(a===i)return f;else if(a===k)return g;return""};return function(b,c){a.$VideoPlayerHTML5Shaka16=!0;c=null;if(a.$VideoPlayerHTML5Shaka49!=null&&a.$VideoPlayerHTML5Shaka49!==""){var d=window.atob(a.$VideoPlayerHTML5Shaka49);c=new Uint8Array(d.split("").map(function(a){return a.charCodeAt(0)}))}m=q(b);d=r(b);return m!==null&&d!==null&&d!==""?[{keySystem:m,licenseServerUrl:d,withCredentials:h,licensePreProcessor:o,licensePostProcessor:p,videoRobustness:"",audioRobustness:"",serverCertificate:c}]:null}};f.$VideoPlayerHTML5Shaka96=function(){var a=this,b={onRequestSend:function(b,c,d){a.$VideoPlayerHTML5Shaka19.dispatchEventExtern({type:"segmentrequestfinished",data:{failed:!b,mimeType:c,bytes:d||0}})}};this.$VideoPlayerHTML5Shaka19.getRequestPromise&&(b.createPromise=function(b,c){var d=a.$VideoPlayerHTML5Shaka54;if(d&&(d.tech==="HiveJS"||d.tech==="StatsJS"))if(a.$VideoPlayerHTML5Shaka19.getRequestPromise!=null)return a.$VideoPlayerHTML5Shaka19.getRequestPromise(b,c);else a.$VideoPlayerHTML5Shaka57&&a.$VideoPlayerHTML5Shaka57.logMissingGetRequestPromise();return null});return b};f.$VideoPlayerHTML5Shaka80=function(){this.$VideoPlayerHTML5Shaka39||h(0,5841);this.$VideoPlayerHTML5Shaka34||h(0,5842);var a=null,b=this.$VideoPlayerHTML5Shaka34,d=this.$VideoPlayerHTML5Shaka54;d&&(a=this.$VideoPlayerHTML5Shaka96(),b=c("nullthrows")(this.$VideoPlayerHTML5Shaka54).manifest);b=new(c("Shaka").player.DashVideoSource)(b,this.$VideoPlayerHTML5Shaka2,this.$VideoPlayerHTML5Shaka95(),m,this.$VideoPlayerHTML5Shaka39,this.$VideoPlayerHTML5Shaka50,a);this.$VideoPlayerHTML5Shaka21=new(c("TaggedTimeRanges"))(function(a,b){return a.id===b.id&&a.reason===b.reason});b.setTaggedTimeRanges(this.$VideoPlayerHTML5Shaka21);d&&this.$VideoPlayerHTML5Shaka57&&this.$VideoPlayerHTML5Shaka57.logCreatedP2PVideoSource();return b};f.$VideoPlayerHTML5Shaka97=function(a){var b=this;this.$VideoPlayerHTML5Shaka39=this.$VideoPlayerHTML5Shaka79();this.$VideoPlayerHTML5Shaka25=this.$VideoPlayerHTML5Shaka80();this.$VideoPlayerHTML5Shaka86()&&(this.$VideoPlayerHTML5Shaka9=this.$VideoPlayerHTML5Shaka19.getPlaybackRate(),this.$VideoPlayerHTML5Shaka1.playbackRate=0,this.emit("streamInterrupted"));this.$VideoPlayerHTML5Shaka19.setPlaybackStartTime(a);this.$VideoPlayerHTML5Shaka7=!1;this.$VideoPlayerHTML5Shaka58=this.$VideoPlayerHTML5Shaka19.load(this.$VideoPlayerHTML5Shaka25).then(function(){b.$VideoPlayerHTML5Shaka58=null;if(b.$VideoPlayerHTML5Shaka11!=b.$VideoPlayerHTML5Shaka25.isLive())return b.$VideoPlayerHTML5Shaka93();b.$VideoPlayerHTML5Shaka24&&b.setPreferredVideoQuality(b.$VideoPlayerHTML5Shaka24);b.$VideoPlayerHTML5Shaka23=null;b.$VideoPlayerHTML5Shaka22=d("VideoPlayerQualitiesArray").ensureVideoPlayerQualitiesArray([]);return void 0})["catch"](function(a){b.$VideoPlayerHTML5Shaka58=null;throw a});return this.$VideoPlayerHTML5Shaka58};f.$VideoPlayerHTML5Shaka98=function(a){if(this.$VideoPlayerHTML5Shaka7&&this.$VideoPlayerHTML5Shaka2.getBool("ignore_errors_after_unload",!0))return;throw a};f.reload=function(a){var c=this;if(!this.$VideoPlayerHTML5Shaka7)return b("Promise").resolve();var d=this.$VideoPlayerHTML5Shaka36;d&&(d.subscribe(),this.addListenersToLiveStreamState(d));return this.$VideoPlayerHTML5Shaka97(a)["catch"](function(a){return c.$VideoPlayerHTML5Shaka98(a)})};f.setPlaybackRate=function(a){this.$VideoPlayerHTML5Shaka9=a,this.$VideoPlayerHTML5Shaka86()||this.$VideoPlayerHTML5Shaka19.setPlaybackRate(a)};f.getPlaybackRate=function(){return this.$VideoPlayerHTML5Shaka19.getPlaybackRate()};f.setVideoStreamOffset=function(a){this.$VideoPlayerHTML5Shaka19.setVideoStreamOffset(a)};f.$VideoPlayerHTML5Shaka93=function(){c("dispatchEvent")(this.$VideoPlayerHTML5Shaka1,"seeked"),c("dispatchEvent")(this.$VideoPlayerHTML5Shaka1,"playing"),c("dispatchCustomEvent")(this.$VideoPlayerHTML5Shaka1,"pause",c("dangerouslyOverrideMediaElementEndedProperty")()),c("dispatchEvent")(this.$VideoPlayerHTML5Shaka1,"ended"),this.emit("streamResumed"),this.unload()};f.getLongestInitResponseTime=function(){return this.$VideoPlayerHTML5Shaka25.getLongestInitResponseTime()};f.getLocalEstimator=function(){return this.$VideoPlayerHTML5Shaka25.getLocalEstimator()};f.setDimensions=function(a,b){this.$VideoPlayerHTML5Shaka17=a,this.$VideoPlayerHTML5Shaka18=b,this.$VideoPlayerHTML5Shaka39.setDimensions(a,b)};e.isSupported=function(a){return c("Shaka").player.Player.isBrowserSupported()};f.$VideoPlayerHTML5Shaka72=function(){this.emit("tracksChanged")};f.$VideoPlayerHTML5Shaka71=function(a){a.contentType==="video"&&(this.$VideoPlayerHTML5Shaka26&&this.$VideoPlayerHTML5Shaka26.setRepresentationID(a.id),this.$VideoPlayerHTML5Shaka26&&this.$VideoPlayerHTML5Shaka26.setDynamicBitrate(a.bandwidth),this.emit("adaptation",{reason:a.reason}))};f.$VideoPlayerHTML5Shaka85=function(a){this.$VideoPlayerHTML5Shaka8=a};f.$VideoPlayerHTML5Shaka74=function(){this.$VideoPlayerHTML5Shaka86()&&this.$VideoPlayerHTML5Shaka91()};f.$VideoPlayerHTML5Shaka91=function(){this.$VideoPlayerHTML5Shaka8=null,this.$VideoPlayerHTML5Shaka10=!1,this.$VideoPlayerHTML5Shaka25.forceResyncVideoBuffer(),this.$VideoPlayerHTML5Shaka19.setPlaybackRate(this.$VideoPlayerHTML5Shaka9),this.emit("streamResumed")};f.$VideoPlayerHTML5Shaka73=function(){var a=this,b=this.$VideoPlayerHTML5Shaka26?this.$VideoPlayerHTML5Shaka26.getOperationLogger("manifest_wrapped").setResource(this.$VideoPlayerHTML5Shaka42).start():null,c=!this.$VideoPlayerHTML5Shaka1.paused;this.unload();this.reload().then(function(){a.$VideoPlayerHTML5Shaka10&&a.$VideoPlayerHTML5Shaka91(),c&&a.play(),b&&b.log()})["catch"](function(a){b&&b.setError(a).log()})};f.$VideoPlayerHTML5Shaka62=function(){this.$VideoPlayerHTML5Shaka14=!1,this.$VideoPlayerHTML5Shaka30&&(this.$VideoPlayerHTML5Shaka30=!1),this.$VideoPlayerHTML5Shaka19.setPendingPlayRequest(!1),this.$VideoPlayerHTML5Shaka57&&this.$VideoPlayerHTML5Shaka57.resumeStatsLogging()};f.$VideoPlayerHTML5Shaka65=function(){this.$VideoPlayerHTML5Shaka14=!0,this.$VideoPlayerHTML5Shaka52&&this.$VideoPlayerHTML5Shaka12&&this.$VideoPlayerHTML5Shaka54==null&&this.$VideoPlayerHTML5Shaka53&&this.$VideoPlayerHTML5Shaka53.delay_p2p_until_play&&this.$VideoPlayerHTML5Shaka81()};f.$VideoPlayerHTML5Shaka64=function(){this.$VideoPlayerHTML5Shaka14&&(this.$VideoPlayerHTML5Shaka14=!1,this.$VideoPlayerHTML5Shaka19.setPendingPlayRequest(!1)),this.$VideoPlayerHTML5Shaka57&&this.$VideoPlayerHTML5Shaka57.pauseStatsLogging()};f.$VideoPlayerHTML5Shaka99=function(a){if(!this.$VideoPlayerHTML5Shaka25)return;this.$VideoPlayerHTML5Shaka34=c("Shaka").dash.mpd.parseMpd(a);this.$VideoPlayerHTML5Shaka7||(this.$VideoPlayerHTML5Shaka31=Date.now(),this.$VideoPlayerHTML5Shaka25.updateManifest(this.$VideoPlayerHTML5Shaka34))};f.refreshDashManifest=function(){var a=this;this.unload();var b=c("VideoPlayerMetaData").genVideoData(this.$VideoPlayerHTML5Shaka4);return b.then(function(b){a.$VideoPlayerHTML5Shaka99(b.getDashManifest())})};f.$VideoPlayerHTML5Shaka92=function(){c("clearInterval")(this.$VideoPlayerHTML5Shaka33)};f.$VideoPlayerHTML5Shaka100=function(a){var b=a[0];if(b)if(b.startTime+.5<b.endTime)b.startTime+=.5;else{a.splice(0,1);return this.$VideoPlayerHTML5Shaka100(a)}return a};f.getSeekableRanges=function(){var a=this.$VideoPlayerHTML5Shaka19.getVideoSourceStreamLimits();if(a&&a.seekRangeGaps){a=c("getVideoPlayerShakaSeekableRanges")(a);return new(c("TimeRanges"))(this.$VideoPlayerHTML5Shaka100(a))}return null};f.setEnableLiveheadCatchup=function(a){this.$VideoPlayerHTML5Shaka19.setEnableLiveheadCatchup(a)};f.isLiveheadCatchupEnabled=function(){return this.$VideoPlayerHTML5Shaka19.isLiveheadCatchupEnabled()};f.$VideoPlayerHTML5Shaka101=function(){return this.$VideoPlayerHTML5Shaka25?this.$VideoPlayerHTML5Shaka25.getManifest():null};f.isFBWasLive=function(){var a=this.$VideoPlayerHTML5Shaka101();return!!(a&&a.FBWasLive)};f.isFBIsLiveTemplated=function(){var a=this.$VideoPlayerHTML5Shaka101();return!!(a&&a.FBIsLiveTemplated)};f.isFBMS=function(){var a=this.$VideoPlayerHTML5Shaka101();return!!(a&&a.FBMS)};f.ispDASH=function(){return!1};f.getFbManifestIdentifier=function(){var a=this.$VideoPlayerHTML5Shaka101();return a?a.FBManifestIdentifier:""};f.getPlayerVersion=function(){return"pleasantville"};f.switchReplicaSet=function(a){var b=new(c("URI"))(this.$VideoPlayerHTML5Shaka34);b.addQueryData("replica",a);this.$VideoPlayerHTML5Shaka34=b.toString()};f.getManifestUrl=function(){return this.$VideoPlayerHTML5Shaka34};f.getBandwidthEstimate=function(){return e.getEstimatedBandwidth()};f.isDashPerfLoggingEnabled=function(){return this.$VideoPlayerHTML5Shaka26!=null};return e}(c("EventEmitter"));g["default"]=a}),98);
/**
 * License: https://www.facebook.com/legal/license/KtedQ-9_l2p/
 */
__d("stream-helpers",["ManagedError","Promise"],(function(a,b,c,d,e,f){"use strict";function g(a){b("ManagedError").prototype.constructor.apply(this,arguments)}g.prototype=new(b("ManagedError"))();g.prototype.constructor=g;f.AssertionError=g;function h(a,b){if(typeof a!=="boolean"||!a)throw new g(b);return a}f.assert=h;function i(a){return typeof a==="string"||typeof a==="symbol"}f.typeIsObject=function(a){return typeof a==="object"&&a!==null||typeof a==="function"};f.createDataProperty=function(a,b,c){h(f.typeIsObject(a)),Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!0,configurable:!0})};f.createArrayFromList=function(a){return a.slice()};f.ArrayBufferCopy=function(a,b,c,d,e){new Uint8Array(a).set(new Uint8Array(c,d,e),b)};f.CreateIterResultObject=function(a,b){h(typeof b==="boolean");var c={};Object.defineProperty(c,"value",{value:a,enumerable:!0,writable:!0,configurable:!0});Object.defineProperty(c,"done",{value:b,enumerable:!0,writable:!0,configurable:!0});return c};f.IsFiniteNonNegativeNumber=function(a){if(Number.isNaN(a))return!1;if(a===Infinity)return!1;return a<0?!1:!0};function j(a,b,c){if(typeof a!=="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(a,b,c)}f.InvokeOrNoop=function(a,b,c){h(a!==void 0);h(i(b));h(Array.isArray(c));b=a[b];return b===void 0?void 0:j(b,a,c)};f.PromiseInvokeOrNoop=function(a,c,d){h(a!==void 0);h(i(c));h(Array.isArray(d));try{return b("Promise").resolve(f.InvokeOrNoop(a,c,d))}catch(a){return b("Promise").reject(a)}};f.PromiseInvokeOrPerformFallback=function(a,c,d,e,f){h(a!==void 0);h(i(c));h(Array.isArray(d));h(Array.isArray(f));var g;try{g=a[c]}catch(a){return b("Promise").reject(a)}if(g===void 0)return e.apply(void 0,f);try{return b("Promise").resolve(j(g,a,d))}catch(a){return b("Promise").reject(a)}};f.TransferArrayBuffer=function(a){return a.slice()};f.ValidateAndNormalizeHighWaterMark=function(a){a=Number(a);if(Number.isNaN(a)||a<0)throw new RangeError("highWaterMark property of a queuing strategy must be non-negative and non-NaN");return a};f.ValidateAndNormalizeQueuingStrategy=function(a,b){if(a!==void 0&&typeof a!=="function")throw new TypeError("size property of a queuing strategy must be a function");b=f.ValidateAndNormalizeHighWaterMark(b);return{size:a,highWaterMark:b}}}),null);
/**
 * License: https://www.facebook.com/legal/license/KtedQ-9_l2p/
 */
__d("stream-queue-with-sizes",["stream-helpers"],(function(a,b,c,d,e,f){"use strict";var g=b("stream-helpers").assert,h=b("stream-helpers").IsFiniteNonNegativeNumber;f.DequeueValue=function(a){g("_queue"in a&&"_queueTotalSize"in a,"Spec-level failure: DequeueValue should only be used on containers with [[queue]] and [[queueTotalSize]].");g(a._queue.length>0,"Spec-level failure: should never dequeue from an empty queue.");var b=a._queue.shift();a._queueTotalSize-=b.size;a._queueTotalSize<0&&(a._queueTotalSize=0);return b.value};f.EnqueueValueWithSize=function(a,b,c){g("_queue"in a&&"_queueTotalSize"in a,"Spec-level failure: EnqueueValueWithSize should only be used on containers with [[queue]] and [[queueTotalSize]].");c=Number(c);if(!h(c))throw new RangeError("Size must be a finite, non-NaN, non-negative number.");a._queue.push({value:b,size:c});a._queueTotalSize+=c};f.PeekQueueValue=function(a){g("_queue"in a&&"_queueTotalSize"in a,"Spec-level failure: PeekQueueValue should only be used on containers with [[queue]] and [[queueTotalSize]].");g(a._queue.length>0,"Spec-level failure: should never peek at an empty queue.");a=a._queue[0];return a.value};f.ResetQueue=function(a){g("_queue"in a&&"_queueTotalSize"in a,"Spec-level failure: ResetQueue should only be used on containers with [[queue]] and [[queueTotalSize]]."),a._queue=[],a._queueTotalSize=0}}),null);
/**
 * License: https://www.facebook.com/legal/license/5AQLfddX66n/
 */
__d("stream-utils",["stream-helpers"],(function(a,b,c,d,e,f){"use strict";var g=b("stream-helpers").AssertionError;f.rethrowAssertionErrorRejection=function(a){a&&a.constructor===g&&setTimeout(function(){throw a},0)}}),null);
/**
 * License: https://www.facebook.com/legal/license/boriBhOe8AA/
 */
__d("WritableStreamPolyfill",["MaybeNativePromise","stream-helpers","stream-queue-with-sizes","stream-utils"],(function(a,b,c,d,e,f){"use strict";var g=(c=b("stream-helpers")).InvokeOrNoop,h=c.PromiseInvokeOrNoop,i=c.ValidateAndNormalizeQueuingStrategy,j=c.typeIsObject,k=c.assert,l=b("stream-utils").rethrowAssertionErrorRejection,m=(d=b("stream-queue-with-sizes")).DequeueValue,n=d.EnqueueValueWithSize,o=d.PeekQueueValue,p=d.ResetQueue,q="[[StartSteps]]",r="[[AbortSteps]]",s="[[ErrorSteps]]";f=function(){function a(a,b){a===void 0&&(a={});b=b===void 0?{}:b;var c=b.size;b=b.highWaterMark;b=b===void 0?1:b;this._state="writable";this._storedError=void 0;this._writer=void 0;this._writableStreamController=void 0;this._writeRequests=[];this._inFlightWriteRequest=void 0;this._closeRequest=void 0;this._inFlightCloseRequest=void 0;this._pendingAbortRequest=void 0;this._backpressure=!1;var d=a.type;if(d!==void 0)throw new RangeError("Invalid type is specified");this._writableStreamController=new ga(this,a,c,b);this._writableStreamController[q]();Object.defineProperty&&Object.defineProperty(this,"locked",{get:this._isLocked.bind(this)})}var c=a.prototype;c._isLocked=function(){if(u(this)===!1)throw T("locked");return v(this)};c.abort=function(a){if(u(this)===!1)return b("MaybeNativePromise").reject(T("abort"));return v(this)===!0?b("MaybeNativePromise").reject(new TypeError("Cannot abort a stream that already has a writer")):w(this,a)};c.getWriter=function(){if(u(this)===!1)throw T("getWriter");return t(this)};return a}();e.exports={AcquireWritableStreamDefaultWriter:t,IsWritableStream:u,IsWritableStreamLocked:v,WritableStream:f,WritableStreamAbort:w,WritableStreamDefaultControllerError:S,WritableStreamDefaultWriterCloseWithErrorPropagation:a,WritableStreamDefaultWriterRelease:M,WritableStreamDefaultWriterWrite:N,WritableStreamCloseQueuedOrInFlight:F};function t(a){return new ca(a)}function u(a){if(!j(a))return!1;return!Object.prototype.hasOwnProperty.call(a,"_writableStreamController")?!1:!0}function v(a){k(u(a)===!0,"IsWritableStreamLocked should only be used on known writable streams");return a._writer===void 0?!1:!0}function w(a,c){var d=a._state;if(d==="closed")return b("MaybeNativePromise").resolve(void 0);if(d==="errored")return b("MaybeNativePromise").reject(a._storedError);var e=new TypeError("Requested to abort");if(a._pendingAbortRequest!==void 0)return b("MaybeNativePromise").reject(e);k(d==="writable"||d==="erroring","state must be writable or erroring");var f=!1;d==="erroring"&&(f=!0,c=void 0);d=new(b("MaybeNativePromise"))(function(b,d){a._pendingAbortRequest={_resolve:b,_reject:d,_reason:c,_wasAlreadyErroring:f}});f===!1&&z(a,e);return d}function x(a){k(v(a)===!0);k(a._state==="writable");var c=new(b("MaybeNativePromise"))(function(b,c){b={_resolve:b,_reject:c};a._writeRequests.push(b)});return c}function y(a,b){var c=a._state;if(c==="writable"){z(a,b);return}k(c==="erroring");A(a)}function z(a,b){k(a._storedError===void 0,"stream._storedError === undefined");k(a._state==="writable","state must be writable");var c=a._writableStreamController;k(c!==void 0,"controller must not be undefined");a._state="erroring";a._storedError=b;var d=a._writer;d!==void 0&&L(d,b);G(a)===!1&&c._started===!0&&A(a)}function A(a){k(a._state==="erroring","stream._state === erroring");k(G(a)===!1,"WritableStreamHasOperationMarkedInFlight(stream) === false");a._state="errored";a._writableStreamController[s]();var b=a._storedError;for(var c=a._writeRequests,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;f._reject(b)}a._writeRequests=[];if(a._pendingAbortRequest===void 0){H(a);return}var g=a._pendingAbortRequest;a._pendingAbortRequest=void 0;if(g._wasAlreadyErroring===!0){g._reject(b);H(a);return}f=a._writableStreamController[r](g._reason);f.then(function(){g._resolve(),H(a)},function(b){g._reject(b),H(a)})}function B(a){k(a._inFlightWriteRequest!==void 0),a._inFlightWriteRequest._resolve(void 0),a._inFlightWriteRequest=void 0}function C(a,b){k(a._inFlightWriteRequest!==void 0),a._inFlightWriteRequest._reject(b),a._inFlightWriteRequest=void 0,k(a._state==="writable"||a._state==="erroring"),y(a,b)}function D(a){k(a._inFlightCloseRequest!==void 0);a._inFlightCloseRequest._resolve(void 0);a._inFlightCloseRequest=void 0;var b=a._state;k(b==="writable"||b==="erroring");b==="erroring"&&(a._storedError=void 0,a._pendingAbortRequest!==void 0&&(a._pendingAbortRequest._resolve(),a._pendingAbortRequest=void 0));a._state="closed";b=a._writer;b!==void 0&&qa(b);k(a._pendingAbortRequest===void 0,"stream._pendingAbortRequest === undefined");k(a._storedError===void 0,"stream._storedError === undefined")}function E(a,b){k(a._inFlightCloseRequest!==void 0),a._inFlightCloseRequest._reject(b),a._inFlightCloseRequest=void 0,k(a._state==="writable"||a._state==="erroring"),a._pendingAbortRequest!==void 0&&(a._pendingAbortRequest._reject(b),a._pendingAbortRequest=void 0),y(a,b)}function F(a){return a._closeRequest===void 0&&a._inFlightCloseRequest===void 0?!1:!0}function G(a){return a._inFlightWriteRequest===void 0&&a._inFlightCloseRequest===void 0?!1:!0}function aa(a){k(a._inFlightCloseRequest===void 0),k(a._closeRequest!==void 0),a._inFlightCloseRequest=a._closeRequest,a._closeRequest=void 0}function ba(a){k(a._inFlightWriteRequest===void 0,"there must be no pending write request"),k(a._writeRequests.length!==0,"writeRequests must not be empty"),a._inFlightWriteRequest=a._writeRequests.shift()}function H(a){k(a._state==="errored",'_stream_.[[state]] is `"errored"`');a._closeRequest!==void 0&&(k(a._inFlightCloseRequest===void 0),a._closeRequest._reject(a._storedError),a._closeRequest=void 0);var b=a._writer;b!==void 0&&(X(b,a._storedError),b._closedPromise["catch"](function(){}))}function I(a,b){k(a._state==="writable");k(F(a)===!1);var c=a._writer;c!==void 0&&b!==a._backpressure&&(b===!0?ta(c):(k(b===!1),$(c)));a._backpressure=b}var ca=function(){function a(a){if(u(a)===!1)throw new TypeError("WritableStreamDefaultWriter can only be constructed with a WritableStream instance");if(v(a)===!0)throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=a;a._writer=this;var b=a._state;if(b==="writable")F(a)===!1&&a._backpressure===!0?ra(this):Z(this),W(this);else if(b==="erroring")Y(this,a._storedError),this._readyPromise["catch"](function(){}),W(this);else if(b==="closed")Z(this),oa(this);else{k(b==="errored","state must be errored");b=a._storedError;Y(this,b);this._readyPromise["catch"](function(){});na(this,b);this._closedPromise["catch"](function(){})}Object.defineProperty&&(Object.defineProperty(this,"closed",{get:this._isClosed.bind(this)}),Object.defineProperty(this,"desiredSize",{get:this._getDesiredSize.bind(this)}),Object.defineProperty(this,"ready",{get:this._isReady.bind(this)}))}var c=a.prototype;c._isClosed=function(){return J(this)===!1?b("MaybeNativePromise").reject(U("closed")):this._closedPromise};c._getDesiredSize=function(){if(J(this)===!1)throw U("desiredSize");if(this._ownerWritableStream===void 0)throw V("desiredSize");return fa(this)};c._isReady=function(){return J(this)===!1?b("MaybeNativePromise").reject(U("ready")):this._readyPromise};c.abort=function(a){if(J(this)===!1)return b("MaybeNativePromise").reject(U("abort"));return this._ownerWritableStream===void 0?b("MaybeNativePromise").reject(V("abort")):da(this,a)};c.close=function(){if(J(this)===!1)return b("MaybeNativePromise").reject(U("close"));var a=this._ownerWritableStream;if(a===void 0)return b("MaybeNativePromise").reject(V("close"));return F(a)===!0?b("MaybeNativePromise").reject(new TypeError("cannot close an already-closing stream")):K(this)};c.releaseLock=function(){if(J(this)===!1)throw U("releaseLock");var a=this._ownerWritableStream;if(a===void 0)return;k(a._writer!==void 0);M(this)};c.write=function(a){if(J(this)===!1)return b("MaybeNativePromise").reject(U("write"));return this._ownerWritableStream===void 0?b("MaybeNativePromise").reject(V("write to")):N(this,a)};return a}();function J(a){if(!j(a))return!1;return!Object.prototype.hasOwnProperty.call(a,"_ownerWritableStream")?!1:!0}function da(a,b){a=a._ownerWritableStream;k(a!==void 0);return w(a,b)}function K(a){var c=a._ownerWritableStream;k(c!==void 0);var d=c._state;if(d==="closed"||d==="errored")return b("MaybeNativePromise").reject(new TypeError("The stream (in "+d+" state) is not in the writable state and cannot be closed"));k(d==="writable"||d==="erroring");k(F(c)===!1);var e=new(b("MaybeNativePromise"))(function(a,b){a={_resolve:a,_reject:b};c._closeRequest=a});c._backpressure===!0&&d==="writable"&&$(a);ha(c._writableStreamController);return e}function a(a){var c=a._ownerWritableStream;k(c!==void 0);var d=c._state;if(F(c)===!0||d==="closed")return b("MaybeNativePromise").resolve();if(d==="errored")return b("MaybeNativePromise").reject(c._storedError);k(d==="writable"||d==="erroring");return K(a)}function ea(a,b){a._closedPromiseState==="pending"?X(a,b):pa(a,b),a._closedPromise["catch"](function(){})}function L(a,b){a._readyPromiseState==="pending"?sa(a,b):ua(a,b),a._readyPromise["catch"](function(){})}function fa(a){a=a._ownerWritableStream;var b=a._state;if(b==="errored"||b==="erroring")return null;return b==="closed"?0:O(a._writableStreamController)}function M(a){var b=a._ownerWritableStream;k(b!==void 0);k(b._writer===a);var c=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");L(a,c);ea(a,c);b._writer=void 0;a._ownerWritableStream=void 0}function N(a,c){var d=a._ownerWritableStream;k(d!==void 0);var e=d._writableStreamController,f=ia(e,c);if(d!==a._ownerWritableStream)return b("MaybeNativePromise").reject(V("write to"));a=d._state;if(a==="errored")return b("MaybeNativePromise").reject(d._storedError);if(F(d)===!0||a==="closed")return b("MaybeNativePromise").reject(new TypeError("The stream is closing or closed and cannot be written to"));if(a==="erroring")return b("MaybeNativePromise").reject(d._storedError);k(a==="writable");a=x(d);ja(e,c,f);return a}var ga=function(){function a(a,b,c,d){if(u(a)===!1)throw new TypeError("WritableStreamDefaultController can only be constructed with a WritableStream instance");if(a._writableStreamController!==void 0)throw new TypeError("WritableStreamDefaultController instances can only be created by the WritableStream constructor");this._controlledWritableStream=a;this._underlyingSink=b;this._queue=void 0;this._queueTotalSize=void 0;p(this);this._started=!1;b=i(c,d);this._strategySize=b.size;this._strategyHWM=b.highWaterMark;c=R(this);I(a,c)}var c=a.prototype;c.error=function(a){if(ka(this)===!1)throw new TypeError("WritableStreamDefaultController.prototype.error can only be used on a WritableStreamDefaultController");var b=this._controlledWritableStream._state;if(b!=="writable")return;S(this,a)};c[r]=function(a){return h(this._underlyingSink,"abort",[a])};c[s]=function(){p(this)};c[q]=function(){var a=this,c=g(this._underlyingSink,"start",[this]),d=this._controlledWritableStream;b("MaybeNativePromise").resolve(c).then(function(){k(d._state==="writable"||d._state==="erroring"),a._started=!0,P(a)},function(b){k(d._state==="writable"||d._state==="erroring"),a._started=!0,y(d,b)})["catch"](l)};return a}();function ha(a){n(a,"close",0),P(a)}function ia(a,b){var c=a._strategySize;if(c===void 0)return 1;try{return c(b)}catch(b){Q(a,b);return 1}}function O(a){return a._strategyHWM-a._queueTotalSize}function ja(a,b,c){b={chunk:b};try{n(a,b,c)}catch(b){Q(a,b);return}b=a._controlledWritableStream;if(F(b)===!1&&b._state==="writable"){c=R(a);I(b,c)}P(a)}function ka(a){if(!j(a))return!1;return!Object.prototype.hasOwnProperty.call(a,"_underlyingSink")?!1:!0}function P(a){var b=a._controlledWritableStream;if(a._started===!1)return;if(b._inFlightWriteRequest!==void 0)return;var c=b._state;if(c==="closed"||c==="errored")return;if(c==="erroring"){A(b);return}if(a._queue.length===0)return;c=o(a);c==="close"?la(a):ma(a,c.chunk)}function Q(a,b){a._controlledWritableStream._state==="writable"&&S(a,b)}function la(a){var b=a._controlledWritableStream;aa(b);m(a);k(a._queue.length===0,"queue must be empty once the final write record is dequeued");a=h(a._underlyingSink,"close",[]);a.then(function(){D(b)},function(a){E(b,a)})["catch"](l)}function ma(a,b){var c=a._controlledWritableStream;ba(c);b=h(a._underlyingSink,"write",[b,a]);b.then(function(){B(c);var b=c._state;k(b==="writable"||b==="erroring");m(a);if(F(c)===!1&&b==="writable"){b=R(a);I(c,b)}P(a)},function(a){C(c,a)})["catch"](l)}function R(a){a=O(a);return a<=0}function S(a,b){a=a._controlledWritableStream;k(a._state==="writable");z(a,b)}function T(a){return new TypeError("WritableStream.prototype."+a+" can only be used on a WritableStream")}function U(a){return new TypeError("WritableStreamDefaultWriter.prototype."+a+" can only be used on a WritableStreamDefaultWriter")}function V(a){return new TypeError("Cannot "+a+" a stream using a released writer")}function W(a){a._closedPromise=new(b("MaybeNativePromise"))(function(b,c){a._closedPromise_resolve=b,a._closedPromise_reject=c,a._closedPromiseState="pending"})}function na(a,c){a._closedPromise=b("MaybeNativePromise").reject(c),a._closedPromise_resolve=void 0,a._closedPromise_reject=void 0,a._closedPromiseState="rejected"}function oa(a){a._closedPromise=b("MaybeNativePromise").resolve(void 0),a._closedPromise_resolve=void 0,a._closedPromise_reject=void 0,a._closedPromiseState="resolved"}function X(a,b){k(a._closedPromise_resolve!==void 0,"writer._closedPromise_resolve !== undefined"),k(a._closedPromise_reject!==void 0,"writer._closedPromise_reject !== undefined"),k(a._closedPromiseState==="pending","writer._closedPromiseState is pending"),a._closedPromise_reject(b),a._closedPromise_resolve=void 0,a._closedPromise_reject=void 0,a._closedPromiseState="rejected"}function pa(a,c){k(a._closedPromise_resolve===void 0,"writer._closedPromise_resolve === undefined"),k(a._closedPromise_reject===void 0,"writer._closedPromise_reject === undefined"),k(a._closedPromiseState!=="pending","writer._closedPromiseState is not pending"),a._closedPromise=b("MaybeNativePromise").reject(c),a._closedPromiseState="rejected"}function qa(a){k(a._closedPromise_resolve!==void 0,"writer._closedPromise_resolve !== undefined"),k(a._closedPromise_reject!==void 0,"writer._closedPromise_reject !== undefined"),k(a._closedPromiseState==="pending","writer._closedPromiseState is pending"),a._closedPromise_resolve(void 0),a._closedPromise_resolve=void 0,a._closedPromise_reject=void 0,a._closedPromiseState="resolved"}function ra(a){a._readyPromise=new(b("MaybeNativePromise"))(function(b,c){a._readyPromise_resolve=b,a._readyPromise_reject=c}),a._readyPromiseState="pending"}function Y(a,c){a._readyPromise=b("MaybeNativePromise").reject(c),a._readyPromise_resolve=void 0,a._readyPromise_reject=void 0,a._readyPromiseState="rejected"}function Z(a){a._readyPromise=b("MaybeNativePromise").resolve(void 0),a._readyPromise_resolve=void 0,a._readyPromise_reject=void 0,a._readyPromiseState="fulfilled"}function sa(a,b){k(a._readyPromise_resolve!==void 0,"writer._readyPromise_resolve !== undefined"),k(a._readyPromise_reject!==void 0,"writer._readyPromise_reject !== undefined"),a._readyPromise_reject(b),a._readyPromise_resolve=void 0,a._readyPromise_reject=void 0,a._readyPromiseState="rejected"}function ta(a){k(a._readyPromise_resolve===void 0,"writer._readyPromise_resolve === undefined"),k(a._readyPromise_reject===void 0,"writer._readyPromise_reject === undefined"),a._readyPromise=new(b("MaybeNativePromise"))(function(b,c){a._readyPromise_resolve=b,a._readyPromise_reject=c}),a._readyPromiseState="pending"}function ua(a,c){k(a._readyPromise_resolve===void 0,"writer._readyPromise_resolve === undefined"),k(a._readyPromise_reject===void 0,"writer._readyPromise_reject === undefined"),a._readyPromise=b("MaybeNativePromise").reject(c),a._readyPromiseState="rejected"}function $(a){k(a._readyPromise_resolve!==void 0,"writer._readyPromise_resolve !== undefined"),k(a._readyPromise_reject!==void 0,"writer._readyPromise_reject !== undefined"),a._readyPromise_resolve(void 0),a._readyPromise_resolve=void 0,a._readyPromise_reject=void 0,a._readyPromiseState="fulfilled"}}),null);
/**
 * License: https://www.facebook.com/legal/license/boriBhOe8AA/
 */
__d("ReadableStreamPolyfill",["MaybeNativePromise","WritableStreamPolyfill","stream-helpers","stream-queue-with-sizes","stream-utils"],(function(a,b,c,d,e,f){"use strict";var g=(c=b("stream-helpers")).ArrayBufferCopy,h=c.CreateIterResultObject,i=c.IsFiniteNonNegativeNumber,j=c.InvokeOrNoop,k=c.PromiseInvokeOrNoop,l=c.TransferArrayBuffer,m=c.ValidateAndNormalizeQueuingStrategy,n=c.ValidateAndNormalizeHighWaterMark,o=c.createArrayFromList,p=c.createDataProperty,q=c.typeIsObject,r=c.assert,s=b("stream-utils").rethrowAssertionErrorRejection,t=b("stream-queue-with-sizes").DequeueValue,u=b("stream-queue-with-sizes").EnqueueValueWithSize,v=b("stream-queue-with-sizes").ResetQueue,aa=(d=b("WritableStreamPolyfill")).AcquireWritableStreamDefaultWriter,ba=d.IsWritableStream,ca=d.IsWritableStreamLocked,da=d.WritableStreamAbort,ea=d.WritableStreamDefaultWriterCloseWithErrorPropagation,fa=d.WritableStreamDefaultWriterRelease,ga=d.WritableStreamDefaultWriterWrite,w=d.WritableStreamCloseQueuedOrInFlight,x="[[CancelSteps]]",y="[[PullSteps]]",z=function(){function a(a,b){a===void 0&&(a={});b=b===void 0?{}:b;var c=b.size;b=b.highWaterMark;this._state="readable";this._reader=void 0;this._storedError=void 0;this._disturbed=!1;this._readableStreamController=void 0;var d=a.type,e=String(d);if(e==="bytes")b===void 0&&(b=0),this._readableStreamController=new Ca(this,a,b);else if(d===void 0)b===void 0&&(b=1),this._readableStreamController=new ya(this,a,c,b);else throw new RangeError("Invalid type is specified");Object.defineProperty&&Object.defineProperty(this,"locked",{get:this._isLocked.bind(this)})}var c=a.prototype;c._isLocked=function(){if(B(this)===!1)throw V("locked");return C(this)};c.cancel=function(a){if(B(this)===!1)return b("MaybeNativePromise").reject(V("cancel"));return C(this)===!0?b("MaybeNativePromise").reject(new TypeError("Cannot cancel a stream that already has a reader")):D(this,a)};c.getReader=function(a){a=a===void 0?{}:a;a=a.mode;if(B(this)===!1)throw V("getReader");if(a===void 0)return A(this);a=String(a);if(a==="byob")return ha(this);throw new RangeError("Invalid mode is specified")};c.pipeThrough=function(a,b){var c=a.writable;a=a.readable;if(c===void 0||a===void 0)throw new TypeError("readable and writable arguments must be defined");c=this.pipeTo(c,b);db(c);return a};c.pipeTo=function(a,c){var d=this;c=c===void 0?{}:c;var e=c.preventClose,f=c.preventAbort,g=c.preventCancel;if(B(this)===!1)return b("MaybeNativePromise").reject(V("pipeTo"));if(ba(a)===!1)return b("MaybeNativePromise").reject(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));e=Boolean(e);f=Boolean(f);g=Boolean(g);if(C(this)===!0)return b("MaybeNativePromise").reject(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream"));if(ca(a)===!0)return b("MaybeNativePromise").reject(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream"));var h=A(this),i=aa(a),j=!1,k=b("MaybeNativePromise").resolve();return new(b("MaybeNativePromise"))(function(c,l){function m(){k=b("MaybeNativePromise").resolve();return j===!0?b("MaybeNativePromise").resolve():i._readyPromise.then(function(){return xa(h).then(function(a){var b=a.value;a=a.done;if(a===!0)return;k=ga(i,b)["catch"](function(){})})}).then(m)}p(d,h._closedPromise,function(b){f===!1?r(function(){return da(a,b)},!0,b):t(!0,b)});p(a,i._closedPromise,function(a){g===!1?r(function(){return D(d,a)},!0,a):t(!0,a)});q(d,h._closedPromise,function(){e===!1?r(function(){return ea(i)}):t()});if(w(a)===!0||a._state==="closed"){var n=new TypeError("the destination writable stream closed before all data could be piped to it");g===!1?r(function(){return D(d,n)},!0,n):t(!0,n)}m()["catch"](function(a){k=b("MaybeNativePromise").resolve(),s(a)});function o(){var a=k;return k.then(function(){return a!==k?o():void 0})}function p(a,b,c){a._state==="errored"?c(a._storedError):b["catch"](c)["catch"](s)}function q(a,b,c){a._state==="closed"?c():b.then(c)["catch"](s)}function r(b,c,d){if(j===!0)return;j=!0;a._state==="writable"&&w(a)===!1?o().then(e):e();function e(){b().then(function(){return u(c,d)},function(a){return u(!0,a)})["catch"](s)}}function t(b,c){if(j===!0)return;j=!0;a._state==="writable"&&w(a)===!1?o().then(function(){return u(b,c)})["catch"](s):u(b,c)}function u(a,b){fa(i),va(h),a?l(b):c(void 0)}})};c.tee=function(){if(B(this)===!1)throw V("tee");var a=ia(this,!1);return o(a)};return a}();e.exports={ReadableStream:z,IsReadableStreamDisturbed:a,ReadableStreamDefaultControllerClose:N,ReadableStreamDefaultControllerEnqueue:O,ReadableStreamDefaultControllerError:P,ReadableStreamDefaultControllerGetDesiredSize:Aa};function ha(a){return new sa(a)}function A(a){return new ra(a)}function B(a){if(!q(a))return!1;return!Object.prototype.hasOwnProperty.call(a,"_readableStreamController")?!1:!0}function a(a){r(B(a)===!0,"IsReadableStreamDisturbed should only be used on known readable streams");return a._disturbed}function C(a){r(B(a)===!0,"IsReadableStreamLocked should only be used on known readable streams");return a._reader===void 0?!1:!0}function ia(a,c){r(B(a)===!0);r(typeof c==="boolean");var d=A(a),e={closedOrErrored:!1,canceled1:!1,canceled2:!1,reason1:void 0,reason2:void 0};e.promise=new(b("MaybeNativePromise"))(function(a){e._resolve=a});var f=ja();f._reader=d;f._teeState=e;f._cloneForBranch2=c;c=ka();c._stream=a;c._teeState=e;var g=la();g._stream=a;g._teeState=e;a=Object.create(Object.prototype);p(a,"pull",f);p(a,"cancel",c);c=new z(a);a=Object.create(Object.prototype);p(a,"pull",f);p(a,"cancel",g);g=new z(a);f._branch1=c._readableStreamController;f._branch2=g._readableStreamController;d._closedPromise["catch"](function(a){if(e.closedOrErrored===!0)return;P(f._branch1,a);P(f._branch2,a);e.closedOrErrored=!0});return[c,g]}function ja(){function a(){var b=a._reader,c=a._branch1,d=a._branch2,e=a._teeState;return xa(b).then(function(a){r(q(a));var b=a.value;a=a.done;r(typeof a==="boolean");a===!0&&e.closedOrErrored===!1&&(e.canceled1===!1&&N(c),e.canceled2===!1&&N(d),e.closedOrErrored=!0);if(e.closedOrErrored===!0)return;a=b;b=b;e.canceled1===!1&&O(c,a);e.canceled2===!1&&O(d,b)})}return a}function ka(){function a(b){var c=a._stream,d=a._teeState;d.canceled1=!0;d.reason1=b;if(d.canceled2===!0){b=o([d.reason1,d.reason2]);c=D(c,b);d._resolve(c)}return d.promise}return a}function la(){function a(b){var c=a._stream,d=a._teeState;d.canceled2=!0;d.reason2=b;if(d.canceled1===!0){b=o([d.reason1,d.reason2]);c=D(c,b);d._resolve(c)}return d.promise}return a}function ma(a){r(J(a._reader)===!0);r(a._state==="readable"||a._state==="closed");var c=new(b("MaybeNativePromise"))(function(b,c){b={_resolve:b,_reject:c};a._reader._readIntoRequests.push(b)});return c}function na(a){r(K(a._reader)===!0);r(a._state==="readable");var c=new(b("MaybeNativePromise"))(function(b,c){b={_resolve:b,_reject:c};a._reader._readRequests.push(b)});return c}function D(a,c){a._disturbed=!0;if(a._state==="closed")return b("MaybeNativePromise").resolve(void 0);if(a._state==="errored")return b("MaybeNativePromise").reject(a._storedError);E(a);a=a._readableStreamController[x](c);return a.then(function(){return void 0})}function E(a){r(a._state==="readable");a._state="closed";a=a._reader;if(a===void 0)return void 0;if(K(a)===!0){for(var b=a._readRequests,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;e=e._resolve;e(h(void 0,!0))}a._readRequests=[]}bb(a);return void 0}function oa(a,b){r(B(a)===!0,"stream must be ReadableStream");r(a._state==="readable","state must be readable");a._state="errored";a._storedError=b;a=a._reader;if(a===void 0)return void 0;if(K(a)===!0){for(var c=a._readRequests,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;f._reject(b)}a._readRequests=[]}else{r(J(a),"reader must be ReadableStreamBYOBReader");for(f=a._readIntoRequests,e=Array.isArray(f),d=0,f=e?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(d>=f.length)break;c=f[d++]}else{d=f.next();if(d.done)break;c=d.value}c=c;c._reject(b)}a._readIntoRequests=[]}$a(a,b);a._closedPromise["catch"](function(){})}function pa(a,b,c){a=a._reader;r(a._readIntoRequests.length>0);a=a._readIntoRequests.shift();a._resolve(h(b,c))}function F(a,b,c){a=a._reader;r(a._readRequests.length>0);a=a._readRequests.shift();a._resolve(h(b,c))}function qa(a){return a._reader._readIntoRequests.length}function G(a){return a._reader._readRequests.length}function H(a){a=a._reader;if(a===void 0)return!1;return J(a)===!1?!1:!0}function I(a){a=a._reader;if(a===void 0)return!1;return K(a)===!1?!1:!0}var ra=function(){function a(a){if(B(a)===!1)throw new TypeError("ReadableStreamDefaultReader can only be constructed with a ReadableStream instance");if(C(a)===!0)throw new TypeError("This stream has already been locked for exclusive reading by another reader");ta(this,a);this._readRequests=[];Object.defineProperty&&Object.defineProperty(this,"closed",{get:this._isClosed.bind(this)})}var c=a.prototype;c._isClosed=function(){return K(this)===!1?b("MaybeNativePromise").reject(X("closed")):this._closedPromise};c.cancel=function(a){if(K(this)===!1)return b("MaybeNativePromise").reject(X("cancel"));return this._ownerReadableStream===void 0?b("MaybeNativePromise").reject(W("cancel")):ua(this,a)};c.read=function(){if(K(this)===!1)return b("MaybeNativePromise").reject(X("read"));return this._ownerReadableStream===void 0?b("MaybeNativePromise").reject(W("read from")):xa(this)};c.releaseLock=function(){if(K(this)===!1)throw X("releaseLock");if(this._ownerReadableStream===void 0)return;if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");va(this)};return a}(),sa=function(){function a(a){if(!B(a))throw new TypeError("ReadableStreamBYOBReader can only be constructed with a ReadableStream instance given a byte source");if(R(a._readableStreamController)===!1)throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");if(C(a))throw new TypeError("This stream has already been locked for exclusive reading by another reader");ta(this,a);this._readIntoRequests=[];Object.defineProperty&&Object.defineProperty(this,"closed",{get:this._isClosed.bind(this)})}var c=a.prototype;c._isClosed=function(){return!J(this)?b("MaybeNativePromise").reject(Y("closed")):this._closedPromise};c.cancel=function(a){if(!J(this))return b("MaybeNativePromise").reject(Y("cancel"));return this._ownerReadableStream===void 0?b("MaybeNativePromise").reject(W("cancel")):ua(this,a)};c.read=function(a){if(!J(this))return b("MaybeNativePromise").reject(Y("read"));if(this._ownerReadableStream===void 0)return b("MaybeNativePromise").reject(W("read from"));if(!ArrayBuffer.isView(a))return b("MaybeNativePromise").reject(new TypeError("view must be an array buffer view"));return a.byteLength===0?b("MaybeNativePromise").reject(new TypeError("view must have non-zero byteLength")):wa(this,a)};c.releaseLock=function(){if(!J(this))throw Y("releaseLock");if(this._ownerReadableStream===void 0)return;if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");va(this)};return a}();function J(a){if(!q(a))return!1;return!Object.prototype.hasOwnProperty.call(a,"_readIntoRequests")?!1:!0}function K(a){if(!q(a))return!1;return!Object.prototype.hasOwnProperty.call(a,"_readRequests")?!1:!0}function ta(a,b){a._ownerReadableStream=b,b._reader=a,b._state==="readable"?Xa(a):b._state==="closed"?Za(a):(r(b._state==="errored","state must be errored"),Ya(a,b._storedError),a._closedPromise["catch"](function(){}))}function ua(a,b){a=a._ownerReadableStream;r(a!==void 0);return D(a,b)}function va(a){r(a._ownerReadableStream!==void 0),r(a._ownerReadableStream._reader===a),a._ownerReadableStream._state==="readable"?$a(a,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):ab(a,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),a._closedPromise["catch"](function(){}),a._ownerReadableStream._reader=void 0,a._ownerReadableStream=void 0}function wa(a,c){a=a._ownerReadableStream;r(a!==void 0);a._disturbed=!0;return a._state==="errored"?b("MaybeNativePromise").reject(a._storedError):Ma(a._readableStreamController,c)}function xa(a){a=a._ownerReadableStream;r(a!==void 0);a._disturbed=!0;if(a._state==="closed")return b("MaybeNativePromise").resolve(h(void 0,!0));if(a._state==="errored")return b("MaybeNativePromise").reject(a._storedError);r(a._state==="readable");return a._readableStreamController[y]()}var ya=function(){function a(a,c,d,e){if(B(a)===!1)throw new TypeError("ReadableStreamDefaultController can only be constructed with a ReadableStream instance");if(a._readableStreamController!==void 0)throw new TypeError("ReadableStreamDefaultController instances can only be created by the ReadableStream constructor");this._controlledReadableStream=a;this._underlyingSource=c;this._queue=void 0;this._queueTotalSize=void 0;v(this);this._started=!1;this._closeRequested=!1;this._pullAgain=!1;this._pulling=!1;a=m(d,e);this._strategySize=a.size;this._strategyHWM=a.highWaterMark;var f=this;d=j(c,"start",[this]);b("MaybeNativePromise").resolve(d).then(function(){f._started=!0,r(f._pulling===!1),r(f._pullAgain===!1),M(f)},function(a){Q(f,a)})["catch"](s);Object.defineProperty&&Object.defineProperty(this,"desiredSize",{get:this._getDesiredSize.bind(this)})}var c=a.prototype;c._getDesiredSize=function(){if(L(this)===!1)throw Z("desiredSize");return Aa(this)};c.close=function(){if(L(this)===!1)throw Z("close");if(this._closeRequested===!0)throw new TypeError("The stream has already been closed; do not close it again!");var a=this._controlledReadableStream._state;if(a!=="readable")throw new TypeError("The stream (in "+a+" state) is not in the readable state and cannot be closed");N(this)};c.enqueue=function(a){if(L(this)===!1)throw Z("enqueue");if(this._closeRequested===!0)throw new TypeError("stream is closed or draining");var b=this._controlledReadableStream._state;if(b!=="readable")throw new TypeError("The stream (in "+b+" state) is not in the readable state and cannot be enqueued to");return O(this,a)};c.error=function(a){if(L(this)===!1)throw Z("error");var b=this._controlledReadableStream;if(b._state!=="readable")throw new TypeError("The stream is "+b._state+" and so cannot be errored");P(this,a)};c[x]=function(a){v(this);return k(this._underlyingSource,"cancel",[a])};c[y]=function(){var a=this._controlledReadableStream;if(this._queue.length>0){var c=t(this);this._closeRequested===!0&&this._queue.length===0?E(a):M(this);return b("MaybeNativePromise").resolve(h(c,!1))}c=na(a);M(this);return c};return a}();function L(a){if(!q(a))return!1;return!Object.prototype.hasOwnProperty.call(a,"_underlyingSource")?!1:!0}function M(a){var b=za(a);if(b===!1)return void 0;if(a._pulling===!0){a._pullAgain=!0;return void 0}r(a._pullAgain===!1);a._pulling=!0;b=k(a._underlyingSource,"pull",[a]);b.then(function(){a._pulling=!1;if(a._pullAgain===!0){a._pullAgain=!1;return M(a)}return void 0},function(b){Q(a,b)})["catch"](s);return void 0}function za(a){var b=a._controlledReadableStream;if(b._state==="closed"||b._state==="errored")return!1;if(a._closeRequested===!0)return!1;if(a._started===!1)return!1;if(C(b)===!0&&G(b)>0)return!0;b=Aa(a);return b>0?!0:!1}function N(a){var b=a._controlledReadableStream;r(a._closeRequested===!1);r(b._state==="readable");a._closeRequested=!0;a._queue.length===0&&E(b)}function O(a,b){var c=a._controlledReadableStream;r(a._closeRequested===!1);r(c._state==="readable");if(C(c)===!0&&G(c)>0)F(c,b,!1);else{c=1;if(a._strategySize!==void 0){var d=a._strategySize;try{c=d(b)}catch(b){Q(a,b);throw b}}try{u(a,b,c)}catch(b){Q(a,b);throw b}}M(a);return void 0}function P(a,b){var c=a._controlledReadableStream;r(c._state==="readable");v(a);oa(c,b)}function Q(a,b){a._controlledReadableStream._state==="readable"&&P(a,b)}function Aa(a){var b=a._controlledReadableStream;b=b._state;if(b==="errored")return null;return b==="closed"?0:a._strategyHWM-a._queueTotalSize}var Ba=function(){function a(a,b){this._associatedReadableByteStreamController=a,this._view=b,Object.defineProperty&&Object.defineProperty(this,"view",{get:this._getView.bind(this)})}var b=a.prototype;b._getView=function(){return this._view};b.respond=function(a){if(Da(this)===!1)throw cb("respond");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Va(this._associatedReadableByteStreamController,a)};b.respondWithNewView=function(a){if(Da(this)===!1)throw cb("respond");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(!ArrayBuffer.isView(a))throw new TypeError("You can only respond with array buffer views");Wa(this._associatedReadableByteStreamController,a)};return a}(),Ca=function(){function a(a,c,d){if(B(a)===!1)throw new TypeError("ReadableByteStreamController can only be constructed with a ReadableStream instance given a byte source");if(a._readableStreamController!==void 0)throw new TypeError("ReadableByteStreamController instances can only be created by the ReadableStream constructor given a byte source");this._controlledReadableStream=a;this._underlyingByteSource=c;this._pullAgain=!1;this._pulling=!1;Ea(this);this._queue=this._queueTotalSize=void 0;v(this);this._closeRequested=!1;this._started=!1;this._strategyHWM=n(d);d=c.autoAllocateChunkSize;if(d!==void 0&&(Number.isInteger(d)===!1||d<=0))throw new RangeError("autoAllocateChunkSize must be a positive integer");this._autoAllocateChunkSize=d;this._pendingPullIntos=[];var e=this;d=j(c,"start",[this]);b("MaybeNativePromise").resolve(d).then(function(){e._started=!0,r(e._pulling===!1),r(e._pullAgain===!1),S(e)},function(b){a._state==="readable"&&U(e,b)})["catch"](s);Object.defineProperty&&(Object.defineProperty(this,"byobRequest",{get:this._getByobRequest.bind(this)}),Object.defineProperty(this,"desiredSize",{get:this._getByobRequest.bind(this)}))}var c=a.prototype;c._getByobRequest=function(){if(R(this)===!1)throw $("byobRequest");if(this._byobRequest===void 0&&this._pendingPullIntos.length>0){var a=this._pendingPullIntos[0];a=new Uint8Array(a.buffer,a.byteOffset+a.bytesFilled,a.byteLength-a.bytesFilled);this._byobRequest=new Ba(this,a)}return this._byobRequest};c._getDesiredSize=function(){if(R(this)===!1)throw $("desiredSize");return Ua(this)};c.close=function(){if(R(this)===!1)throw $("close");if(this._closeRequested===!0)throw new TypeError("The stream has already been closed; do not close it again!");var a=this._controlledReadableStream._state;if(a!=="readable")throw new TypeError("The stream (in "+a+" state) is not in the readable state and cannot be closed");Sa(this)};c.enqueue=function(a){if(R(this)===!1)throw $("enqueue");if(this._closeRequested===!0)throw new TypeError("stream is closed or draining");var b=this._controlledReadableStream._state;if(b!=="readable")throw new TypeError("The stream (in "+b+" state) is not in the readable state and cannot be enqueued to");if(!ArrayBuffer.isView(a))throw new TypeError("You can only enqueue array buffer views when using a ReadableByteStreamController");Ta(this,a)};c.error=function(a){if(R(this)===!1)throw $("error");var b=this._controlledReadableStream;if(b._state!=="readable")throw new TypeError("The stream is "+b._state+" and so cannot be errored");U(this,a)};c[x]=function(a){if(this._pendingPullIntos.length>0){var b=this._pendingPullIntos[0];b.bytesFilled=0}v(this);return k(this._underlyingByteSource,"cancel",[a])};c[y]=function(){var a=this._controlledReadableStream;r(I(a)===!0);if(this._queueTotalSize>0){r(G(a)===0);var c=this._queue.shift();this._queueTotalSize-=c.byteLength;Ja(this);var d;try{d=new Uint8Array(c.buffer,c.byteOffset,c.byteLength)}catch(a){return b("MaybeNativePromise").reject(a)}return b("MaybeNativePromise").resolve(h(d,!1))}c=this._autoAllocateChunkSize;if(c!==void 0){var e;try{e=new ArrayBuffer(c)}catch(a){return b("MaybeNativePromise").reject(a)}c={buffer:e,byteOffset:0,byteLength:c,bytesFilled:0,elementSize:1,ctor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(c)}c=na(a);S(this);return c};return a}();function R(a){if(!q(a))return!1;return!Object.prototype.hasOwnProperty.call(a,"_underlyingByteSource")?!1:!0}function Da(a){if(!q(a))return!1;return!Object.prototype.hasOwnProperty.call(a,"_associatedReadableByteStreamController")?!1:!0}function S(a){var b=Ra(a);if(b===!1)return void 0;if(a._pulling===!0){a._pullAgain=!0;return void 0}r(a._pullAgain===!1);a._pulling=!0;b=k(a._underlyingByteSource,"pull",[a]);b.then(function(){a._pulling=!1,a._pullAgain===!0&&(a._pullAgain=!1,S(a))},function(b){a._controlledReadableStream._state==="readable"&&U(a,b)})["catch"](s);return void 0}function Ea(a){Ka(a),a._pendingPullIntos=[]}function Fa(a,b){r(a._state!=="errored","state must not be errored");var c=!1;a._state==="closed"&&(r(b.bytesFilled===0),c=!0);var d=Ga(b);b.readerType==="default"?F(a,d,c):(r(b.readerType==="byob"),pa(a,d,c))}function Ga(a){var b=a.bytesFilled,c=a.elementSize;r(b<=a.byteLength);r(b%c===0);return new a.ctor(a.buffer,a.byteOffset,b/c)}function T(a,b,c,d){a._queue.push({buffer:b,byteOffset:c,byteLength:d}),a._queueTotalSize+=d}function Ha(a,b){var c=b.elementSize,d=b.bytesFilled-b.bytesFilled%c,e=Math.min(a._queueTotalSize,b.byteLength-b.bytesFilled),f=b.bytesFilled+e;f=f-f%c;c=e;e=!1;f>d&&(c=f-b.bytesFilled,e=!0);d=a._queue;while(c>0){f=d[0];var h=Math.min(c,f.byteLength),i=b.byteOffset+b.bytesFilled;g(b.buffer,i,f.buffer,f.byteOffset,h);f.byteLength===h?d.shift():(f.byteOffset+=h,f.byteLength-=h);a._queueTotalSize-=h;Ia(a,h,b);c-=h}e===!1&&(r(a._queueTotalSize===0,"queue must be empty"),r(b.bytesFilled>0),r(b.bytesFilled<b.elementSize));return e}function Ia(a,b,c){r(a._pendingPullIntos.length===0||a._pendingPullIntos[0]===c),Ka(a),c.bytesFilled+=b}function Ja(a){r(a._controlledReadableStream._state==="readable"),a._queueTotalSize===0&&a._closeRequested===!0?E(a._controlledReadableStream):S(a)}function Ka(a){if(a._byobRequest===void 0)return;a._byobRequest._associatedReadableByteStreamController=void 0;a._byobRequest._view=void 0;a._byobRequest=void 0}function La(a){r(a._closeRequested===!1);while(a._pendingPullIntos.length>0){if(a._queueTotalSize===0)return;var b=a._pendingPullIntos[0];Ha(a,b)===!0&&(Qa(a),Fa(a._controlledReadableStream,b))}}function Ma(a,c){var d=a._controlledReadableStream,e=1;c.constructor!==DataView&&(e=c.constructor.BYTES_PER_ELEMENT);var f=c.constructor;e={buffer:c.buffer,byteOffset:c.byteOffset,byteLength:c.byteLength,bytesFilled:0,elementSize:e,ctor:f,readerType:"byob"};if(a._pendingPullIntos.length>0){e.buffer=l(e.buffer);a._pendingPullIntos.push(e);return ma(d)}if(d._state==="closed"){f=new c.constructor(e.buffer,e.byteOffset,0);return b("MaybeNativePromise").resolve(h(f,!0))}if(a._queueTotalSize>0){if(Ha(a,e)===!0){c=Ga(e);Ja(a);return b("MaybeNativePromise").resolve(h(c,!1))}if(a._closeRequested===!0){f=new TypeError("Insufficient bytes to fill elements in the given buffer");U(a,f);return b("MaybeNativePromise").reject(f)}}e.buffer=l(e.buffer);a._pendingPullIntos.push(e);c=ma(d);S(a);return c}function Na(a,b){b.buffer=l(b.buffer);r(b.bytesFilled===0,"bytesFilled must be 0");b=a._controlledReadableStream;if(H(b)===!0)while(qa(b)>0){var c=Qa(a);Fa(b,c)}}function Oa(a,b,c){if(c.bytesFilled+b>c.byteLength)throw new RangeError("bytesWritten out of range");Ia(a,b,c);if(c.bytesFilled<c.elementSize)return;Qa(a);b=c.bytesFilled%c.elementSize;if(b>0){var d=c.byteOffset+c.bytesFilled;d=c.buffer.slice(d-b,d);T(a,d,0,d.byteLength)}c.buffer=l(c.buffer);c.bytesFilled-=b;Fa(a._controlledReadableStream,c);La(a)}function Pa(a,b){var c=a._pendingPullIntos[0],d=a._controlledReadableStream;if(d._state==="closed"){if(b!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream");Na(a,c)}else r(d._state==="readable"),Oa(a,b,c)}function Qa(a){var b=a._pendingPullIntos.shift();Ka(a);return b}function Ra(a){var b=a._controlledReadableStream;if(b._state!=="readable")return!1;if(a._closeRequested===!0)return!1;if(a._started===!1)return!1;if(I(b)===!0&&G(b)>0)return!0;if(H(b)===!0&&qa(b)>0)return!0;return Ua(a)>0?!0:!1}function Sa(a){var b=a._controlledReadableStream;r(a._closeRequested===!1);r(b._state==="readable");if(a._queueTotalSize>0){a._closeRequested=!0;return}if(a._pendingPullIntos.length>0){var c=a._pendingPullIntos[0];if(c.bytesFilled>0){c=new TypeError("Insufficient bytes to fill elements in the given buffer");U(a,c);throw c}}E(b)}function Ta(a,b){var c=a._controlledReadableStream;r(a._closeRequested===!1);r(c._state==="readable");var d=b.buffer,e=b.byteOffset;b=b.byteLength;d=l(d);if(I(c)===!0)if(G(c)===0)T(a,d,e,b);else{r(a._queue.length===0);var f=new Uint8Array(d,e,b);F(c,f,!1)}else H(c)===!0?(T(a,d,e,b),La(a)):(r(C(c)===!1,"stream must not be locked"),T(a,d,e,b))}function U(a,b){var c=a._controlledReadableStream;r(c._state==="readable");Ea(a);v(a);oa(c,b)}function Ua(a){var b=a._controlledReadableStream;b=b._state;if(b==="errored")return null;return b==="closed"?0:a._strategyHWM-a._queueTotalSize}function Va(a,b){b=Number(b);if(i(b)===!1)throw new RangeError("bytesWritten must be a finite");r(a._pendingPullIntos.length>0);Pa(a,b)}function Wa(a,b){r(a._pendingPullIntos.length>0);var c=a._pendingPullIntos[0];if(c.byteOffset+c.bytesFilled!==b.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(c.byteLength!==b.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");c.buffer=b.buffer;Pa(a,b.byteLength)}function V(a){return new TypeError("ReadableStream.prototype."+a+" can only be used on a ReadableStream")}function W(a){return new TypeError("Cannot "+a+" a stream using a released reader")}function X(a){return new TypeError("ReadableStreamDefaultReader.prototype."+a+" can only be used on a ReadableStreamDefaultReader")}function Xa(a){a._closedPromise=new(b("MaybeNativePromise"))(function(b,c){a._closedPromise_resolve=b,a._closedPromise_reject=c})}function Ya(a,c){a._closedPromise=b("MaybeNativePromise").reject(c),a._closedPromise_resolve=void 0,a._closedPromise_reject=void 0}function Za(a){a._closedPromise=b("MaybeNativePromise").resolve(void 0),a._closedPromise_resolve=void 0,a._closedPromise_reject=void 0}function $a(a,b){r(a._closedPromise_resolve!==void 0),r(a._closedPromise_reject!==void 0),a._closedPromise_reject(b),a._closedPromise_resolve=void 0,a._closedPromise_reject=void 0}function ab(a,c){r(a._closedPromise_resolve===void 0),r(a._closedPromise_reject===void 0),a._closedPromise=b("MaybeNativePromise").reject(c)}function bb(a){r(a._closedPromise_resolve!==void 0),r(a._closedPromise_reject!==void 0),a._closedPromise_resolve(void 0),a._closedPromise_resolve=void 0,a._closedPromise_reject=void 0}function Y(a){return new TypeError("ReadableStreamBYOBReader.prototype."+a+" can only be used on a ReadableStreamBYOBReader")}function Z(a){return new TypeError("ReadableStreamDefaultController.prototype."+a+" can only be used on a ReadableStreamDefaultController")}function cb(a){return new TypeError("ReadableStreamBYOBRequest.prototype."+a+" can only be used on a ReadableStreamBYOBRequest")}function $(a){return new TypeError("ReadableByteStreamController.prototype."+a+" can only be used on a ReadableByteStreamController")}function db(a){try{b("MaybeNativePromise").prototype.then.call(a,void 0,function(){})}catch(a){}}}),null);