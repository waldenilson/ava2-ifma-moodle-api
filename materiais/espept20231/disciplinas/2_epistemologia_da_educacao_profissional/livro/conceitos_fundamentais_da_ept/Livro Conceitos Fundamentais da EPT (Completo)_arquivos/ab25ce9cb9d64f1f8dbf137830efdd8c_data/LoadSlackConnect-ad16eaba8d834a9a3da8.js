/*! For license information please see LoadSlackConnect-ad16eaba8d834a9a3da8.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"1PCe":function(e,n,t){var i;!function(){"use strict";var t={}.hasOwnProperty;function o(){for(var e=[],n=0;n<arguments.length;n++){var i=arguments[n];if(i){var a=typeof i;if("string"===a||"number"===a)e.push(i);else if(Array.isArray(i)){if(i.length){var r=o.apply(null,i);r&&e.push(r)}}else if("object"===a)if(i.toString===Object.prototype.toString)for(var c in i)t.call(i,c)&&i[c]&&e.push(c);else e.push(i.toString())}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(i=function(){return o}.apply(n,[]))||(e.exports=i)}()},Pjel:function(e,n){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"onSessionRequestToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"encodedPublicKey"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sessionRequestToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"encodedPublicKey"},value:{kind:"Variable",name:{kind:"Name",value:"encodedPublicKey"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isImpersonating"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:173}};t.loc.source={body:"subscription onSessionRequestToken($encodedPublicKey: String!) {\n  sessionRequestToken(encodedPublicKey: $encodedPublicKey) {\n    token\n    status\n    isImpersonating\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function i(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var t=e.type;"NamedType"===t.kind&&n.add(t.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){i(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){i(e,n)})),e.definitions&&e.definitions.forEach((function(e){i(e,n)}))}var o={};function a(e,n){for(var t=0;t<e.definitions.length;t++){var i=e.definitions[t];if(i.name&&i.name.value==n)return i}}!function(){t.definitions.forEach((function(e){if(e.name){var n=new Set;i(e,n),o[e.name.value]=n}}))}(),e.exports=t,e.exports.onSessionRequestToken=function(e,n){var t={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(t.loc=e.loc);var i=o[n]||new Set,r=new Set,c=new Set;for(i.forEach((function(e){c.add(e)}));c.size>0;){var s=c;c=new Set,s.forEach((function(e){r.has(e)||(r.add(e),(o[e]||new Set).forEach((function(e){c.add(e)})))}))}return r.forEach((function(n){var i=a(e,n);i&&t.definitions.push(i)})),t}(t,"onSessionRequestToken")},Ufsh:function(e,n,t){"use strict";t.d(n,"a",(function(){return k}));var i=t("w0eX"),o=t.n(i),a=t("Fh3I"),r=t("MAK6"),c=t("5scI"),s=e=>c.Buffer.from(e).toString("base64"),u=t("gKYl"),d=t("7WnO"),l=t("/ccR"),f=t("Pjel"),p=t.n(f),m=t("bvF0"),v=t("0lUd"),h=t("ejdg");const{APP_SOURCE_SLACK_DESKTOP:b}=u.e,{Team:y}=u.sb,k=function(){var e=o()((function*(e,n){const t=Object(a.a)(),i=m.d(),o=o=>{m.j(o,{source:b,videoId:e,loginAttemptId:t,anonymousId:i.anonID,deviceId:i.deviceID,entryPoint:n,isSlackSharedAuthV2:!0,unfurl:d.m.getUnfurlType()})};o(r.c.Initiated);try{const{publicKeyAsPem:e,privateKey:n}=yield(async()=>{const e=await window.crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:4096,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},!0,["encrypt","decrypt"]),{publicKey:n,privateKey:t}=e,i=await window.crypto.subtle.exportKey("spki",n);return{publicKeyAsPem:(e=>{let n="-----BEGIN PUBLIC KEY-----\n";for(;e.length>0;)n+=e.substring(0,64)+"\n",e=e.substring(64);return n+="-----END PUBLIC KEY-----",n})(s(i)),privateKey:t,publicKey:n}})(),a=s(e),c=Object(v.b)(),u=c.subscribe({variables:{encodedPublicKey:a},query:p.a}).subscribe((e=>{u.unsubscribe(),c.stop(),S({body:e,trackingIds:i,loginAttemptId:t,privateKey:n,track:o})}));o(r.c.GraphQLSubscribed);const d={anon_id:i.anonID,device_id:i.deviceID,app_source:b,ak:a,login_attempt_id:t,custom_title:encodeURIComponent("Sign in to Loom to connect your account"),redirect_after:"".concat(l.n,"/slack/shared-auth/success")},f=Object.keys(d).map((e=>"".concat(e,"=").concat(d[e]))),m="".concat(l.n,"/shared-auth/login?").concat(f.join("&"));return window.open(m),m}catch(e){h.c(Error("Failed to invoke Slack shared auth flow."),{error:e},{team:y.ViewerX})}}));return function(n,t){return e.apply(this,arguments)}}(),S=function(){var e=o()((function*(e){let{body:n,trackingIds:t,loginAttemptId:i,privateKey:o,track:a}=e;a(r.c.GraphQLHeardBack);const{token:u,status:d}=n.data.sessionRequestToken;if("failure"===d)return void h.c(Error("Session request callback failed."),{message:"Server response: ".concat(d)},{team:y.ViewerX});a(r.c.SessionRequestTokenReceived);const f=yield(async(e,n)=>{const t=await window.crypto.subtle.decrypt({name:"RSA-OAEP"},e,n);return c.Buffer.from(t)})(o,(e=>c.Buffer.from(e,"base64"))(u)),p={anon_id:t.anonID,device_id:t.deviceID,login_attempt_id:i},m=Object.keys(p).map((e=>"".concat(e,"=").concat(p[e])));fetch("".concat(l.n,"/api/auth/session?").concat(m.join("&")),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({srt:s(f)})}).then((e=>{e.status>=400?h.c(Error("Fetch session request token failed."),{message:"Response: [".concat(e.status,"] ").concat(e.statusText)},{team:y.ViewerX}):(a(r.c.LoginSuccess),window.location.reload())}))}));return function(n){return e.apply(this,arguments)}}()},Z1Kr:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));t("1PCe"),t("uwQj"),t("A27O"),t("en/A"),t("vHPw"),t("Ufsh"),t("oTQU");let i;!function(e){e.PUBLIC_REACTION="public reaction",e.PUBLIC_COMMENT="public comment",e.PRIVATE_LOGGED_OUT_SCREEN="private logged out screen"}(i||(i={}))},dXfc:function(e,n,t){"use strict";t.r(n);var i=t("uwQj"),o=t.n(i),a=t("O50+"),r=t("Z1Kr"),c=t("7IyJ"),s=t("Ufsh");function u(){const{video:e}=Object(a.ab)(),n=Object(a.S)();o.a.useEffect((()=>{if(!n)return;const t=n=>{Object(s.a)(e.modelId,function(e){return"comment"===e?r.a.PUBLIC_COMMENT:"reaction"===e?r.a.PUBLIC_REACTION:void 0}(n))};return n.on([a.v.connectClicked],t),()=>{n.off([a.v.connectClicked],t)}}))}n.default=()=>(function(){const{setShowLoomConnect:e}=Object(a.ab)();o.a.useEffect((()=>{e(Boolean(c.h))}),[e])}(),u(),null)},oTQU:function(e,n,t){e.exports={sharedAuthButton:"shared-auth-button_sharedAuthButton_cVS",sharedAuthButtonCollapsed:"shared-auth-button_sharedAuthButtonCollapsed_29T",sharedAuthText:"shared-auth-button_sharedAuthText_ykr"}}}]);